0000              1   ;Project 1 Main-Frame
0000              2   ;Authors- Lewis Mason, 
0000              3   
                 -1   $MODLP51
0000              1   ;--------------------------------------------------------
0000              2   ; Special Function Registers
0000              3   ;--------------------------------------------------------
0000              4   ACC            DATA 0xe0
0000              5   B              DATA 0xf0
0000              6   PSW            DATA 0xd0
0000              7   SP             DATA 0x81
0000              8   SPX            DATA 0xef
0000              9   DPL            DATA 0x82
0000             10   DPH            DATA 0x83
0000             11   DPLB           DATA 0xd4
0000             12   DPHB           DATA 0xd5
0000             13   PAGE           DATA 0xf6
0000             14   AX             DATA 0xe1
0000             15   BX             DATA 0xf7
0000             16   DSPR           DATA 0xe2
0000             17   FIRD           DATA 0xe3
0000             18   MACL           DATA 0xe4
0000             19   MACH           DATA 0xe5
0000             20   PCON           DATA 0x87
0000             21   AUXR           DATA 0x8e
0000             22   AUXR1          DATA 0xa2
0000             23   DPCF           DATA 0xa1
0000             24   CKRL           DATA 0x97
0000             25   CKCKON0        DATA 0x8f
0000             26   CKCKON1        DATA 0xaf
0000             27   CKSEL          DATA 0x85
0000             28   CLKREG         DATA 0xae
0000             29   OSCCON         DATA 0x85
0000             30   IE             DATA 0xa8
0000             31   IEN0           DATA 0xa8
0000             32   IEN1           DATA 0xb1
0000             33   IPH0           DATA 0xb7
0000             34   IP             DATA 0xb8
0000             35   IPL0           DATA 0xb8
0000             36   IPH1           DATA 0xb3
0000             37   IPL1           DATA 0xb2
0000             38   P0             DATA 0x80
0000             39   P1             DATA 0x90
0000             40   P2             DATA 0xa0
0000             41   P3             DATA 0xb0
0000             42   P4             DATA 0xc0
0000             43   P0M0           DATA 0xe6
0000             44   P0M1           DATA 0xe7
0000             45   P1M0           DATA 0xd6
0000             46   P1M1           DATA 0xd7
0000             47   P2M0           DATA 0xce
0000             48   P2M1           DATA 0xcf
0000             49   P3M0           DATA 0xc6
0000             50   P3M1           DATA 0xc7
0000             51   P4M0           DATA 0xbe
0000             52   P4M1           DATA 0xbf
0000             53   SCON           DATA 0x98
0000             54   SBUF           DATA 0x99
0000             55   SADEN          DATA 0xb9
0000             56   SADDR          DATA 0xa9
0000             57   BDRCON         DATA 0x9b
0000             58   BRL            DATA 0x9a
0000             59   TCON           DATA 0x88
0000             60   TMOD           DATA 0x89
0000             61   TCONB          DATA 0x91
0000             62   TL0            DATA 0x8a
0000             63   TH0            DATA 0x8c
0000             64   TL1            DATA 0x8b
0000             65   TH1            DATA 0x8d
0000             66   RL0            DATA 0xf2
0000             67   RH0            DATA 0xf3
0000             68   RTL1           DATA 0xf4
0000             69   RH1            DATA 0xf5
0000             70   WDTRST         DATA 0xa6
0000             71   WDTPRG         DATA 0xa7
0000             72   T2CON          DATA 0xc8
0000             73   T2MOD          DATA 0xc9
0000             74   RCAP2H         DATA 0xcb
0000             75   RCAP2L         DATA 0xca
0000             76   TH2            DATA 0xcd
0000             77   TL2            DATA 0xcc
0000             78   SPCON          DATA 0xc3
0000             79   SPSTA          DATA 0xc4
0000             80   SPDAT          DATA 0xc5
0000             81   SSCON          DATA 0x93
0000             82   SSCS           DATA 0x94
0000             83   SSDAT          DATA 0x95
0000             84   SSADR          DATA 0x96
0000             85   KBLS           DATA 0x9c
0000             86   KBE            DATA 0x9d
0000             87   KBF            DATA 0x9e
0000             88   KBMOD          DATA 0x9f
0000             89   BMSEL          DATA 0x92
0000             90   FCON           DATA 0xd2
0000             91   EECON          DATA 0xd2
0000             92   ACSRA          DATA 0xa3
0000             93   ACSRB          DATA 0xab
0000             94   AREF           DATA 0xbd
0000             95   DADC           DATA 0xa4
0000             96   DADI           DATA 0xa5
0000             97   DADL           DATA 0xac
0000             98   DADH           DATA 0xad
0000             99   CCON           DATA 0xd8
0000            100   CMOD           DATA 0xd9
0000            101   CL             DATA 0xe9
0000            102   CH             DATA 0xf9
0000            103   CCAPM0         DATA 0xda
0000            104   CCAPM1         DATA 0xdb
0000            105   CCAPM2         DATA 0xdc
0000            106   CCAPM3         DATA 0xdd
0000            107   CCAPM4         DATA 0xde
0000            108   CCAP0H         DATA 0xfa
0000            109   CCAP1H         DATA 0xfb
0000            110   CCAP2H         DATA 0xfc
0000            111   CCAP3H         DATA 0xfd
0000            112   CCAP4H         DATA 0xfe
0000            113   CCAP0L         DATA 0xea
0000            114   CCAP1L         DATA 0xeb
0000            115   CCAP2L         DATA 0xec
0000            116   CCAP3L         DATA 0xed
0000            117   CCAP4L         DATA 0xee
0000            118   ;--------------------------------------------------------
0000            119   ; special function bits
0000            120   ;--------------------------------------------------------
0000            121   P              BIT 0xd0
0000            122   F1             BIT 0xd1
0000            123   OV             BIT 0xd2
0000            124   RS0            BIT 0xd3
0000            125   RS1            BIT 0xd4
0000            126   F0             BIT 0xd5
0000            127   AC             BIT 0xd6
0000            128   CY             BIT 0xd7
0000            129   EX0            BIT 0xa8
0000            130   ET0            BIT 0xa9
0000            131   EX1            BIT 0xaa
0000            132   ET1            BIT 0xab
0000            133   ES             BIT 0xac
0000            134   ET2            BIT 0xad
0000            135   EC             BIT 0xae
0000            136   EA             BIT 0xaf
0000            137   PX0            BIT 0xb8
0000            138   PT0            BIT 0xb9
0000            139   PX1            BIT 0xba
0000            140   PT1            BIT 0xbb
0000            141   PS             BIT 0xbc
0000            142   PT2            BIT 0xbd
0000            143   IP0D           BIT 0xbf
0000            144   PPCL           BIT 0xbe
0000            145   PT2L           BIT 0xbd
0000            146   PLS            BIT 0xbc
0000            147   PT1L           BIT 0xbb
0000            148   PX1L           BIT 0xba
0000            149   PT0L           BIT 0xb9
0000            150   PX0L           BIT 0xb8
0000            151   RXD            BIT 0xb0
0000            152   TXD            BIT 0xb1
0000            153   INT0           BIT 0xb2
0000            154   INT1           BIT 0xb3
0000            155   T0             BIT 0xb4
0000            156   T1             BIT 0xb5
0000            157   WR             BIT 0xb6
0000            158   RD             BIT 0xb7
0000            159   RI             BIT 0x98
0000            160   TI             BIT 0x99
0000            161   RB8            BIT 0x9a
0000            162   TB8            BIT 0x9b
0000            163   REN            BIT 0x9c
0000            164   SM2            BIT 0x9d
0000            165   SM1            BIT 0x9e
0000            166   SM0            BIT 0x9f
0000            167   IT0            BIT 0x88
0000            168   IE0            BIT 0x89
0000            169   IT1            BIT 0x8a
0000            170   IE1            BIT 0x8b
0000            171   TR0            BIT 0x8c
0000            172   TF0            BIT 0x8d
0000            173   TR1            BIT 0x8e
0000            174   TF1            BIT 0x8f
0000            175   CP_RL2         BIT 0xc8
0000            176   C_T2           BIT 0xc9
0000            177   TR2            BIT 0xca
0000            178   EXEN2          BIT 0xcb
0000            179   TCLK           BIT 0xcc
0000            180   RCLK           BIT 0xcd
0000            181   EXF2           BIT 0xce
0000            182   TF2            BIT 0xcf
0000            183   CF             BIT 0xdf
0000            184   CR             BIT 0xde
0000            185   CCF4           BIT 0xdc
0000            186   CCF3           BIT 0xdb
0000            187   CCF2           BIT 0xda
0000            188   CCF1           BIT 0xd9
0000            189   CCF0           BIT 0xd8
0000              5   
0000              6   ; Reset vector
0000              7   org 0x0000
0000 02285F       8       ljmp mainprogram
0003              9   
0003             10   
0003             11   ; External interrupt 0 vector (not used in this code)
0003             12   org 0x0003
0003 32          13            reti
0004             14   
0004             15   ; Timer/Counter 0 overflow interrupt vector
000B             16   org 0x000B
000B             17            ;ljmp Timer0_ISR
000B 32          18            reti
000C             19   
000C             20   ; External interrupt 1 vector (not used in this code)
0013             21   org 0x0013
0013 32          22            reti
0014             23   
0014             24   ; Timer/Counter 1 overflow interrupt vector (not used in this code)
001B             25   org 0x001B
001B 0205A5      26            ljmp Timer1_ISR
001E             27   
001E             28   ; Serial port receive/transmit interrupt vector
0023             29   org 0x0023 
0023 02100A      30            ljmp Serial_ISR
0026 32          31            reti
0027             32            
0027             33   ; Timer/Counter 2 overflow interrupt vector
002B             34   org 0x002B
002B 0205C1      35            ljmp Timer2_ISR
002E             36            
002E             37      ;current1234
002E             38    
                546   $LIST
                 46   	$LIST
0D1A             48   
0D1A             49   TIMER0_RELOAD_L DATA 0xf2
0D1A             50   TIMER1_RELOAD_L DATA 0xf3
0D1A             51   TIMER0_RELOAD_H DATA 0xf4
0D1A             52   TIMER1_RELOAD_H DATA 0xf5
0D1A             53   
0D1A             54   CLK           EQU 22118400 ; Microcontroller system crystal frequency in Hz
0D1A             55   TIMER0_RATE   EQU 500     ; 2048Hz squarewave (peak amplitude of CEM-1203 speaker)
0D1A             56   TIMER0_RELOAD EQU ((65536-(CLK/TIMER0_RATE)))
0D1A             57   TIMER1_RATE   EQU 4096     ; 2048Hz squarewave (peak amplitude of CEM-1203 speaker)
0D1A             58   TIMER1_RELOAD EQU ((65536-(CLK/TIMER1_RATE)))
0D1A             59   TIMER2_RATE   EQU 500     ; 1000Hz, for a timer tick of 1ms
0D1A             60   TIMER2_RELOAD EQU ((65536-(CLK/TIMER2_RATE)))
0D1A             61   
0D1A             62   BAUD               equ 115200
0D1A             63   BRG_VAL            equ (0x100-(CLK/(16*BAUD)))
0D1A             64   ROOM_T             equ 2450
0D1A             65   
0D1A             66   SOUND_OUT     equ P3.7
0D1A             67   
0030             68   Dseg at 30H
0030             69   Current_Preset:                          ds 1    ;1 byte to be used globally, determining the current preset
0031             70   
0031             71   Soak_Settings_T_hex:             ds 1
0032             72   Soak_Settings_Temp_hex:          ds 1
0033             73   Soak_Preset1_T_hex:              ds 1
0034             74   Soak_Preset2_T_hex:              ds 1
0035             75   Soak_Preset3_T_hex:              ds 1
0036             76   Soak_Preset1_Temp_hex:           ds 1
0037             77   Soak_Preset2_Temp_hex:           ds 1
0038             78   Soak_Preset3_Temp_hex:           ds 1
0039             79   
0039             80   Reflow_Settings_T_hex:           ds 1
003A             81   Reflow_Preset1_T_hex:            ds 1
003B             82   Reflow_Preset2_T_hex:            ds 1
003C             83   Reflow_Preset3_T_hex:            ds 1
003D             84   Reflow_Settings_Temp_hex:        ds 1
003E             85   Reflow_Preset1_Temp_hex:         ds 1
003F             86   Reflow_Preset2_Temp_hex:         ds 1
0040             87   Reflow_Preset3_Temp_hex:         ds 1
0041             88   
0041             89   ;when the process starts, the current values of temp and time settings get put into the below,
0041             90   Soak_Start_T_hex:                        ds 1
0042             91   Reflow_Start_T_hex:              ds 1
0043             92   Soak_Start_Temp_hex:             ds 1
0044             93   Reflow_Start_Temp_hex:           ds 1
0045             94   ;other variables used during runtime
0045             95   oven_state:                              ds 1    ;contains the current state of the running process
0046             96   state_flag_counter:                      ds 1    ;used to determine what is displayed for the current state on the lcd
0047             97   
0047             98   ;variables that are used for math functions
0047             99   x:                                                       ds 4
004B            100   y:                                                       ds 4    
004F            101   bcd:                                             ds 5
0054            102   BCD_counter:                             ds 2    ; The BCD counter incrememted in the ISR and displayed in the main loop
0056            103   BCD_state_counter:                       ds 2    ; The BCD counter incrememted in the ISR and displayed in the main loop
0058            104   Count1ms:                                ds 2    ; Used to determine when half second has passed
005A            105   
005A            106   Probe1_Temp:                             ds 2
005C            107   Probe2_Temp:                             ds 2
005E            108   Probe3_Temp:                             ds 2
0060            109   Room_Temp:                                       ds 2
0062            110   Temp:                                            ds 2    ; The current bitbanged-Temperature, stored as a binary number
0064            111   Set_Temp:                                        ds 1    ; The temp used to transition states
0065            112   Probe3_Temp_Sample1:             ds 2
0067            113   Probe3_Temp_Sample2:             ds 2
0069            114   Probe2_Temp_Sample1:             ds 2
006B            115   Probe2_Temp_Sample2:             ds 2
006D            116   Probe1_Temp_Sample1:             ds 2
006F            117   Probe1_Temp_Sample2:             ds 2
0071            118   ;NOTE: Put the desired tempurature into Set_Temp for any given state
0071            119   
0071            120   ;The following variables are used for serial port communication
0071            121   Count2ms:                        ds 1
0072            122   Result:                          ds 2
0074            123   upper_bound:             ds 1
0075            124   lower_bound:             ds 1
0076            125   computed_DC:             ds 1
0077            126   Duty_Cycle:              ds 1
0078            127   Width_Count:             ds 1
0079            128   Count10ms:                       ds 1
007A            129   early_stop_time:         ds 1
007B            130   early_stop_temp:         ds 1
007C            131   Door_Open_Timer:         ds 1
007D            132   
007D            133   Calibrated_Result:  ds 2
007F            134   
007F            135   
007F            136   Error_Codes:             ds 1
0080            137   
0080            138   ;Variables for alarms (being replaced by registers in register bank 1)
0080            139   ;Count_one: ds 2 ; {R1, R0}
0080            140   ;Count_two: ds 2 ; {R3, R2}
0080            141   ;Count_three: ds 2 ; {R5, R4}
0080            142   
0000            143   BSEG
0000            144   mf:                                      dbit 1
0001            145   half_seconds_flag:               dbit 1          ;Set to one in the ISR every time 500 ms had passed
0002            146   ;bits used throughout runtime
0002            147   abort_flag:                              dbit 1  ;used to flag aborting the runtime process
0003            148   state1_exit_flag:                        dbit 1  ;temperature activated flag, high when run-temp > Soak_Start_Temp_hex
0004            149   state2_exit_flag:                        dbit 1  ;time activated flag, high after state-run-time > Soak_Start_T_hex
0005            150   state3_exit_flag:                        dbit 1  ;temperature activated flag, high when run-temp > Reflow_Start_Temp_hex
0006            151   state4_exit_flag:                        dbit 1  ;time activated flag, high after state-run-time > Reflow_Start_T_hex
0007            152   state5_exit_flag:                        dbit 1  ;temperature activated flag, high when run-temp < 60
0008            153   state_display_flag:              dbit 1          ;determines what will be displayed for the state during runtime
0009            154   state_display_flag2:             dbit 1  ; a flag that is used to print the state display
000A            155   
000A            156   Probe_Flag: dbit 1
000B            157   Door_Open:                                       dbit 1
000C            158   
000C            159   
000C            160   ;The following bits are used for serial port communication
000C            161   Tx_Ready:                                        dbit 1
000D            162   Remote_Start:                            dbit 1
000E            163   Remote_Stop:                             dbit 1
000F            164   Remote_Data:                             dbit 1
0010            165   Remote_STemp:                            dbit 1
0011            166   Remote_Stime:                            dbit 1
0012            167   Remote_RTemp:                            dbit 1
0013            168   Remote_Rtime:                            dbit 1  ;a flag used to tell the program that the temp needs to be changed, as well as the duty cycle calculations
0014            169   change_temperature_flag:         dbit 1
0015            170   full_power_flag:                         dbit 1
0016            171   early_stop_flag:                         dbit 1
0017            172   PWM_flag:                                        dbit 1
0018            173   
0018            174   One_Sec:                                         dbit 1
0019            175   One_Sec2:                                        dbit 1
001A            176   
001A            177   state1tempflag:                          dbit 1
001B            178   state3tempflag:                          dbit 1
001C            179   Check_Code_1:                            dbit 1
001D            180   
001D            181   ;Flags for alarms
001D            182   flag_one: dbit 1
001E            183   flag_two: dbit 1
001F            184   flag_three: dbit 1
0020            185   
0D1A            186     CSEG  
0D1A            187   B0               equ     P2.6            ;the signal that increments the cursor
0D1A            188   B1               equ     P2.7            ;the signal the selects the option the cursor is hovering
0D1A            189   B2               equ     P2.5            ;the signal that decrements the cursor
0D1A            190   B3               equ     P2.4            ;the signal that toggles settings when 
0D1A            191   ;below needs to be changed
0D1A            192   ESTOP    equ     P0.2
0D1A            193   
0D1A            194   ; These ’EQU’ must match the wiring between the microcontroller and ADC
0D1A            195   CE_ADC  EQU P2.0         ;SS'
0D1A            196   MY_MOSI EQU P2.1         ;MOSI
0D1A            197   MY_MISO EQU P2.2         ;MISO
0D1A            198   MY_SCLK EQU P2.3         ;CLK
0D1A            199   ; These ’EQU’ must match the wiring between the microcontroller and LCD
0D1A            200   LCD_RS   equ     P1.1
0D1A            201   LCD_RW   equ     P1.2
0D1A            202   LCD_E    equ     P1.3            ;this is the pin that enables the menu LCD      (clr)
0D1A            203   ;LCD_SE equ              ;this is the pin that enables the status LCD    (clr)
0D1A            204   LCD_D4   equ     P3.2    
0D1A            205   LCD_D5   equ     P3.3
0D1A            206   LCD_D6   equ     P3.4
0D1A            207   
0D1A            208   LCD_D7   equ     P3.5    
0D1A            209   ;used for serial communication
0D1A            210   P_out    equ     P0.1
0D1A            211   DoorPIN equ      P0.7
0D1A            212   
0D1A            213   
0D1A 20202020   214   CLEARLINE:       db              '                ', 0   ;used to clear the LCD
     20202020
     20202020
     20202020
     00
0D2B            215   
0D2B            216   ;Home display strings
0D2B 53746172   217   HomeTop1:                db                      'Start<  Settings', 0
     743C2020
     53657474
     696E6773
     00
0D3C 53746172   218   HomeTop2:                db                      'Start  >Settings', 0
     7420203E
     53657474
     696E6773
     00
0D4D 53746172   219   HomeTop3:                db                      'Start   Settings', 0
     74202020
     53657474
     696E6773
     00
0D5E 50726573   220   HomeBtm1:                db                      'Preset <  Probes', 0
     6574203C
     20205072
     6F626573
     00
0D6F 50726573   221   HomeBtm2:                db                      'Preset   >Probes', 0
     65742020
     203E5072
     6F626573
     00
0D80 50726573   222   HomeBtm3:                db                      'Preset    Probes', 0
     65742020
     20205072
     6F626573
     00
0D91            223   
0D91            224   ;Preset select display strings
0D91 4261636B   225   PresetTop1:              db              'Back<    Preset1', 0
     3C202020
     20507265
     73657431
     00
0DA2 4261636B   226   PresetTop2:              db              'Back    >Preset1', 0
     20202020
     3E507265
     73657431
     00
0DB3 4261636B   227   PresetTop3:              db              'Back     Preset1', 0
     20202020
     20507265
     73657431
     00
0DC4 50726573   228   PresetBtm1:              db              'Preset2< Preset3', 0
     6574323C
     20507265
     73657433
     00
0DD5 50726573   229   PresetBtm2:              db              'Preset2 >Preset3', 0
     65743220
     3E507265
     73657433
     00
0DE6 50726573   230   PresetBtm3:              db              'Preset2  Preset3', 0
     65743220
     20507265
     73657433
     00
0DF7            231   
0DF7            232   ;Settings display strings
0DF7 53617665   233   SettingsTop1:            db              'Save<      Other', 0
     3C202020
     2020204F
     74686572
     00
0E08 53617665   234   SettingsTop2:            db              'Save      >Other', 0
     20202020
     20203E4F
     74686572
     00
0E19 53617665   235   SettingsTop3:            db              'Save       Other', 0
     20202020
     2020204F
     74686572
     00
0E2A 536F616B   236   SettingsBtm1:            db              'Soak-T< Reflow-T', 0
     2D543C20
     5265666C
     6F772D54
     00
0E3B 536F616B   237   SettingsBtm2:            db              'Soak-T >Reflow-T', 0
     2D54203E
     5265666C
     6F772D54
     00
0E4C 536F616B   238   SettingsBtm3:            db              'Soak-T  Reflow-T', 0
     2D542020
     5265666C
     6F772D54
     00
0E5D            239   
0E5D            240   
0E5D            241   ;Other Strings
0E5D 53656C65   242   SelectPreset:            db                      'Select Preset',0
     63742050
     72657365
     7400
0E6B            243   ;SaveSettingsQ1:         db                      'Save the settings?',0
0E6B 43686F6F   244   SaveSettings:            db                      'Choose preset #',0
     73652070
     72657365
     74202300
0E7B 746F2073   245   SaveSettings1:           db                      'to save to:',0
     61766520
     746F3A00
0E87 53657474   246   SettingsSaved:           db                      'Settings Saved',0
     696E6773
     20536176
     656400
0E96 53617665   247   SaveSettings?:           db                      'Save Settings?',0
     20536574
     74696E67
     733F00
0EA5 54656D70   248   SoakSettings1:           db                      'Temp    Duration', 0
     20202020
     44757261
     74696F6E
     00
0EB6 54656D70   249   ReflowSettings1:         db                      'Temp    Duration', 0
     20202020
     44757261
     74696F6E
     00
0EC7 3C00       250   leftpoint:                       db                      '<',0
0EC9 3E00       251   rightpoint:              db                      '>',0
0ECB 2000       252   CLEARCHAR:                       db                      ' ',0
0ECD 20202020   253   CLEARHALFLINE:           db                      '        ',0
     20202020
     00
0ED6 4F00       254   o:                                       db                      'O',0
0ED8            255   
0ED8            256   ;runtime strings
0ED8 78787878   257   CurrentStateSetup:  db                   'xxxxxxxx', 0
     78787878
     00
0EE1 63636363   258   CurrentTempSetup:   db                   'ccccc', 0
     6300
0EE7 72727272   259   CurrentRTimeSetup:  db                   'rrrr', 0
     00
0EEC 74747474   260   CurrentTimeSetup:   db                   'tttt', 0
     00
0EF1            261   
0EF1            262   ;state names
0EF1 52616D70   263   RampToSoak:              db                      'RampToSoak', 0
     546F536F
     616B00
0EFC 536F616B   264   Soak:                        db                          'Soak', 0
     00
0F01 52616D70   265   RampToPeak:              db                      'RampToPeak', 0
     546F5065
     616B00
0F0C 5265666C   266   Reflow:                      db                          'Reflow', 0
     6F7700
0F13 436F6F6C   267   Cooling:                     db                          'Cooling', 0
     696E6700
0F1B 2D2D2D2D   268   StateDiagramLayout: db                   '-----', 0
     2D00
0F21 55736572   269   EXITTEXTTOP:             db                      'User exception',0
     20657863
     65707469
     6F6E00
0F30 41626F72   270   EXITTEXTBTM:             db                      'Aborting',0
     74696E67
     00
0F39            271   
0F39            272   ;error codes
0F39 4552524F   273   ERROR:                           db                      'ERROR', 0
     5200
0F3F            274   
0F3F            275   ;delete these later
0F3F 434F4F4C   276   COOL:                    db 'COOL',0
     00
0F44 68656174   277   HEAT:                    db 'heat',0
     00
0F49            278   
0F49 50726F62   279   ProbeTop:                db 'Probe1    Probe3',0
     65312020
     20205072
     6F626533
     00
0F5A 50726F62   280   ProbeBtm:                db 'Probe2    Result',0
     65322020
     20205265
     73756C74
     00
0F6B            281   
0F6B            282   ;splashscreen
0F6B            283   
0F6B            284   
0F6B            285   ;------------------------------;
0F6B            286   ;Setup_System
0F6B            287   ;------------------------------;
0F6B            288   Setup_System:
0F6B            289   ;        lcall Timer0_Init
0F6B 12058E     290            lcall Timer1_Init
0F6E 1205A8     291       lcall Timer2_Init
0F71 120399     292       lcall InitSerialPort
0F74            293       
0F74 D2AF       294       setb EA   ; Enable Global interrupts
0F76 753001     295            mov Current_Preset,                     #0x01
0F79            296            
0F79            297            ;soak initializing
0F79 753100     298            mov     Soak_Settings_T_hex,            #0x00
0F7C 753200     299            mov     Soak_Settings_Temp_hex,         #0x00
0F7F 753373     300            mov     Soak_Preset1_T_hex,             #115
0F82 75343C     301            mov     Soak_Preset2_T_hex,             #60
0F85 753578     302            mov     Soak_Preset3_T_hex,             #120
0F88 753696     303            mov     Soak_Preset1_Temp_hex,                  #150
0F8B 753796     304            mov     Soak_Preset2_Temp_hex,                  #150
0F8E 753896     305            mov     Soak_Preset3_Temp_hex,                  #150
0F91            306            ;reflow initializing
0F91 753900     307            mov     Reflow_Settings_T_hex,          #0x00
0F94 753A4B     308            mov     Reflow_Preset1_T_hex,           #75
0F97 753B2D     309            mov     Reflow_Preset2_T_hex,           #45
0F9A 753C4B     310            mov     Reflow_Preset3_T_hex,           #75
0F9D 753D00     311            mov     Reflow_Settings_Temp_hex,       #0x00
0FA0 753ED9     312            mov     Reflow_Preset1_Temp_hex,        #217
0FA3 753FD9     313            mov     Reflow_Preset2_Temp_hex,        #217
0FA6 7540D9     314            mov     Reflow_Preset3_Temp_hex,        #217
0FA9            315            ;start of the process initializing, changes in program.
0FA9 754100     316            mov     Soak_Start_T_hex,                       #0x00
0FAC 754200     317            mov     Reflow_Start_T_hex,             #0x00
0FAF 754300     318            mov     Soak_Start_Temp_hex,            #0x00
0FB2 754400     319            mov     Reflow_Start_Temp_hex,                  #0x00
0FB5            320            ;initializing oven info
0FB5 C202       321            clr abort_flag
0FB7 750300     322            mov state1_exit_flag,                   #0x00
0FBA 750400     323            mov state2_exit_flag,                   #0x00
0FBD 750500     324            mov state3_exit_flag,                   #0x00
0FC0 750600     325            mov state4_exit_flag,                   #0x00
0FC3 754500     326            mov oven_state,                                 #0x00
0FC6 C209       327            clr state_display_flag2
0FC8 C208       328            clr state_display_flag
0FCA            329            ;initializing the timers
0FCA 755400     330            mov BCD_counter+0,                              #0x00
0FCD 755500     331            mov BCD_counter+1,                              #0x00
0FD0 755600     332            mov BCD_state_counter+0,                #0x00
0FD3 755700     333            mov BCD_state_counter+1,                #0x00
0FD6 75E600     334            mov P0M0, #0
0FD9 75E700     335            mov P0M1, #0
0FDC            336       ;Temp variables
0FDC 756200     337       mov Temp,                                            #0x00
0FDF 757D00     338       mov Calibrated_Result+0,             #0x00
0FE2 757E00     339       mov Calibrated_Result+1,             #0x00
0FE5 756109     340       mov Room_Temp+1,                             #high(ROOM_T)
0FE8 756092     341       mov Room_Temp+0,                             #low(ROOM_T)
0FEB 756400     342       mov Set_Temp,                                        #0x00
0FEE D214       343       setb change_temperature_flag
0FF0            344      ; mov early_stop_bound,                       #150
0FF0 C20D       345       clr Remote_Start
0FF2 C20E       346       clr Remote_Stop
0FF4 C20F       347       clr Remote_Data
0FF6            348            ; Alarm variables
0FF6 D2B7       349       setb SOUND_OUT
0FF8 C21D       350       clr flag_one
0FFA C21E       351       clr flag_two
0FFC C21F       352       clr flag_three
0FFE            353       
0FFE            354       ;mov Count_one,                              #0x00
0FFE            355       ;mov Count_two,                                      #0x00
0FFE            356       ;mov Count_three,                            #0x00
0FFE D2D3       357       setb RS0
1000 E4         358       clr a
1001 F8         359       mov r0,                                                      a
1002 F9         360       mov r1,                                              a
1003 FA         361       mov r2,                                                      a
1004 FB         362       mov r3,                                                      a
1005 FC         363       mov r4,                                                      a
1006 FD         364       mov r5,                                                      a
1007 C2D3       365       clr RS0
1009            366    
1009 22         367            ret
100A            368            
100A            369   Serial_ISR:
100A 309905     370            jnb TI, Rx_ISR
100D C299       371            clr TI
100F D20C       372            setb Tx_Ready
1011 32         373            reti
1012            374   Rx_ISR:
1012 C298       375       clr RI
1014 C0E0       376       push acc
1016 C0D0       377       push psw
1018 E599       378       mov a, SBUF
101A 200F08     379       jb Remote_Data, Take_Data
101D 1203B5     380       lcall take_instruction
1020            381   Rx_Done:
1020 D0D0       382       pop psw
1022 D0E0       383       pop acc
1024 32         384       reti
1025            385   Take_Data:
1025            386   
1025            387            ;cpl P3.6       ;debugging.
1025            388            
1025 C20F       389            clr Remote_Data
1027 301007     390            jnb Remote_STemp, check_Stime
102A F532       391            mov Soak_Settings_Temp_hex, a
102C 753300     392            mov Soak_Settings_Temp_hex+1, #0
102F 8020       393            sjmp Save_Remote_Settings
1031            394   check_Stime:
1031 301107     395            jnb Remote_Stime, check_RTemp
1034 F531       396            mov Soak_Settings_T_hex, a
1036 753200     397            mov Soak_Settings_T_hex+1, #0
1039 8016       398            sjmp Save_Remote_Settings
103B            399   check_RTemp:
103B 301207     400            jnb Remote_RTemp, check_Rtime
103E F53D       401            mov Reflow_Settings_Temp_hex, a
1040 753E00     402            mov Reflow_Settings_Temp_hex+1, #0
1043 800C       403            sjmp Save_Remote_Settings
1045            404   check_Rtime:
1045 301307     405            jnb Remote_Rtime, Rx_Error
1048 F539       406            mov Reflow_Settings_T_hex, a
104A 753A00     407            mov Reflow_Settings_T_hex+1, #0
104D 8002       408            sjmp Save_Remote_Settings
104F            409   Rx_Error:
104F 80CF       410            sjmp Rx_Done
1051            411   Save_Remote_Settings:
1051 C0E0       412            push acc
1053            412            
1053 E530       412            mov a, Current_Preset
1055 B40117     412            cjne a, #0x01, Preset_Not_1M68
1058 C0E0       412            push acc
105A            412   
105A E531       412            mov a, Soak_Settings_T_hex
105C F533       412            mov Soak_Preset1_T_hex, a
105E E539       412            mov a, Reflow_Settings_T_hex
1060 F53A       412            mov Reflow_Preset1_T_hex, a
1062            412            
1062 E532       412            mov a, Soak_Settings_Temp_hex
1064 F536       412            mov Soak_Preset1_Temp_hex, a
1066 E53D       412            mov a, Reflow_Settings_Temp_hex
1068 F53E       412            mov Reflow_Preset1_Temp_hex, a
106A            412   
106A D0E0       412            pop acc
106C 0210A3     412            ljmp Preset_Not_3M68
106F            412            
106F            412   Preset_Not_1M68:
106F B40217     412            cjne a, #0x02, Preset_Not_2M68
1072 C0E0       412            push acc
1074            412   
1074 E531       412            mov a, Soak_Settings_T_hex
1076 F534       412            mov Soak_Preset2_T_hex, a
1078 E539       412            mov a, Reflow_Settings_T_hex
107A F53B       412            mov Reflow_Preset2_T_hex, a
107C            412            
107C E532       412            mov a, Soak_Settings_Temp_hex
107E F537       412            mov Soak_Preset2_Temp_hex, a
1080 E53D       412            mov a, Reflow_Settings_Temp_hex
1082 F53F       412            mov Reflow_Preset2_Temp_hex, a
1084            412   
1084 D0E0       412            pop acc
1086 0210A3     412            ljmp Preset_Not_3M68
1089            412            
1089            412   Preset_Not_2M68:
1089 B40317     412            cjne a, #0x03, Preset_Not_3M68
108C C0E0       412            push acc
108E            412   
108E E531       412            mov a, Soak_Settings_T_hex
1090 F535       412            mov Soak_Preset3_T_hex, a
1092 E539       412            mov a, Reflow_Settings_T_hex
1094 F53C       412            mov Reflow_Preset3_T_hex, a
1096            412            
1096 E532       412            mov a, Soak_Settings_Temp_hex
1098 F538       412            mov Soak_Preset3_Temp_hex, a
109A E53D       412            mov a, Reflow_Settings_Temp_hex
109C F540       412            mov Reflow_Preset3_Temp_hex, a
109E            412   
109E D0E0       412            pop acc
10A0 0210A3     412            ljmp Preset_Not_3M68
10A3            412            
10A3            412   Preset_Not_3M68:
10A3 D0E0       412            pop acc
10A5 021020     413            ljmp Rx_Done
10A8            414            
10A8            415   ;------------------------------;
10A8            416   ;functions for serial communication
10A8            417   ;------------------------------;
10A8            418   
10A8            419   INIT_SPI:
10A8 D2A2       420             setb MY_MISO ; Make MISO an input pin
10AA C2A3       421             clr MY_SCLK ; For mode (0,0) SCLK is zero
10AC 22         422             ret
10AD            423   
10AD            424   DO_SPI_G:
10AD C0E0       425             push acc
10AF 7C00       426             mov R4, #0 ; Received byte stored in R1
10B1 7D08       427             mov R5, #8 ; Loop counter (8-bits)
10B3            428   DO_SPI_G_LOOP:
10B3 EB         429             mov a, R3 ; Byte to write is in R0
10B4 33         430             rlc a ; Carry flag has bit to write
10B5 FB         431             mov R3, a
10B6 92A1       432             mov MY_MOSI, c
10B8 D2A3       433             setb MY_SCLK ; Transmit
10BA A2A2       434             mov c, MY_MISO ; Read received bit
10BC EC         435             mov a, R4 ; Save received bit in R1
10BD 33         436             rlc a
10BE FC         437             mov R4, a
10BF C2A3       438             clr MY_SCLK
10C1 DDF0       439             djnz R5, DO_SPI_G_LOOP
10C3 D0E0       440             pop acc
10C5 22         441             ret
10C6            442   
10C6            443   ; Send a character using the serial port
10C6            444   putchar:
10C6 300CFD     445       jnb Tx_Ready, putchar
10C9 C20C       446       clr Tx_Ready
10CB F599       447       mov SBUF, a
10CD 22         448       ret
10CE            449   ; Send a constant-zero-terminated string using the serial port
10CE            450   SendString:
10CE E4         451       clr A
10CF 93         452       movc A, @A+DPTR
10D0 6006       453       jz SendStringDone
10D2 1210C6     454       lcall putchar
10D5 A3         455       inc DPTR
10D6 80F6       456       sjmp SendString
10D8            457   SendStringDone:
10D8 22         458       ret
10D9            459    
10D9            460   ;------------------------------;
10D9            461   ;Menu_Change_Cursor_Func
10D9            462   ;------------------------------;
10D9            463   ;The necessary function used to change the cursors position
10D9            464   Menu_Change_Cursor_Func:
10D9            465            ;first case to check is there are no other funcs enabled
10D9 EA         466            mov a, R2               
10DA B40005     467            cjne a, #00000000B, Menu_NOTONE_Func_E          ;see if 1 function
10DD 7900       468            mov R1, #0x00                                                   ;reset cursor position
10DF 021124     469            ljmp Menu_Display_LCD
10E2            470                            
10E2            471   Menu_NOTONE_Func_E:
10E2            472            ;next check if there are 1 funcs enabled
10E2 EA         473            mov a, R2
10E3 B40111     474            cjne a, #0x01, Menu_NOTTWO_FUNC_E               ;see if 2 functions
10E6            475            ;now change the cursors position
10E6 E9         476            mov a, R1
10E7 B4FF05     477            cjne a, #0xFF, Menu_Display_Not_Dec_Bound_TWOFUNC       ; if not = to lower bout continue
10EA 7901       478            mov R1, #0x01
10EC 021124     479            ljmp Menu_Display_LCD
10EF            480   Menu_Display_Not_Dec_Bound_TWOFUNC:      
10EF B40232     481            cjne a, #0x02, Menu_Display_LCD         ;if not = to uper bound, continue
10F2 7900       482            mov R1, #0x00                                                   ;was = to upper bound, reset
10F4 021124     483            ljmp Menu_Display_LCD
10F7            484                            
10F7            485   Menu_NOTTWO_FUNC_E:
10F7            486            ;next check if there are 1 funcs enabled
10F7 EA         487            mov a, R2
10F8 B40211     488            cjne a, #0x02, Menu_NOTTHREE_FUNC_E     ;see if 3 functions
10FB            489            ;now change the cursors position
10FB E9         490            mov a, R1
10FC B4FF05     491            cjne a, #0xFF, Menu_Display_Not_Dec_Bound_THREEFUNC     ; if not = to lower bout continue
10FF 7902       492            mov R1, #0x02
1101 021124     493            ljmp Menu_Display_LCD
1104            494   Menu_Display_Not_Dec_Bound_THREEFUNC:
1104 B4031D     495            cjne a, #0x03, Menu_Display_LCD         ;if not = to uper bound, continue
1107 7900       496            mov R1, #0x00                                                   ;was = to upper bound, reset
1109 021124     497            ljmp Menu_Display_LCD
110C            498                            
110C            499   Menu_NOTTHREE_FUNC_E:
110C            500            ;next check if there are 1 funcs enabled
110C EA         501            mov a, R2
110D B40311     502            cjne a, #0x03, Menu_NOTFOUR_FUNC_E      ;see if 4 functions
1110            503            ;now change the cursors position
1110 E9         504            mov a, R1
1111 B4FF05     505            cjne a, #0xFF, Menu_Display_Not_Dec_Bound_FOURFUNC      ; if not = to lower bout continue
1114 7903       506            mov R1, #0x03
1116 021124     507            ljmp Menu_Display_LCD
1119            508   Menu_Display_Not_Dec_Bound_FOURFUNC:
1119 B40408     509            cjne a, #0x04, Menu_Display_LCD         ;if not = to uper bound, continue
111C 7900       510            mov R1, #0x00                                                   ;was = to upper bound, reset
111E 021124     511            ljmp Menu_Display_LCD
1121            512                            
1121            513   Menu_NOTFOUR_FUNC_E:
1121 021124     514            ljmp Menu_Display_LCD   
1124            515   Menu_Display_LCD:
1124 22         516            ret
1125            517            
1125            518   ;----------------------;
1125            519   ;Extra_Functions_Home
1125            520   ;----------------------;
1125            521   Extra_Functions_Home:
1125            522            ;first check what the preset is, and print it on the screen
1125 C0E0       523            push acc
1127 E530       524            mov a, Current_Preset
1129 B40115     525            cjne a, #0x01, Current_Preset_Not_1
112C            526            ;The current preset is 1, print 1
112C C0E0       527            push acc
112E 7407       527            mov a, #7
1130 14         527            dec a
1131 1200BF     527            lcall ?Set_Cursor_2 ; Select column and row
1134 D0E0       527            pop acc
1136 C0E0       528            push acc
1138 7431       528            mov a, #'1'
113A 12007E     528            lcall ?WriteData
113D D0E0       528            pop acc
113F 8030       529            sjmp Done_Displaying_Current_Preset
1141            530   Current_Preset_Not_1:    
1141 B40215     531            cjne a, #0x02, Current_Preset_Not_2
1144            532            ;The current preset is 2, print 2
1144 C0E0       533            push acc
1146 7407       533            mov a, #7
1148 14         533            dec a
1149 1200BF     533            lcall ?Set_Cursor_2 ; Select column and row
114C D0E0       533            pop acc
114E C0E0       534            push acc
1150 7432       534            mov a, #'2'
1152 12007E     534            lcall ?WriteData
1155 D0E0       534            pop acc
1157 8018       535            sjmp Done_Displaying_Current_Preset
1159            536   Current_Preset_Not_2:
1159 B40315     537            cjne a, #0x03, Current_Preset_Not_3
115C            538            ;The current preset is 3, print 3
115C C0E0       539            push acc
115E 7407       539            mov a, #7
1160 14         539            dec a
1161 1200BF     539            lcall ?Set_Cursor_2 ; Select column and row
1164 D0E0       539            pop acc
1166 C0E0       540            push acc
1168 7433       540            mov a, #'3'
116A 12007E     540            lcall ?WriteData
116D D0E0       540            pop acc
116F 8000       541            sjmp Done_Displaying_Current_Preset
1171            542            
1171            543   Current_Preset_Not_3:
1171            544   Done_Displaying_Current_Preset:
1171            545   
1171            546            ;check if the computer has inputted a signal
1171            547            ;if Remote_Start is high, start the process,
1171 300D05     548            jnb Remote_Start, Skip_Remote_Start
1174            549            
1174 12329D     550            lcall Start_Process
1177 C20D       551            clr Remote_Start
1179            552   Skip_Remote_Start:
1179            553   
1179 D0E0       554            pop acc
117B 22         555            ret
117C            556            
117C            557   ;check for error code 1
117C            558   Error_Code_1Check:
117C 120464     559            lcall clear_xy
117F 855A47     560            mov x+0, Probe1_Temp+0
1182 855B48     561            mov x+1, Probe1_Temp+1
1185 754B88     562            mov y+0, #low (5000 % 0x10000) 
1188 754C13     562            mov y+1, #high(5000 % 0x10000) 
118B 754D00     562            mov y+2, #low (5000 / 0x10000) 
118E 754E00     562            mov y+3, #high(5000 / 0x10000) 
1191 12024D     563            lcall x_gt_y
1194 300003     564            jnb mf, No_Probe1_Error
1197 437F80     565            orl Error_Codes, #10000000b
119A            566   No_Probe1_Error:
119A 855C47     567            mov x+0, Probe2_Temp+0
119D 855D48     568            mov x+1, Probe2_Temp+1
11A0 12024D     569            lcall x_gt_y
11A3 300003     570            jnb mf, No_Probe2_Error
11A6 437F80     571            orl Error_Codes, #10000000b
11A9            572   No_Probe2_Error:
11A9 855E47     573            mov x+0, Probe3_Temp+0
11AC 855F48     574            mov x+1, Probe3_Temp+1
11AF 12024D     575            lcall x_gt_y
11B2 300003     576            jnb mf, No_Probe3_Error
11B5 437F80     577            orl Error_Codes, #10000000b
11B8            578   No_Probe3_Error:
11B8 22         579            ret
11B9            580   
11B9            581   ;--------------------------------------------;
11B9            582   ;Select_Presets and the preset functions
11B9            583   ;--------------------------------------------;
11B9            584   Select_Presets:
11B9 C000       585            push ar0
11BB C001       585            push ar1
11BD C002       585            push ar2
11BF C003       585            push ar3
11C1 C004       585            push ar4
11C3 C005       585            push ar5
11C5 C006       585            push ar6
11C7 C007       585            push ar7
11C9 C0E0       585            push acc
11CB 7800       585            mov R0, #0x00                   ;R0 is the exit flag, reset the exit flag
11CD 7900       585            mov R1, #0x00                   ;R1 is the Cursor position register
11CF 7A00       585            mov R2, #0x00                   ;R2 is the number of functions flag
11D1            585            
11D1            585            
11D1            585            ;We put the information about the functions in R2,bits 0,1,2 correspond to funcs 2,3,4
11D1 7400       585            mov a, #0x00                    ;clear a
11D3            585            ;jnb 1, Menu_No_Func_2
11D3 7401       585            mov a, #0x01
11D5 B40101     585            cjne a, #0x01, Menu_No_Func_280
11D8 0A         585            inc R2
11D9            585            ;orl a, #00000001B              ;put a 1 in bit 0 to indicate FUNC 2 activated
11D9            585   Menu_No_Func_280:
11D9            585            ;jnb 1, Menu_No_Func_3
11D9 7401       585            mov a, #0x01
11DB B40101     585            cjne a, #0x01, Menu_No_Func_380
11DE 0A         585            inc R2
11DF            585            ;orl a, #00000010B              ;put a 1 in bit 1 to indicate FUNC 3 activated
11DF            585   Menu_No_Func_380:
11DF            585            ;jnb 1, Menu_No_Func_4
11DF 7401       585            mov a, #0x01
11E1 B40101     585            cjne a, #0x01, Menu_No_Func_480
11E4 0A         585            inc R2
11E5            585            ;orl a, #00000100B              ;put a 1 in bit 2 to indicate FUNC 4 activated
11E5            585   Menu_No_Func_480:
11E5            585                                    ;put the result into R2, this indicates the #of funcs   ;sets up the function flag register
11E5            585            ;R2 is the function flag register
11E5            585            
11E5            585            ;display the screen after it has switched. This stays inside the 
11E5            585            ;change cursor part so it only updates when pressed, not constantly.
11E5 E9         585            mov a, R1
11E6 B40079     585            cjne a, #0x00, Menu_Display_not_ONE81
11E9 C0E0       585            push acc
11EB 7401       585            mov a, #1
11ED 14         585            dec a
11EE 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
11F1 D0E0       585            pop acc
11F3 C083       585            push dph
11F5 C082       585            push dpl
11F7 C0E0       585            push acc
11F9 900D1A     585            mov dptr, #CLEARLINE
11FC 1200B4     585            lcall ?Send_Constant_String
11FF D0E0       585            pop acc
1201 D082       585            pop dpl
1203 D083       585            pop dph
1205 C0E0       585            push acc
1207 7401       585            mov a, #1
1209 14         585            dec a
120A 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
120D D0E0       585            pop acc
120F C083       585            push dph
1211 C082       585            push dpl
1213 C0E0       585            push acc
1215 900D91     585            mov dptr, #PresetTop1
1218 1200B4     585            lcall ?Send_Constant_String
121B D0E0       585            pop acc
121D D082       585            pop dpl
121F D083       585            pop dph                 ;display top half, cursor >
1221            585            ;check if its required to display bottom half
1221 EA         585            mov a, R2
1222 5402       585            anl a, #0x02
1224 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom82
1227 C0E0       585            push acc
1229 7401       585            mov a, #1
122B 14         585            dec a
122C 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
122F D0E0       585            pop acc
1231 C083       585            push dph
1233 C082       585            push dpl
1235 C0E0       585            push acc
1237 900D1A     585            mov dptr, #CLEARLINE
123A 1200B4     585            lcall ?Send_Constant_String
123D D0E0       585            pop acc
123F D082       585            pop dpl
1241 D083       585            pop dph
1243 C0E0       585            push acc
1245 7401       585            mov a, #1
1247 14         585            dec a
1248 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
124B D0E0       585            pop acc
124D C083       585            push dph
124F C082       585            push dpl
1251 C0E0       585            push acc
1253 900DE6     585            mov dptr, #PresetBtm3
1256 1200B4     585            lcall ?Send_Constant_String
1259 D0E0       585            pop acc
125B D082       585            pop dpl
125D D083       585            pop dph                 ;display bottom half no cursor
125F            585   Skip_Displaying_Bottom82:                        
125F 0213D9     585            ljmp Menu_Done_Display_Cursor_Change81  
1262            585                    
1262            585   Menu_Display_not_ONE81:
1262 E9         585                    mov a, R1
1263 B40179     585                    cjne a, #0x01, Menu_Display_not_TWO81
1266 C0E0       585            push acc
1268 7401       585            mov a, #1
126A 14         585            dec a
126B 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
126E D0E0       585            pop acc
1270 C083       585            push dph
1272 C082       585            push dpl
1274 C0E0       585            push acc
1276 900D1A     585            mov dptr, #CLEARLINE
1279 1200B4     585            lcall ?Send_Constant_String
127C D0E0       585            pop acc
127E D082       585            pop dpl
1280 D083       585            pop dph
1282 C0E0       585            push acc
1284 7401       585            mov a, #1
1286 14         585            dec a
1287 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
128A D0E0       585            pop acc
128C C083       585            push dph
128E C082       585            push dpl
1290 C0E0       585            push acc
1292 900DA2     585            mov dptr, #PresetTop2
1295 1200B4     585            lcall ?Send_Constant_String
1298 D0E0       585            pop acc
129A D082       585            pop dpl
129C D083       585            pop dph                 ;display top half, cursor >
129E            585            ;check if its required to display bottom half
129E EA         585            mov a, R2
129F 5402       585            anl a, #0x02
12A1 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom91
12A4 C0E0       585            push acc
12A6 7401       585            mov a, #1
12A8 14         585            dec a
12A9 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
12AC D0E0       585            pop acc
12AE C083       585            push dph
12B0 C082       585            push dpl
12B2 C0E0       585            push acc
12B4 900D1A     585            mov dptr, #CLEARLINE
12B7 1200B4     585            lcall ?Send_Constant_String
12BA D0E0       585            pop acc
12BC D082       585            pop dpl
12BE D083       585            pop dph
12C0 C0E0       585            push acc
12C2 7401       585            mov a, #1
12C4 14         585            dec a
12C5 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
12C8 D0E0       585            pop acc
12CA C083       585            push dph
12CC C082       585            push dpl
12CE C0E0       585            push acc
12D0 900DE6     585            mov dptr, #PresetBtm3
12D3 1200B4     585            lcall ?Send_Constant_String
12D6 D0E0       585            pop acc
12D8 D082       585            pop dpl
12DA D083       585            pop dph                 ;display bottom half no cursor
12DC            585   Skip_Displaying_Bottom91:
12DC 0213D9     585                    ljmp Menu_Done_Display_Cursor_Change81
12DF            585                                    
12DF            585   Menu_Display_not_TWO81:
12DF E9         585                    mov a, R1
12E0 B40279     585                    cjne a, #0x02, Menu_Display_not_THREE81
12E3 C0E0       585            push acc
12E5 7401       585            mov a, #1
12E7 14         585            dec a
12E8 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
12EB D0E0       585            pop acc
12ED C083       585            push dph
12EF C082       585            push dpl
12F1 C0E0       585            push acc
12F3 900D1A     585            mov dptr, #CLEARLINE
12F6 1200B4     585            lcall ?Send_Constant_String
12F9 D0E0       585            pop acc
12FB D082       585            pop dpl
12FD D083       585            pop dph
12FF C0E0       585            push acc
1301 7401       585            mov a, #1
1303 14         585            dec a
1304 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1307 D0E0       585            pop acc
1309 C083       585            push dph
130B C082       585            push dpl
130D C0E0       585            push acc
130F 900DB3     585            mov dptr, #PresetTop3
1312 1200B4     585            lcall ?Send_Constant_String
1315 D0E0       585            pop acc
1317 D082       585            pop dpl
1319 D083       585            pop dph                 ;display top half, cursor >
131B            585            ;check if its required to display bottom half
131B EA         585            mov a, R2
131C 5402       585            anl a, #0x02
131E B40238     585            cjne a, #0x02, Skip_Displaying_Bottom100
1321 C0E0       585            push acc
1323 7401       585            mov a, #1
1325 14         585            dec a
1326 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1329 D0E0       585            pop acc
132B C083       585            push dph
132D C082       585            push dpl
132F C0E0       585            push acc
1331 900D1A     585            mov dptr, #CLEARLINE
1334 1200B4     585            lcall ?Send_Constant_String
1337 D0E0       585            pop acc
1339 D082       585            pop dpl
133B D083       585            pop dph
133D C0E0       585            push acc
133F 7401       585            mov a, #1
1341 14         585            dec a
1342 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1345 D0E0       585            pop acc
1347 C083       585            push dph
1349 C082       585            push dpl
134B C0E0       585            push acc
134D 900DC4     585            mov dptr, #PresetBtm1
1350 1200B4     585            lcall ?Send_Constant_String
1353 D0E0       585            pop acc
1355 D082       585            pop dpl
1357 D083       585            pop dph                 ;display bottom half no cursor
1359            585   Skip_Displaying_Bottom100:
1359 0213D9     585                    ljmp Menu_Done_Display_Cursor_Change81
135C            585                                    
135C            585   Menu_Display_not_THREE81:
135C E9         585                    mov a, R1
135D B40379     585                    cjne a, #0x03, Menu_Display_not_FOUR81
1360 C0E0       585            push acc
1362 7401       585            mov a, #1
1364 14         585            dec a
1365 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1368 D0E0       585            pop acc
136A C083       585            push dph
136C C082       585            push dpl
136E C0E0       585            push acc
1370 900D1A     585            mov dptr, #CLEARLINE
1373 1200B4     585            lcall ?Send_Constant_String
1376 D0E0       585            pop acc
1378 D082       585            pop dpl
137A D083       585            pop dph
137C C0E0       585            push acc
137E 7401       585            mov a, #1
1380 14         585            dec a
1381 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1384 D0E0       585            pop acc
1386 C083       585            push dph
1388 C082       585            push dpl
138A C0E0       585            push acc
138C 900DB3     585            mov dptr, #PresetTop3
138F 1200B4     585            lcall ?Send_Constant_String
1392 D0E0       585            pop acc
1394 D082       585            pop dpl
1396 D083       585            pop dph                 ;display top half, cursor >
1398            585            ;check if its required to display bottom half
1398 EA         585            mov a, R2
1399 5402       585            anl a, #0x02
139B B40238     585            cjne a, #0x02, Skip_Displaying_Bottom109
139E C0E0       585            push acc
13A0 7401       585            mov a, #1
13A2 14         585            dec a
13A3 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
13A6 D0E0       585            pop acc
13A8 C083       585            push dph
13AA C082       585            push dpl
13AC C0E0       585            push acc
13AE 900D1A     585            mov dptr, #CLEARLINE
13B1 1200B4     585            lcall ?Send_Constant_String
13B4 D0E0       585            pop acc
13B6 D082       585            pop dpl
13B8 D083       585            pop dph
13BA C0E0       585            push acc
13BC 7401       585            mov a, #1
13BE 14         585            dec a
13BF 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
13C2 D0E0       585            pop acc
13C4 C083       585            push dph
13C6 C082       585            push dpl
13C8 C0E0       585            push acc
13CA 900DD5     585            mov dptr, #PresetBtm2
13CD 1200B4     585            lcall ?Send_Constant_String
13D0 D0E0       585            pop acc
13D2 D082       585            pop dpl
13D4 D083       585            pop dph                 ;display bottom half no cursor
13D6            585   Skip_Displaying_Bottom109:       
13D6 0213D9     585                    ljmp Menu_Done_Display_Cursor_Change81
13D9            585                                    
13D9            585   Menu_Display_not_FOUR81:
13D9            585   Menu_Done_Display_Cursor_Change81:       ;display on LCD
13D9            585   
13D9            585   ;The loop that will happen over and over in each level of the menu
13D9            585   Menu_Loop79:
13D9            585   
13D9            585            ;First, Check to see if the user wants to INC the cursors location
13D9 20A614     585            jb B0, Menu_Skip_Cursor_INCtp79         ; if the 'B0' button is not pressed skip
13DC C002       585            push AR2
13DE 7A0A       585            mov R2, #10
13E0 120039     585            lcall ?Wait_Milli_Seconds
13E3 D002       585            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
13E5 20A608     585            jb B0, Menu_Skip_Cursor_INCtp79         ; if the 'B0' button is not pressed skip
13E8 30A6FD     585            jnb B0, $                               ; Wait for button release.
13EB 30A5FD     585            jnb B2, $                               ; Wait for button release.
13EE            585            ;The below code is used to get around the max jb jump distance
13EE 8003       585            sjmp Menu_INC_Cursor79
13F0            585   Menu_Skip_Cursor_INCtp79:
13F0 0215EB     585            ljmp Menu_Skip_Cursor_INC79
13F3            585   Menu_INC_Cursor79:       
13F3 09         585            INC R1                                                  ;increment the cursors position
13F4 1210D9     585            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
13F7            585            ;display the screen after it has switched. This stays inside the 
13F7            585            ;change cursor part so it only updates when pressed, not constantly.
13F7 E9         585            mov a, R1
13F8 B40079     585            cjne a, #0x00, Menu_Display_not_ONE119
13FB C0E0       585            push acc
13FD 7401       585            mov a, #1
13FF 14         585            dec a
1400 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1403 D0E0       585            pop acc
1405 C083       585            push dph
1407 C082       585            push dpl
1409 C0E0       585            push acc
140B 900D1A     585            mov dptr, #CLEARLINE
140E 1200B4     585            lcall ?Send_Constant_String
1411 D0E0       585            pop acc
1413 D082       585            pop dpl
1415 D083       585            pop dph
1417 C0E0       585            push acc
1419 7401       585            mov a, #1
141B 14         585            dec a
141C 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
141F D0E0       585            pop acc
1421 C083       585            push dph
1423 C082       585            push dpl
1425 C0E0       585            push acc
1427 900D91     585            mov dptr, #PresetTop1
142A 1200B4     585            lcall ?Send_Constant_String
142D D0E0       585            pop acc
142F D082       585            pop dpl
1431 D083       585            pop dph                 ;display top half, cursor >
1433            585            ;check if its required to display bottom half
1433 EA         585            mov a, R2
1434 5402       585            anl a, #0x02
1436 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom120
1439 C0E0       585            push acc
143B 7401       585            mov a, #1
143D 14         585            dec a
143E 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1441 D0E0       585            pop acc
1443 C083       585            push dph
1445 C082       585            push dpl
1447 C0E0       585            push acc
1449 900D1A     585            mov dptr, #CLEARLINE
144C 1200B4     585            lcall ?Send_Constant_String
144F D0E0       585            pop acc
1451 D082       585            pop dpl
1453 D083       585            pop dph
1455 C0E0       585            push acc
1457 7401       585            mov a, #1
1459 14         585            dec a
145A 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
145D D0E0       585            pop acc
145F C083       585            push dph
1461 C082       585            push dpl
1463 C0E0       585            push acc
1465 900DE6     585            mov dptr, #PresetBtm3
1468 1200B4     585            lcall ?Send_Constant_String
146B D0E0       585            pop acc
146D D082       585            pop dpl
146F D083       585            pop dph                 ;display bottom half no cursor
1471            585   Skip_Displaying_Bottom120:                       
1471 0215EB     585            ljmp Menu_Done_Display_Cursor_Change119         
1474            585                    
1474            585   Menu_Display_not_ONE119:
1474 E9         585                    mov a, R1
1475 B40179     585                    cjne a, #0x01, Menu_Display_not_TWO119
1478 C0E0       585            push acc
147A 7401       585            mov a, #1
147C 14         585            dec a
147D 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1480 D0E0       585            pop acc
1482 C083       585            push dph
1484 C082       585            push dpl
1486 C0E0       585            push acc
1488 900D1A     585            mov dptr, #CLEARLINE
148B 1200B4     585            lcall ?Send_Constant_String
148E D0E0       585            pop acc
1490 D082       585            pop dpl
1492 D083       585            pop dph
1494 C0E0       585            push acc
1496 7401       585            mov a, #1
1498 14         585            dec a
1499 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
149C D0E0       585            pop acc
149E C083       585            push dph
14A0 C082       585            push dpl
14A2 C0E0       585            push acc
14A4 900DA2     585            mov dptr, #PresetTop2
14A7 1200B4     585            lcall ?Send_Constant_String
14AA D0E0       585            pop acc
14AC D082       585            pop dpl
14AE D083       585            pop dph                 ;display top half, cursor >
14B0            585            ;check if its required to display bottom half
14B0 EA         585            mov a, R2
14B1 5402       585            anl a, #0x02
14B3 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom129
14B6 C0E0       585            push acc
14B8 7401       585            mov a, #1
14BA 14         585            dec a
14BB 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
14BE D0E0       585            pop acc
14C0 C083       585            push dph
14C2 C082       585            push dpl
14C4 C0E0       585            push acc
14C6 900D1A     585            mov dptr, #CLEARLINE
14C9 1200B4     585            lcall ?Send_Constant_String
14CC D0E0       585            pop acc
14CE D082       585            pop dpl
14D0 D083       585            pop dph
14D2 C0E0       585            push acc
14D4 7401       585            mov a, #1
14D6 14         585            dec a
14D7 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
14DA D0E0       585            pop acc
14DC C083       585            push dph
14DE C082       585            push dpl
14E0 C0E0       585            push acc
14E2 900DE6     585            mov dptr, #PresetBtm3
14E5 1200B4     585            lcall ?Send_Constant_String
14E8 D0E0       585            pop acc
14EA D082       585            pop dpl
14EC D083       585            pop dph                 ;display bottom half no cursor
14EE            585   Skip_Displaying_Bottom129:
14EE 0215EB     585                    ljmp Menu_Done_Display_Cursor_Change119
14F1            585                                    
14F1            585   Menu_Display_not_TWO119:
14F1 E9         585                    mov a, R1
14F2 B40279     585                    cjne a, #0x02, Menu_Display_not_THREE119
14F5 C0E0       585            push acc
14F7 7401       585            mov a, #1
14F9 14         585            dec a
14FA 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
14FD D0E0       585            pop acc
14FF C083       585            push dph
1501 C082       585            push dpl
1503 C0E0       585            push acc
1505 900D1A     585            mov dptr, #CLEARLINE
1508 1200B4     585            lcall ?Send_Constant_String
150B D0E0       585            pop acc
150D D082       585            pop dpl
150F D083       585            pop dph
1511 C0E0       585            push acc
1513 7401       585            mov a, #1
1515 14         585            dec a
1516 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1519 D0E0       585            pop acc
151B C083       585            push dph
151D C082       585            push dpl
151F C0E0       585            push acc
1521 900DB3     585            mov dptr, #PresetTop3
1524 1200B4     585            lcall ?Send_Constant_String
1527 D0E0       585            pop acc
1529 D082       585            pop dpl
152B D083       585            pop dph                 ;display top half, cursor >
152D            585            ;check if its required to display bottom half
152D EA         585            mov a, R2
152E 5402       585            anl a, #0x02
1530 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom138
1533 C0E0       585            push acc
1535 7401       585            mov a, #1
1537 14         585            dec a
1538 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
153B D0E0       585            pop acc
153D C083       585            push dph
153F C082       585            push dpl
1541 C0E0       585            push acc
1543 900D1A     585            mov dptr, #CLEARLINE
1546 1200B4     585            lcall ?Send_Constant_String
1549 D0E0       585            pop acc
154B D082       585            pop dpl
154D D083       585            pop dph
154F C0E0       585            push acc
1551 7401       585            mov a, #1
1553 14         585            dec a
1554 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1557 D0E0       585            pop acc
1559 C083       585            push dph
155B C082       585            push dpl
155D C0E0       585            push acc
155F 900DC4     585            mov dptr, #PresetBtm1
1562 1200B4     585            lcall ?Send_Constant_String
1565 D0E0       585            pop acc
1567 D082       585            pop dpl
1569 D083       585            pop dph                 ;display bottom half no cursor
156B            585   Skip_Displaying_Bottom138:
156B 0215EB     585                    ljmp Menu_Done_Display_Cursor_Change119
156E            585                                    
156E            585   Menu_Display_not_THREE119:
156E E9         585                    mov a, R1
156F B40379     585                    cjne a, #0x03, Menu_Display_not_FOUR119
1572 C0E0       585            push acc
1574 7401       585            mov a, #1
1576 14         585            dec a
1577 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
157A D0E0       585            pop acc
157C C083       585            push dph
157E C082       585            push dpl
1580 C0E0       585            push acc
1582 900D1A     585            mov dptr, #CLEARLINE
1585 1200B4     585            lcall ?Send_Constant_String
1588 D0E0       585            pop acc
158A D082       585            pop dpl
158C D083       585            pop dph
158E C0E0       585            push acc
1590 7401       585            mov a, #1
1592 14         585            dec a
1593 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1596 D0E0       585            pop acc
1598 C083       585            push dph
159A C082       585            push dpl
159C C0E0       585            push acc
159E 900DB3     585            mov dptr, #PresetTop3
15A1 1200B4     585            lcall ?Send_Constant_String
15A4 D0E0       585            pop acc
15A6 D082       585            pop dpl
15A8 D083       585            pop dph                 ;display top half, cursor >
15AA            585            ;check if its required to display bottom half
15AA EA         585            mov a, R2
15AB 5402       585            anl a, #0x02
15AD B40238     585            cjne a, #0x02, Skip_Displaying_Bottom147
15B0 C0E0       585            push acc
15B2 7401       585            mov a, #1
15B4 14         585            dec a
15B5 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
15B8 D0E0       585            pop acc
15BA C083       585            push dph
15BC C082       585            push dpl
15BE C0E0       585            push acc
15C0 900D1A     585            mov dptr, #CLEARLINE
15C3 1200B4     585            lcall ?Send_Constant_String
15C6 D0E0       585            pop acc
15C8 D082       585            pop dpl
15CA D083       585            pop dph
15CC C0E0       585            push acc
15CE 7401       585            mov a, #1
15D0 14         585            dec a
15D1 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
15D4 D0E0       585            pop acc
15D6 C083       585            push dph
15D8 C082       585            push dpl
15DA C0E0       585            push acc
15DC 900DD5     585            mov dptr, #PresetBtm2
15DF 1200B4     585            lcall ?Send_Constant_String
15E2 D0E0       585            pop acc
15E4 D082       585            pop dpl
15E6 D083       585            pop dph                 ;display bottom half no cursor
15E8            585   Skip_Displaying_Bottom147:       
15E8 0215EB     585                    ljmp Menu_Done_Display_Cursor_Change119
15EB            585                                    
15EB            585   Menu_Display_not_FOUR119:
15EB            585   Menu_Done_Display_Cursor_Change119:      ;display on LCD
15EB            585            
15EB            585   Menu_Skip_Cursor_INC79:
15EB            585   
15EB            585            ;Then, Check to see if the user wants to DEC the cursors location
15EB 20A514     585            jb B2, Menu_Skip_Cursor_DECtp79         ; if the 'B0' button is not pressed skip
15EE C002       585            push AR2
15F0 7A0A       585            mov R2, #10
15F2 120039     585            lcall ?Wait_Milli_Seconds
15F5 D002       585            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
15F7 20A508     585            jb B2, Menu_Skip_Cursor_DECtp79         ; if the 'B0' button is not pressed skip
15FA 30A5FD     585            jnb B2, $                               ; Wait for button release.
15FD 30A6FD     585            jnb B0, $                               ; Wait for button release.
1600            585            ;The below code is used to get around the max jb jump distance
1600 8003       585            sjmp Menu_DEC_Cursor79
1602            585   Menu_Skip_Cursor_DECtp79:
1602 0217FD     585            ljmp Menu_Skip_Cursor_DEC79
1605            585   Menu_DEC_Cursor79:       
1605 19         585            DEC R1                                                  ;increment the cursors position
1606 1210D9     585            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
1609            585            ;display the screen after it has switched. This stays inside the 
1609            585            ;change cursor part so it only updates when pressed, not constantly.
1609 E9         585            mov a, R1
160A B40079     585            cjne a, #0x00, Menu_Display_not_ONE157
160D C0E0       585            push acc
160F 7401       585            mov a, #1
1611 14         585            dec a
1612 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1615 D0E0       585            pop acc
1617 C083       585            push dph
1619 C082       585            push dpl
161B C0E0       585            push acc
161D 900D1A     585            mov dptr, #CLEARLINE
1620 1200B4     585            lcall ?Send_Constant_String
1623 D0E0       585            pop acc
1625 D082       585            pop dpl
1627 D083       585            pop dph
1629 C0E0       585            push acc
162B 7401       585            mov a, #1
162D 14         585            dec a
162E 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1631 D0E0       585            pop acc
1633 C083       585            push dph
1635 C082       585            push dpl
1637 C0E0       585            push acc
1639 900D91     585            mov dptr, #PresetTop1
163C 1200B4     585            lcall ?Send_Constant_String
163F D0E0       585            pop acc
1641 D082       585            pop dpl
1643 D083       585            pop dph                 ;display top half, cursor >
1645            585            ;check if its required to display bottom half
1645 EA         585            mov a, R2
1646 5402       585            anl a, #0x02
1648 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom158
164B C0E0       585            push acc
164D 7401       585            mov a, #1
164F 14         585            dec a
1650 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1653 D0E0       585            pop acc
1655 C083       585            push dph
1657 C082       585            push dpl
1659 C0E0       585            push acc
165B 900D1A     585            mov dptr, #CLEARLINE
165E 1200B4     585            lcall ?Send_Constant_String
1661 D0E0       585            pop acc
1663 D082       585            pop dpl
1665 D083       585            pop dph
1667 C0E0       585            push acc
1669 7401       585            mov a, #1
166B 14         585            dec a
166C 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
166F D0E0       585            pop acc
1671 C083       585            push dph
1673 C082       585            push dpl
1675 C0E0       585            push acc
1677 900DE6     585            mov dptr, #PresetBtm3
167A 1200B4     585            lcall ?Send_Constant_String
167D D0E0       585            pop acc
167F D082       585            pop dpl
1681 D083       585            pop dph                 ;display bottom half no cursor
1683            585   Skip_Displaying_Bottom158:                       
1683 0217FD     585            ljmp Menu_Done_Display_Cursor_Change157         
1686            585                    
1686            585   Menu_Display_not_ONE157:
1686 E9         585                    mov a, R1
1687 B40179     585                    cjne a, #0x01, Menu_Display_not_TWO157
168A C0E0       585            push acc
168C 7401       585            mov a, #1
168E 14         585            dec a
168F 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1692 D0E0       585            pop acc
1694 C083       585            push dph
1696 C082       585            push dpl
1698 C0E0       585            push acc
169A 900D1A     585            mov dptr, #CLEARLINE
169D 1200B4     585            lcall ?Send_Constant_String
16A0 D0E0       585            pop acc
16A2 D082       585            pop dpl
16A4 D083       585            pop dph
16A6 C0E0       585            push acc
16A8 7401       585            mov a, #1
16AA 14         585            dec a
16AB 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
16AE D0E0       585            pop acc
16B0 C083       585            push dph
16B2 C082       585            push dpl
16B4 C0E0       585            push acc
16B6 900DA2     585            mov dptr, #PresetTop2
16B9 1200B4     585            lcall ?Send_Constant_String
16BC D0E0       585            pop acc
16BE D082       585            pop dpl
16C0 D083       585            pop dph                 ;display top half, cursor >
16C2            585            ;check if its required to display bottom half
16C2 EA         585            mov a, R2
16C3 5402       585            anl a, #0x02
16C5 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom167
16C8 C0E0       585            push acc
16CA 7401       585            mov a, #1
16CC 14         585            dec a
16CD 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
16D0 D0E0       585            pop acc
16D2 C083       585            push dph
16D4 C082       585            push dpl
16D6 C0E0       585            push acc
16D8 900D1A     585            mov dptr, #CLEARLINE
16DB 1200B4     585            lcall ?Send_Constant_String
16DE D0E0       585            pop acc
16E0 D082       585            pop dpl
16E2 D083       585            pop dph
16E4 C0E0       585            push acc
16E6 7401       585            mov a, #1
16E8 14         585            dec a
16E9 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
16EC D0E0       585            pop acc
16EE C083       585            push dph
16F0 C082       585            push dpl
16F2 C0E0       585            push acc
16F4 900DE6     585            mov dptr, #PresetBtm3
16F7 1200B4     585            lcall ?Send_Constant_String
16FA D0E0       585            pop acc
16FC D082       585            pop dpl
16FE D083       585            pop dph                 ;display bottom half no cursor
1700            585   Skip_Displaying_Bottom167:
1700 0217FD     585                    ljmp Menu_Done_Display_Cursor_Change157
1703            585                                    
1703            585   Menu_Display_not_TWO157:
1703 E9         585                    mov a, R1
1704 B40279     585                    cjne a, #0x02, Menu_Display_not_THREE157
1707 C0E0       585            push acc
1709 7401       585            mov a, #1
170B 14         585            dec a
170C 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
170F D0E0       585            pop acc
1711 C083       585            push dph
1713 C082       585            push dpl
1715 C0E0       585            push acc
1717 900D1A     585            mov dptr, #CLEARLINE
171A 1200B4     585            lcall ?Send_Constant_String
171D D0E0       585            pop acc
171F D082       585            pop dpl
1721 D083       585            pop dph
1723 C0E0       585            push acc
1725 7401       585            mov a, #1
1727 14         585            dec a
1728 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
172B D0E0       585            pop acc
172D C083       585            push dph
172F C082       585            push dpl
1731 C0E0       585            push acc
1733 900DB3     585            mov dptr, #PresetTop3
1736 1200B4     585            lcall ?Send_Constant_String
1739 D0E0       585            pop acc
173B D082       585            pop dpl
173D D083       585            pop dph                 ;display top half, cursor >
173F            585            ;check if its required to display bottom half
173F EA         585            mov a, R2
1740 5402       585            anl a, #0x02
1742 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom176
1745 C0E0       585            push acc
1747 7401       585            mov a, #1
1749 14         585            dec a
174A 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
174D D0E0       585            pop acc
174F C083       585            push dph
1751 C082       585            push dpl
1753 C0E0       585            push acc
1755 900D1A     585            mov dptr, #CLEARLINE
1758 1200B4     585            lcall ?Send_Constant_String
175B D0E0       585            pop acc
175D D082       585            pop dpl
175F D083       585            pop dph
1761 C0E0       585            push acc
1763 7401       585            mov a, #1
1765 14         585            dec a
1766 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1769 D0E0       585            pop acc
176B C083       585            push dph
176D C082       585            push dpl
176F C0E0       585            push acc
1771 900DC4     585            mov dptr, #PresetBtm1
1774 1200B4     585            lcall ?Send_Constant_String
1777 D0E0       585            pop acc
1779 D082       585            pop dpl
177B D083       585            pop dph                 ;display bottom half no cursor
177D            585   Skip_Displaying_Bottom176:
177D 0217FD     585                    ljmp Menu_Done_Display_Cursor_Change157
1780            585                                    
1780            585   Menu_Display_not_THREE157:
1780 E9         585                    mov a, R1
1781 B40379     585                    cjne a, #0x03, Menu_Display_not_FOUR157
1784 C0E0       585            push acc
1786 7401       585            mov a, #1
1788 14         585            dec a
1789 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
178C D0E0       585            pop acc
178E C083       585            push dph
1790 C082       585            push dpl
1792 C0E0       585            push acc
1794 900D1A     585            mov dptr, #CLEARLINE
1797 1200B4     585            lcall ?Send_Constant_String
179A D0E0       585            pop acc
179C D082       585            pop dpl
179E D083       585            pop dph
17A0 C0E0       585            push acc
17A2 7401       585            mov a, #1
17A4 14         585            dec a
17A5 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
17A8 D0E0       585            pop acc
17AA C083       585            push dph
17AC C082       585            push dpl
17AE C0E0       585            push acc
17B0 900DB3     585            mov dptr, #PresetTop3
17B3 1200B4     585            lcall ?Send_Constant_String
17B6 D0E0       585            pop acc
17B8 D082       585            pop dpl
17BA D083       585            pop dph                 ;display top half, cursor >
17BC            585            ;check if its required to display bottom half
17BC EA         585            mov a, R2
17BD 5402       585            anl a, #0x02
17BF B40238     585            cjne a, #0x02, Skip_Displaying_Bottom185
17C2 C0E0       585            push acc
17C4 7401       585            mov a, #1
17C6 14         585            dec a
17C7 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
17CA D0E0       585            pop acc
17CC C083       585            push dph
17CE C082       585            push dpl
17D0 C0E0       585            push acc
17D2 900D1A     585            mov dptr, #CLEARLINE
17D5 1200B4     585            lcall ?Send_Constant_String
17D8 D0E0       585            pop acc
17DA D082       585            pop dpl
17DC D083       585            pop dph
17DE C0E0       585            push acc
17E0 7401       585            mov a, #1
17E2 14         585            dec a
17E3 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
17E6 D0E0       585            pop acc
17E8 C083       585            push dph
17EA C082       585            push dpl
17EC C0E0       585            push acc
17EE 900DD5     585            mov dptr, #PresetBtm2
17F1 1200B4     585            lcall ?Send_Constant_String
17F4 D0E0       585            pop acc
17F6 D082       585            pop dpl
17F8 D083       585            pop dph                 ;display bottom half no cursor
17FA            585   Skip_Displaying_Bottom185:       
17FA 0217FD     585                    ljmp Menu_Done_Display_Cursor_Change157
17FD            585                                    
17FD            585   Menu_Display_not_FOUR157:
17FD            585   Menu_Done_Display_Cursor_Change157:      ;display on LCD
17FD            585            
17FD            585   Menu_Skip_Cursor_DEC79:
17FD            585   
17FD            585            ;Check if the user wanted to exit the level of the menu
17FD E8         585            mov a, R0
17FE B40105     585            cjne a, #0x01, Menu_Stay79      ;if the flag is not 1, continue program, otherwise reset flag and return
1801 7800       585            mov R0, #0x00
1803 021A41     585            ljmp Menu_Exit_Level79
1806            585            
1806            585   Menu_Stay79:     
1806            585            ;now the code that operates when the "select" button is pressed
1806 20A711     585            jb B1, Menu_Skip_Select_Changetp79      ; if the 'B1' button is not pressed skip
1809 C002       585            push AR2
180B 7A32       585            mov R2, #50
180D 120039     585            lcall ?Wait_Milli_Seconds
1810 D002       585            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
1812 20A705     585            jb B1, Menu_Skip_Select_Changetp79      ; if the 'B1' button is not pressed skip
1815 30A7FD     585            jnb B1, $                               ; Wait for button release
1818            585            ;The below code is used to get around the max jb jump distance 
1818 8003       585            sjmp Menu_Select_Change79
181A            585   Menu_Skip_Select_Changetp79:
181A 021A3B     585            ljmp Menu_Skip_Select_Change79  ;the button was not pressed.
181D            585            
181D            585   Menu_Select_Change79:
181D            585            
181D            585   ;We simply compare what number is in the cursor and enter that function
181D E9         585            mov a, R1
181E B40006     585            cjne a, #0x00, Menu_Not_Func_One_Select195
1821            585            ;if here, then the cursor is on the above position
1821 1200ED     585            lcall Menu_Back
1824 021845     585            ljmp Menu_Done_Func195
1827            585                            
1827            585   Menu_Not_Func_One_Select195:
1827 E9         585                    mov a, R1
1828 B40106     585            cjne a, #0x01, Menu_Not_Func_Two_Select195
182B            585            ;if here, then the cursor is on the above position
182B 121A54     585            lcall Preset_1
182E 021845     585            ljmp Menu_Done_Func195
1831            585                            
1831            585   Menu_Not_Func_Two_Select195:
1831 E9         585            mov a, R1
1832 B40206     585            cjne a, #0x02, Menu_Not_Func_Three_Select195
1835            585            ;if here, then the cursor is on the above position
1835 121A5A     585            lcall Preset_2
1838 021845     585            ljmp Menu_Done_Func195
183B            585                            
183B            585   Menu_Not_Func_Three_Select195:
183B E9         585            mov a, R1
183C B40306     585            cjne a, #0x03, Menu_Not_Func_Four_Select195
183F            585            ;if here, then the cursor is on the above position
183F 121A60     585            lcall Preset_3
1842 021845     585            ljmp Menu_Done_Func195
1845            585                            
1845            585   Menu_Not_Func_Four_Select195:
1845            585   
1845            585   Menu_Done_Func195:
1845            585   
1845            585            ;after selecting the function and exiting it, reset the cursor position and the screen
1845 7900       585            mov R1, #0x00
1847            585            ;display the screen after it has switched. This stays inside the 
1847            585            ;change cursor part so it only updates when pressed, not constantly.
1847 E9         585            mov a, R1
1848 B40079     585            cjne a, #0x00, Menu_Display_not_ONE196
184B C0E0       585            push acc
184D 7401       585            mov a, #1
184F 14         585            dec a
1850 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1853 D0E0       585            pop acc
1855 C083       585            push dph
1857 C082       585            push dpl
1859 C0E0       585            push acc
185B 900D1A     585            mov dptr, #CLEARLINE
185E 1200B4     585            lcall ?Send_Constant_String
1861 D0E0       585            pop acc
1863 D082       585            pop dpl
1865 D083       585            pop dph
1867 C0E0       585            push acc
1869 7401       585            mov a, #1
186B 14         585            dec a
186C 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
186F D0E0       585            pop acc
1871 C083       585            push dph
1873 C082       585            push dpl
1875 C0E0       585            push acc
1877 900D91     585            mov dptr, #PresetTop1
187A 1200B4     585            lcall ?Send_Constant_String
187D D0E0       585            pop acc
187F D082       585            pop dpl
1881 D083       585            pop dph                 ;display top half, cursor >
1883            585            ;check if its required to display bottom half
1883 EA         585            mov a, R2
1884 5402       585            anl a, #0x02
1886 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom197
1889 C0E0       585            push acc
188B 7401       585            mov a, #1
188D 14         585            dec a
188E 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1891 D0E0       585            pop acc
1893 C083       585            push dph
1895 C082       585            push dpl
1897 C0E0       585            push acc
1899 900D1A     585            mov dptr, #CLEARLINE
189C 1200B4     585            lcall ?Send_Constant_String
189F D0E0       585            pop acc
18A1 D082       585            pop dpl
18A3 D083       585            pop dph
18A5 C0E0       585            push acc
18A7 7401       585            mov a, #1
18A9 14         585            dec a
18AA 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
18AD D0E0       585            pop acc
18AF C083       585            push dph
18B1 C082       585            push dpl
18B3 C0E0       585            push acc
18B5 900DE6     585            mov dptr, #PresetBtm3
18B8 1200B4     585            lcall ?Send_Constant_String
18BB D0E0       585            pop acc
18BD D082       585            pop dpl
18BF D083       585            pop dph                 ;display bottom half no cursor
18C1            585   Skip_Displaying_Bottom197:                       
18C1 021A3B     585            ljmp Menu_Done_Display_Cursor_Change196         
18C4            585                    
18C4            585   Menu_Display_not_ONE196:
18C4 E9         585                    mov a, R1
18C5 B40179     585                    cjne a, #0x01, Menu_Display_not_TWO196
18C8 C0E0       585            push acc
18CA 7401       585            mov a, #1
18CC 14         585            dec a
18CD 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
18D0 D0E0       585            pop acc
18D2 C083       585            push dph
18D4 C082       585            push dpl
18D6 C0E0       585            push acc
18D8 900D1A     585            mov dptr, #CLEARLINE
18DB 1200B4     585            lcall ?Send_Constant_String
18DE D0E0       585            pop acc
18E0 D082       585            pop dpl
18E2 D083       585            pop dph
18E4 C0E0       585            push acc
18E6 7401       585            mov a, #1
18E8 14         585            dec a
18E9 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
18EC D0E0       585            pop acc
18EE C083       585            push dph
18F0 C082       585            push dpl
18F2 C0E0       585            push acc
18F4 900DA2     585            mov dptr, #PresetTop2
18F7 1200B4     585            lcall ?Send_Constant_String
18FA D0E0       585            pop acc
18FC D082       585            pop dpl
18FE D083       585            pop dph                 ;display top half, cursor >
1900            585            ;check if its required to display bottom half
1900 EA         585            mov a, R2
1901 5402       585            anl a, #0x02
1903 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom206
1906 C0E0       585            push acc
1908 7401       585            mov a, #1
190A 14         585            dec a
190B 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
190E D0E0       585            pop acc
1910 C083       585            push dph
1912 C082       585            push dpl
1914 C0E0       585            push acc
1916 900D1A     585            mov dptr, #CLEARLINE
1919 1200B4     585            lcall ?Send_Constant_String
191C D0E0       585            pop acc
191E D082       585            pop dpl
1920 D083       585            pop dph
1922 C0E0       585            push acc
1924 7401       585            mov a, #1
1926 14         585            dec a
1927 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
192A D0E0       585            pop acc
192C C083       585            push dph
192E C082       585            push dpl
1930 C0E0       585            push acc
1932 900DE6     585            mov dptr, #PresetBtm3
1935 1200B4     585            lcall ?Send_Constant_String
1938 D0E0       585            pop acc
193A D082       585            pop dpl
193C D083       585            pop dph                 ;display bottom half no cursor
193E            585   Skip_Displaying_Bottom206:
193E 021A3B     585                    ljmp Menu_Done_Display_Cursor_Change196
1941            585                                    
1941            585   Menu_Display_not_TWO196:
1941 E9         585                    mov a, R1
1942 B40279     585                    cjne a, #0x02, Menu_Display_not_THREE196
1945 C0E0       585            push acc
1947 7401       585            mov a, #1
1949 14         585            dec a
194A 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
194D D0E0       585            pop acc
194F C083       585            push dph
1951 C082       585            push dpl
1953 C0E0       585            push acc
1955 900D1A     585            mov dptr, #CLEARLINE
1958 1200B4     585            lcall ?Send_Constant_String
195B D0E0       585            pop acc
195D D082       585            pop dpl
195F D083       585            pop dph
1961 C0E0       585            push acc
1963 7401       585            mov a, #1
1965 14         585            dec a
1966 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
1969 D0E0       585            pop acc
196B C083       585            push dph
196D C082       585            push dpl
196F C0E0       585            push acc
1971 900DB3     585            mov dptr, #PresetTop3
1974 1200B4     585            lcall ?Send_Constant_String
1977 D0E0       585            pop acc
1979 D082       585            pop dpl
197B D083       585            pop dph                 ;display top half, cursor >
197D            585            ;check if its required to display bottom half
197D EA         585            mov a, R2
197E 5402       585            anl a, #0x02
1980 B40238     585            cjne a, #0x02, Skip_Displaying_Bottom215
1983 C0E0       585            push acc
1985 7401       585            mov a, #1
1987 14         585            dec a
1988 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
198B D0E0       585            pop acc
198D C083       585            push dph
198F C082       585            push dpl
1991 C0E0       585            push acc
1993 900D1A     585            mov dptr, #CLEARLINE
1996 1200B4     585            lcall ?Send_Constant_String
1999 D0E0       585            pop acc
199B D082       585            pop dpl
199D D083       585            pop dph
199F C0E0       585            push acc
19A1 7401       585            mov a, #1
19A3 14         585            dec a
19A4 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
19A7 D0E0       585            pop acc
19A9 C083       585            push dph
19AB C082       585            push dpl
19AD C0E0       585            push acc
19AF 900DC4     585            mov dptr, #PresetBtm1
19B2 1200B4     585            lcall ?Send_Constant_String
19B5 D0E0       585            pop acc
19B7 D082       585            pop dpl
19B9 D083       585            pop dph                 ;display bottom half no cursor
19BB            585   Skip_Displaying_Bottom215:
19BB 021A3B     585                    ljmp Menu_Done_Display_Cursor_Change196
19BE            585                                    
19BE            585   Menu_Display_not_THREE196:
19BE E9         585                    mov a, R1
19BF B40379     585                    cjne a, #0x03, Menu_Display_not_FOUR196
19C2 C0E0       585            push acc
19C4 7401       585            mov a, #1
19C6 14         585            dec a
19C7 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
19CA D0E0       585            pop acc
19CC C083       585            push dph
19CE C082       585            push dpl
19D0 C0E0       585            push acc
19D2 900D1A     585            mov dptr, #CLEARLINE
19D5 1200B4     585            lcall ?Send_Constant_String
19D8 D0E0       585            pop acc
19DA D082       585            pop dpl
19DC D083       585            pop dph
19DE C0E0       585            push acc
19E0 7401       585            mov a, #1
19E2 14         585            dec a
19E3 1200C1     585            lcall ?Set_Cursor_1 ; Select column and row
19E6 D0E0       585            pop acc
19E8 C083       585            push dph
19EA C082       585            push dpl
19EC C0E0       585            push acc
19EE 900DB3     585            mov dptr, #PresetTop3
19F1 1200B4     585            lcall ?Send_Constant_String
19F4 D0E0       585            pop acc
19F6 D082       585            pop dpl
19F8 D083       585            pop dph                 ;display top half, cursor >
19FA            585            ;check if its required to display bottom half
19FA EA         585            mov a, R2
19FB 5402       585            anl a, #0x02
19FD B40238     585            cjne a, #0x02, Skip_Displaying_Bottom224
1A00 C0E0       585            push acc
1A02 7401       585            mov a, #1
1A04 14         585            dec a
1A05 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1A08 D0E0       585            pop acc
1A0A C083       585            push dph
1A0C C082       585            push dpl
1A0E C0E0       585            push acc
1A10 900D1A     585            mov dptr, #CLEARLINE
1A13 1200B4     585            lcall ?Send_Constant_String
1A16 D0E0       585            pop acc
1A18 D082       585            pop dpl
1A1A D083       585            pop dph
1A1C C0E0       585            push acc
1A1E 7401       585            mov a, #1
1A20 14         585            dec a
1A21 1200BF     585            lcall ?Set_Cursor_2 ; Select column and row
1A24 D0E0       585            pop acc
1A26 C083       585            push dph
1A28 C082       585            push dpl
1A2A C0E0       585            push acc
1A2C 900DD5     585            mov dptr, #PresetBtm2
1A2F 1200B4     585            lcall ?Send_Constant_String
1A32 D0E0       585            pop acc
1A34 D082       585            pop dpl
1A36 D083       585            pop dph                 ;display bottom half no cursor
1A38            585   Skip_Displaying_Bottom224:       
1A38 021A3B     585                    ljmp Menu_Done_Display_Cursor_Change196
1A3B            585                                    
1A3B            585   Menu_Display_not_FOUR196:
1A3B            585   Menu_Done_Display_Cursor_Change196:
1A3B            585   
1A3B            585   Menu_Skip_Select_Change79:
1A3B            585            
1A3B            585            ;calling the operation function, which does stuff every cycle.
1A3B 1200EC     585            lcall Menu_Null
1A3E 0213D9     585            ljmp Menu_Loop79
1A41            585   
1A41            585   Menu_Exit_Level79:
1A41 D0E0       585            pop acc
1A43 D007       585            pop  ar7
1A45 D006       585            pop  ar6
1A47 D005       585            pop  ar5
1A49 D004       585            pop  ar4
1A4B D003       585            pop  ar3
1A4D D002       585            pop  ar2
1A4F D001       585            pop  ar1
1A51 D000       585            pop  ar0
1A53 22         586            ret
1A54            587   Preset_1:
1A54 753001     588            mov Current_Preset, #0x01
1A57 7801       589            mov R0, #0x01
1A59 22         590            ret
1A5A            591   Preset_2:
1A5A 753002     592            mov Current_Preset, #0x02
1A5D 7801       593            mov R0, #0x01
1A5F 22         594            ret
1A60            595   Preset_3:
1A60 753003     596            mov Current_Preset, #0x03
1A63 7801       597            mov R0, #0x01
1A65 22         598            ret
1A66            599            
1A66            600   ;--------------------------------------------;
1A66            601   ;Settings and the settings functions
1A66            602   ;--------------------------------------------;
1A66            603   Settings:
1A66            604            ;when first entering this setting editor, the current preset's time and temp
1A66            605            ;is put into the editor
1A66 C0E0       606            push acc
1A68 E530       607            mov a, Current_Preset   ;determine the current preset
1A6A B40116     608            cjne a, #0x01, Loading_Preset_T_Not_1
1A6D C0E0       609            push acc
1A6F            609   
1A6F E533       609            mov a, Soak_Preset1_T_hex
1A71 F531       609            mov Soak_Settings_T_hex, a      
1A73 E53A       609            mov a, Reflow_Preset1_T_hex
1A75 F539       609            mov Reflow_Settings_T_hex, a    
1A77            609            
1A77 E536       609            mov a, Soak_Preset1_Temp_hex
1A79 F532       609            mov Soak_Settings_Temp_hex, a   
1A7B E53E       609            mov a, Reflow_Preset1_Temp_hex
1A7D F53D       609            mov Reflow_Settings_Temp_hex, a         
1A7F            609   
1A7F D0E0       609            pop acc
1A81 8032       610            sjmp Done_Loading_Preset_T
1A83            611   Loading_Preset_T_Not_1:
1A83 B40216     612            cjne a, #0x02, Loading_Preset_T_Not_2
1A86 C0E0       613            push acc
1A88            613   
1A88 E534       613            mov a, Soak_Preset2_T_hex
1A8A F531       613            mov Soak_Settings_T_hex, a      
1A8C E53B       613            mov a, Reflow_Preset2_T_hex
1A8E F539       613            mov Reflow_Settings_T_hex, a    
1A90            613            
1A90 E537       613            mov a, Soak_Preset2_Temp_hex
1A92 F532       613            mov Soak_Settings_Temp_hex, a   
1A94 E53F       613            mov a, Reflow_Preset2_Temp_hex
1A96 F53D       613            mov Reflow_Settings_Temp_hex, a         
1A98            613   
1A98 D0E0       613            pop acc
1A9A 8019       614            sjmp Done_Loading_Preset_T
1A9C            615   Loading_Preset_T_Not_2:
1A9C B40316     616            cjne a, #0x03, Loading_Preset_T_Not_3
1A9F C0E0       617            push acc
1AA1            617   
1AA1 E535       617            mov a, Soak_Preset3_T_hex
1AA3 F531       617            mov Soak_Settings_T_hex, a      
1AA5 E53C       617            mov a, Reflow_Preset3_T_hex
1AA7 F539       617            mov Reflow_Settings_T_hex, a    
1AA9            617            
1AA9 E538       617            mov a, Soak_Preset3_Temp_hex
1AAB F532       617            mov Soak_Settings_Temp_hex, a   
1AAD E540       617            mov a, Reflow_Preset3_Temp_hex
1AAF F53D       617            mov Reflow_Settings_Temp_hex, a         
1AB1            617   
1AB1 D0E0       617            pop acc
1AB3 8000       618            sjmp Done_Loading_Preset_T
1AB5            619   
1AB5            620   Loading_Preset_T_Not_3:
1AB5            621   Done_Loading_Preset_T:
1AB5 D0E0       622            pop acc
1AB7 C000       623            push ar0
1AB9 C001       623            push ar1
1ABB C002       623            push ar2
1ABD C003       623            push ar3
1ABF C004       623            push ar4
1AC1 C005       623            push ar5
1AC3 C006       623            push ar6
1AC5 C007       623            push ar7
1AC7 C0E0       623            push acc
1AC9 7800       623            mov R0, #0x00                   ;R0 is the exit flag, reset the exit flag
1ACB 7900       623            mov R1, #0x00                   ;R1 is the Cursor position register
1ACD 7A00       623            mov R2, #0x00                   ;R2 is the number of functions flag
1ACF            623            
1ACF            623            
1ACF            623            ;We put the information about the functions in R2,bits 0,1,2 correspond to funcs 2,3,4
1ACF 7400       623            mov a, #0x00                    ;clear a
1AD1            623            ;jnb 1, Menu_No_Func_2
1AD1 7401       623            mov a, #0x01
1AD3 B40101     623            cjne a, #0x01, Menu_No_Func_2237
1AD6 0A         623            inc R2
1AD7            623            ;orl a, #00000001B              ;put a 1 in bit 0 to indicate FUNC 2 activated
1AD7            623   Menu_No_Func_2237:
1AD7            623            ;jnb 1, Menu_No_Func_3
1AD7 7401       623            mov a, #0x01
1AD9 B40101     623            cjne a, #0x01, Menu_No_Func_3237
1ADC 0A         623            inc R2
1ADD            623            ;orl a, #00000010B              ;put a 1 in bit 1 to indicate FUNC 3 activated
1ADD            623   Menu_No_Func_3237:
1ADD            623            ;jnb 1, Menu_No_Func_4
1ADD 7401       623            mov a, #0x01
1ADF B40101     623            cjne a, #0x01, Menu_No_Func_4237
1AE2 0A         623            inc R2
1AE3            623            ;orl a, #00000100B              ;put a 1 in bit 2 to indicate FUNC 4 activated
1AE3            623   Menu_No_Func_4237:
1AE3            623                                    ;put the result into R2, this indicates the #of funcs
1AE3            623                    ;sets up the function flag register
1AE3            623            ;R2 is the function flag register
1AE3            623            
1AE3            623            ;display the screen after it has switched. This stays inside the 
1AE3            623            ;change cursor part so it only updates when pressed, not constantly.
1AE3 E9         623            mov a, R1
1AE4 B40079     623            cjne a, #0x00, Menu_Display_not_ONE238
1AE7 C0E0       623            push acc
1AE9 7401       623            mov a, #1
1AEB 14         623            dec a
1AEC 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1AEF D0E0       623            pop acc
1AF1 C083       623            push dph
1AF3 C082       623            push dpl
1AF5 C0E0       623            push acc
1AF7 900D1A     623            mov dptr, #CLEARLINE
1AFA 1200B4     623            lcall ?Send_Constant_String
1AFD D0E0       623            pop acc
1AFF D082       623            pop dpl
1B01 D083       623            pop dph
1B03 C0E0       623            push acc
1B05 7401       623            mov a, #1
1B07 14         623            dec a
1B08 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1B0B D0E0       623            pop acc
1B0D C083       623            push dph
1B0F C082       623            push dpl
1B11 C0E0       623            push acc
1B13 900DF7     623            mov dptr, #SettingsTop1
1B16 1200B4     623            lcall ?Send_Constant_String
1B19 D0E0       623            pop acc
1B1B D082       623            pop dpl
1B1D D083       623            pop dph                 ;display top half, cursor >
1B1F            623            ;check if its required to display bottom half
1B1F EA         623            mov a, R2
1B20 5402       623            anl a, #0x02
1B22 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom239
1B25 C0E0       623            push acc
1B27 7401       623            mov a, #1
1B29 14         623            dec a
1B2A 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1B2D D0E0       623            pop acc
1B2F C083       623            push dph
1B31 C082       623            push dpl
1B33 C0E0       623            push acc
1B35 900D1A     623            mov dptr, #CLEARLINE
1B38 1200B4     623            lcall ?Send_Constant_String
1B3B D0E0       623            pop acc
1B3D D082       623            pop dpl
1B3F D083       623            pop dph
1B41 C0E0       623            push acc
1B43 7401       623            mov a, #1
1B45 14         623            dec a
1B46 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1B49 D0E0       623            pop acc
1B4B C083       623            push dph
1B4D C082       623            push dpl
1B4F C0E0       623            push acc
1B51 900E4C     623            mov dptr, #SettingsBtm3
1B54 1200B4     623            lcall ?Send_Constant_String
1B57 D0E0       623            pop acc
1B59 D082       623            pop dpl
1B5B D083       623            pop dph                 ;display bottom half no cursor
1B5D            623   Skip_Displaying_Bottom239:                       
1B5D 021CD7     623            ljmp Menu_Done_Display_Cursor_Change238         
1B60            623                    
1B60            623   Menu_Display_not_ONE238:
1B60 E9         623                    mov a, R1
1B61 B40179     623                    cjne a, #0x01, Menu_Display_not_TWO238
1B64 C0E0       623            push acc
1B66 7401       623            mov a, #1
1B68 14         623            dec a
1B69 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1B6C D0E0       623            pop acc
1B6E C083       623            push dph
1B70 C082       623            push dpl
1B72 C0E0       623            push acc
1B74 900D1A     623            mov dptr, #CLEARLINE
1B77 1200B4     623            lcall ?Send_Constant_String
1B7A D0E0       623            pop acc
1B7C D082       623            pop dpl
1B7E D083       623            pop dph
1B80 C0E0       623            push acc
1B82 7401       623            mov a, #1
1B84 14         623            dec a
1B85 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1B88 D0E0       623            pop acc
1B8A C083       623            push dph
1B8C C082       623            push dpl
1B8E C0E0       623            push acc
1B90 900E08     623            mov dptr, #SettingsTop2
1B93 1200B4     623            lcall ?Send_Constant_String
1B96 D0E0       623            pop acc
1B98 D082       623            pop dpl
1B9A D083       623            pop dph                 ;display top half, cursor >
1B9C            623            ;check if its required to display bottom half
1B9C EA         623            mov a, R2
1B9D 5402       623            anl a, #0x02
1B9F B40238     623            cjne a, #0x02, Skip_Displaying_Bottom248
1BA2 C0E0       623            push acc
1BA4 7401       623            mov a, #1
1BA6 14         623            dec a
1BA7 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1BAA D0E0       623            pop acc
1BAC C083       623            push dph
1BAE C082       623            push dpl
1BB0 C0E0       623            push acc
1BB2 900D1A     623            mov dptr, #CLEARLINE
1BB5 1200B4     623            lcall ?Send_Constant_String
1BB8 D0E0       623            pop acc
1BBA D082       623            pop dpl
1BBC D083       623            pop dph
1BBE C0E0       623            push acc
1BC0 7401       623            mov a, #1
1BC2 14         623            dec a
1BC3 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1BC6 D0E0       623            pop acc
1BC8 C083       623            push dph
1BCA C082       623            push dpl
1BCC C0E0       623            push acc
1BCE 900E4C     623            mov dptr, #SettingsBtm3
1BD1 1200B4     623            lcall ?Send_Constant_String
1BD4 D0E0       623            pop acc
1BD6 D082       623            pop dpl
1BD8 D083       623            pop dph                 ;display bottom half no cursor
1BDA            623   Skip_Displaying_Bottom248:
1BDA 021CD7     623                    ljmp Menu_Done_Display_Cursor_Change238
1BDD            623                                    
1BDD            623   Menu_Display_not_TWO238:
1BDD E9         623                    mov a, R1
1BDE B40279     623                    cjne a, #0x02, Menu_Display_not_THREE238
1BE1 C0E0       623            push acc
1BE3 7401       623            mov a, #1
1BE5 14         623            dec a
1BE6 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1BE9 D0E0       623            pop acc
1BEB C083       623            push dph
1BED C082       623            push dpl
1BEF C0E0       623            push acc
1BF1 900D1A     623            mov dptr, #CLEARLINE
1BF4 1200B4     623            lcall ?Send_Constant_String
1BF7 D0E0       623            pop acc
1BF9 D082       623            pop dpl
1BFB D083       623            pop dph
1BFD C0E0       623            push acc
1BFF 7401       623            mov a, #1
1C01 14         623            dec a
1C02 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1C05 D0E0       623            pop acc
1C07 C083       623            push dph
1C09 C082       623            push dpl
1C0B C0E0       623            push acc
1C0D 900E19     623            mov dptr, #SettingsTop3
1C10 1200B4     623            lcall ?Send_Constant_String
1C13 D0E0       623            pop acc
1C15 D082       623            pop dpl
1C17 D083       623            pop dph                 ;display top half, cursor >
1C19            623            ;check if its required to display bottom half
1C19 EA         623            mov a, R2
1C1A 5402       623            anl a, #0x02
1C1C B40238     623            cjne a, #0x02, Skip_Displaying_Bottom257
1C1F C0E0       623            push acc
1C21 7401       623            mov a, #1
1C23 14         623            dec a
1C24 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1C27 D0E0       623            pop acc
1C29 C083       623            push dph
1C2B C082       623            push dpl
1C2D C0E0       623            push acc
1C2F 900D1A     623            mov dptr, #CLEARLINE
1C32 1200B4     623            lcall ?Send_Constant_String
1C35 D0E0       623            pop acc
1C37 D082       623            pop dpl
1C39 D083       623            pop dph
1C3B C0E0       623            push acc
1C3D 7401       623            mov a, #1
1C3F 14         623            dec a
1C40 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1C43 D0E0       623            pop acc
1C45 C083       623            push dph
1C47 C082       623            push dpl
1C49 C0E0       623            push acc
1C4B 900E2A     623            mov dptr, #SettingsBtm1
1C4E 1200B4     623            lcall ?Send_Constant_String
1C51 D0E0       623            pop acc
1C53 D082       623            pop dpl
1C55 D083       623            pop dph                 ;display bottom half no cursor
1C57            623   Skip_Displaying_Bottom257:
1C57 021CD7     623                    ljmp Menu_Done_Display_Cursor_Change238
1C5A            623                                    
1C5A            623   Menu_Display_not_THREE238:
1C5A E9         623                    mov a, R1
1C5B B40379     623                    cjne a, #0x03, Menu_Display_not_FOUR238
1C5E C0E0       623            push acc
1C60 7401       623            mov a, #1
1C62 14         623            dec a
1C63 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1C66 D0E0       623            pop acc
1C68 C083       623            push dph
1C6A C082       623            push dpl
1C6C C0E0       623            push acc
1C6E 900D1A     623            mov dptr, #CLEARLINE
1C71 1200B4     623            lcall ?Send_Constant_String
1C74 D0E0       623            pop acc
1C76 D082       623            pop dpl
1C78 D083       623            pop dph
1C7A C0E0       623            push acc
1C7C 7401       623            mov a, #1
1C7E 14         623            dec a
1C7F 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1C82 D0E0       623            pop acc
1C84 C083       623            push dph
1C86 C082       623            push dpl
1C88 C0E0       623            push acc
1C8A 900E19     623            mov dptr, #SettingsTop3
1C8D 1200B4     623            lcall ?Send_Constant_String
1C90 D0E0       623            pop acc
1C92 D082       623            pop dpl
1C94 D083       623            pop dph                 ;display top half, cursor >
1C96            623            ;check if its required to display bottom half
1C96 EA         623            mov a, R2
1C97 5402       623            anl a, #0x02
1C99 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom266
1C9C C0E0       623            push acc
1C9E 7401       623            mov a, #1
1CA0 14         623            dec a
1CA1 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1CA4 D0E0       623            pop acc
1CA6 C083       623            push dph
1CA8 C082       623            push dpl
1CAA C0E0       623            push acc
1CAC 900D1A     623            mov dptr, #CLEARLINE
1CAF 1200B4     623            lcall ?Send_Constant_String
1CB2 D0E0       623            pop acc
1CB4 D082       623            pop dpl
1CB6 D083       623            pop dph
1CB8 C0E0       623            push acc
1CBA 7401       623            mov a, #1
1CBC 14         623            dec a
1CBD 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1CC0 D0E0       623            pop acc
1CC2 C083       623            push dph
1CC4 C082       623            push dpl
1CC6 C0E0       623            push acc
1CC8 900E3B     623            mov dptr, #SettingsBtm2
1CCB 1200B4     623            lcall ?Send_Constant_String
1CCE D0E0       623            pop acc
1CD0 D082       623            pop dpl
1CD2 D083       623            pop dph                 ;display bottom half no cursor
1CD4            623   Skip_Displaying_Bottom266:       
1CD4 021CD7     623                    ljmp Menu_Done_Display_Cursor_Change238
1CD7            623                                    
1CD7            623   Menu_Display_not_FOUR238:
1CD7            623   Menu_Done_Display_Cursor_Change238:      ;display on LCD
1CD7            623   
1CD7            623   ;The loop that will happen over and over in each level of the menu
1CD7            623   Menu_Loop236:
1CD7            623   
1CD7            623            ;First, Check to see if the user wants to INC the cursors location
1CD7 20A614     623            jb B0, Menu_Skip_Cursor_INCtp236        ; if the 'B0' button is not pressed skip
1CDA C002       623            push AR2
1CDC 7A0A       623            mov R2, #10
1CDE 120039     623            lcall ?Wait_Milli_Seconds
1CE1 D002       623            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
1CE3 20A608     623            jb B0, Menu_Skip_Cursor_INCtp236        ; if the 'B0' button is not pressed skip
1CE6 30A6FD     623            jnb B0, $                               ; Wait for button release.
1CE9 30A5FD     623            jnb B2, $                               ; Wait for button release.
1CEC            623            ;The below code is used to get around the max jb jump distance
1CEC 8003       623            sjmp Menu_INC_Cursor236
1CEE            623   Menu_Skip_Cursor_INCtp236:
1CEE 021EE9     623            ljmp Menu_Skip_Cursor_INC236
1CF1            623   Menu_INC_Cursor236:      
1CF1 09         623            INC R1                                                  ;increment the cursors position
1CF2 1210D9     623            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
1CF5            623            ;display the screen after it has switched. This stays inside the 
1CF5            623            ;change cursor part so it only updates when pressed, not constantly.
1CF5 E9         623            mov a, R1
1CF6 B40079     623            cjne a, #0x00, Menu_Display_not_ONE276
1CF9 C0E0       623            push acc
1CFB 7401       623            mov a, #1
1CFD 14         623            dec a
1CFE 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1D01 D0E0       623            pop acc
1D03 C083       623            push dph
1D05 C082       623            push dpl
1D07 C0E0       623            push acc
1D09 900D1A     623            mov dptr, #CLEARLINE
1D0C 1200B4     623            lcall ?Send_Constant_String
1D0F D0E0       623            pop acc
1D11 D082       623            pop dpl
1D13 D083       623            pop dph
1D15 C0E0       623            push acc
1D17 7401       623            mov a, #1
1D19 14         623            dec a
1D1A 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1D1D D0E0       623            pop acc
1D1F C083       623            push dph
1D21 C082       623            push dpl
1D23 C0E0       623            push acc
1D25 900DF7     623            mov dptr, #SettingsTop1
1D28 1200B4     623            lcall ?Send_Constant_String
1D2B D0E0       623            pop acc
1D2D D082       623            pop dpl
1D2F D083       623            pop dph                 ;display top half, cursor >
1D31            623            ;check if its required to display bottom half
1D31 EA         623            mov a, R2
1D32 5402       623            anl a, #0x02
1D34 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom277
1D37 C0E0       623            push acc
1D39 7401       623            mov a, #1
1D3B 14         623            dec a
1D3C 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1D3F D0E0       623            pop acc
1D41 C083       623            push dph
1D43 C082       623            push dpl
1D45 C0E0       623            push acc
1D47 900D1A     623            mov dptr, #CLEARLINE
1D4A 1200B4     623            lcall ?Send_Constant_String
1D4D D0E0       623            pop acc
1D4F D082       623            pop dpl
1D51 D083       623            pop dph
1D53 C0E0       623            push acc
1D55 7401       623            mov a, #1
1D57 14         623            dec a
1D58 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1D5B D0E0       623            pop acc
1D5D C083       623            push dph
1D5F C082       623            push dpl
1D61 C0E0       623            push acc
1D63 900E4C     623            mov dptr, #SettingsBtm3
1D66 1200B4     623            lcall ?Send_Constant_String
1D69 D0E0       623            pop acc
1D6B D082       623            pop dpl
1D6D D083       623            pop dph                 ;display bottom half no cursor
1D6F            623   Skip_Displaying_Bottom277:                       
1D6F 021EE9     623            ljmp Menu_Done_Display_Cursor_Change276         
1D72            623                    
1D72            623   Menu_Display_not_ONE276:
1D72 E9         623                    mov a, R1
1D73 B40179     623                    cjne a, #0x01, Menu_Display_not_TWO276
1D76 C0E0       623            push acc
1D78 7401       623            mov a, #1
1D7A 14         623            dec a
1D7B 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1D7E D0E0       623            pop acc
1D80 C083       623            push dph
1D82 C082       623            push dpl
1D84 C0E0       623            push acc
1D86 900D1A     623            mov dptr, #CLEARLINE
1D89 1200B4     623            lcall ?Send_Constant_String
1D8C D0E0       623            pop acc
1D8E D082       623            pop dpl
1D90 D083       623            pop dph
1D92 C0E0       623            push acc
1D94 7401       623            mov a, #1
1D96 14         623            dec a
1D97 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1D9A D0E0       623            pop acc
1D9C C083       623            push dph
1D9E C082       623            push dpl
1DA0 C0E0       623            push acc
1DA2 900E08     623            mov dptr, #SettingsTop2
1DA5 1200B4     623            lcall ?Send_Constant_String
1DA8 D0E0       623            pop acc
1DAA D082       623            pop dpl
1DAC D083       623            pop dph                 ;display top half, cursor >
1DAE            623            ;check if its required to display bottom half
1DAE EA         623            mov a, R2
1DAF 5402       623            anl a, #0x02
1DB1 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom286
1DB4 C0E0       623            push acc
1DB6 7401       623            mov a, #1
1DB8 14         623            dec a
1DB9 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1DBC D0E0       623            pop acc
1DBE C083       623            push dph
1DC0 C082       623            push dpl
1DC2 C0E0       623            push acc
1DC4 900D1A     623            mov dptr, #CLEARLINE
1DC7 1200B4     623            lcall ?Send_Constant_String
1DCA D0E0       623            pop acc
1DCC D082       623            pop dpl
1DCE D083       623            pop dph
1DD0 C0E0       623            push acc
1DD2 7401       623            mov a, #1
1DD4 14         623            dec a
1DD5 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1DD8 D0E0       623            pop acc
1DDA C083       623            push dph
1DDC C082       623            push dpl
1DDE C0E0       623            push acc
1DE0 900E4C     623            mov dptr, #SettingsBtm3
1DE3 1200B4     623            lcall ?Send_Constant_String
1DE6 D0E0       623            pop acc
1DE8 D082       623            pop dpl
1DEA D083       623            pop dph                 ;display bottom half no cursor
1DEC            623   Skip_Displaying_Bottom286:
1DEC 021EE9     623                    ljmp Menu_Done_Display_Cursor_Change276
1DEF            623                                    
1DEF            623   Menu_Display_not_TWO276:
1DEF E9         623                    mov a, R1
1DF0 B40279     623                    cjne a, #0x02, Menu_Display_not_THREE276
1DF3 C0E0       623            push acc
1DF5 7401       623            mov a, #1
1DF7 14         623            dec a
1DF8 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1DFB D0E0       623            pop acc
1DFD C083       623            push dph
1DFF C082       623            push dpl
1E01 C0E0       623            push acc
1E03 900D1A     623            mov dptr, #CLEARLINE
1E06 1200B4     623            lcall ?Send_Constant_String
1E09 D0E0       623            pop acc
1E0B D082       623            pop dpl
1E0D D083       623            pop dph
1E0F C0E0       623            push acc
1E11 7401       623            mov a, #1
1E13 14         623            dec a
1E14 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1E17 D0E0       623            pop acc
1E19 C083       623            push dph
1E1B C082       623            push dpl
1E1D C0E0       623            push acc
1E1F 900E19     623            mov dptr, #SettingsTop3
1E22 1200B4     623            lcall ?Send_Constant_String
1E25 D0E0       623            pop acc
1E27 D082       623            pop dpl
1E29 D083       623            pop dph                 ;display top half, cursor >
1E2B            623            ;check if its required to display bottom half
1E2B EA         623            mov a, R2
1E2C 5402       623            anl a, #0x02
1E2E B40238     623            cjne a, #0x02, Skip_Displaying_Bottom295
1E31 C0E0       623            push acc
1E33 7401       623            mov a, #1
1E35 14         623            dec a
1E36 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1E39 D0E0       623            pop acc
1E3B C083       623            push dph
1E3D C082       623            push dpl
1E3F C0E0       623            push acc
1E41 900D1A     623            mov dptr, #CLEARLINE
1E44 1200B4     623            lcall ?Send_Constant_String
1E47 D0E0       623            pop acc
1E49 D082       623            pop dpl
1E4B D083       623            pop dph
1E4D C0E0       623            push acc
1E4F 7401       623            mov a, #1
1E51 14         623            dec a
1E52 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1E55 D0E0       623            pop acc
1E57 C083       623            push dph
1E59 C082       623            push dpl
1E5B C0E0       623            push acc
1E5D 900E2A     623            mov dptr, #SettingsBtm1
1E60 1200B4     623            lcall ?Send_Constant_String
1E63 D0E0       623            pop acc
1E65 D082       623            pop dpl
1E67 D083       623            pop dph                 ;display bottom half no cursor
1E69            623   Skip_Displaying_Bottom295:
1E69 021EE9     623                    ljmp Menu_Done_Display_Cursor_Change276
1E6C            623                                    
1E6C            623   Menu_Display_not_THREE276:
1E6C E9         623                    mov a, R1
1E6D B40379     623                    cjne a, #0x03, Menu_Display_not_FOUR276
1E70 C0E0       623            push acc
1E72 7401       623            mov a, #1
1E74 14         623            dec a
1E75 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1E78 D0E0       623            pop acc
1E7A C083       623            push dph
1E7C C082       623            push dpl
1E7E C0E0       623            push acc
1E80 900D1A     623            mov dptr, #CLEARLINE
1E83 1200B4     623            lcall ?Send_Constant_String
1E86 D0E0       623            pop acc
1E88 D082       623            pop dpl
1E8A D083       623            pop dph
1E8C C0E0       623            push acc
1E8E 7401       623            mov a, #1
1E90 14         623            dec a
1E91 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1E94 D0E0       623            pop acc
1E96 C083       623            push dph
1E98 C082       623            push dpl
1E9A C0E0       623            push acc
1E9C 900E19     623            mov dptr, #SettingsTop3
1E9F 1200B4     623            lcall ?Send_Constant_String
1EA2 D0E0       623            pop acc
1EA4 D082       623            pop dpl
1EA6 D083       623            pop dph                 ;display top half, cursor >
1EA8            623            ;check if its required to display bottom half
1EA8 EA         623            mov a, R2
1EA9 5402       623            anl a, #0x02
1EAB B40238     623            cjne a, #0x02, Skip_Displaying_Bottom304
1EAE C0E0       623            push acc
1EB0 7401       623            mov a, #1
1EB2 14         623            dec a
1EB3 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1EB6 D0E0       623            pop acc
1EB8 C083       623            push dph
1EBA C082       623            push dpl
1EBC C0E0       623            push acc
1EBE 900D1A     623            mov dptr, #CLEARLINE
1EC1 1200B4     623            lcall ?Send_Constant_String
1EC4 D0E0       623            pop acc
1EC6 D082       623            pop dpl
1EC8 D083       623            pop dph
1ECA C0E0       623            push acc
1ECC 7401       623            mov a, #1
1ECE 14         623            dec a
1ECF 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1ED2 D0E0       623            pop acc
1ED4 C083       623            push dph
1ED6 C082       623            push dpl
1ED8 C0E0       623            push acc
1EDA 900E3B     623            mov dptr, #SettingsBtm2
1EDD 1200B4     623            lcall ?Send_Constant_String
1EE0 D0E0       623            pop acc
1EE2 D082       623            pop dpl
1EE4 D083       623            pop dph                 ;display bottom half no cursor
1EE6            623   Skip_Displaying_Bottom304:       
1EE6 021EE9     623                    ljmp Menu_Done_Display_Cursor_Change276
1EE9            623                                    
1EE9            623   Menu_Display_not_FOUR276:
1EE9            623   Menu_Done_Display_Cursor_Change276:      ;display on LCD
1EE9            623            
1EE9            623   Menu_Skip_Cursor_INC236:
1EE9            623   
1EE9            623            ;Then, Check to see if the user wants to DEC the cursors location
1EE9 20A514     623            jb B2, Menu_Skip_Cursor_DECtp236        ; if the 'B0' button is not pressed skip
1EEC C002       623            push AR2
1EEE 7A0A       623            mov R2, #10
1EF0 120039     623            lcall ?Wait_Milli_Seconds
1EF3 D002       623            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
1EF5 20A508     623            jb B2, Menu_Skip_Cursor_DECtp236        ; if the 'B0' button is not pressed skip
1EF8 30A5FD     623            jnb B2, $                               ; Wait for button release.
1EFB 30A6FD     623            jnb B0, $                               ; Wait for button release.
1EFE            623            ;The below code is used to get around the max jb jump distance
1EFE 8003       623            sjmp Menu_DEC_Cursor236
1F00            623   Menu_Skip_Cursor_DECtp236:
1F00 0220FB     623            ljmp Menu_Skip_Cursor_DEC236
1F03            623   Menu_DEC_Cursor236:      
1F03 19         623            DEC R1                                                  ;increment the cursors position
1F04 1210D9     623            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
1F07            623            ;display the screen after it has switched. This stays inside the 
1F07            623            ;change cursor part so it only updates when pressed, not constantly.
1F07 E9         623            mov a, R1
1F08 B40079     623            cjne a, #0x00, Menu_Display_not_ONE314
1F0B C0E0       623            push acc
1F0D 7401       623            mov a, #1
1F0F 14         623            dec a
1F10 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1F13 D0E0       623            pop acc
1F15 C083       623            push dph
1F17 C082       623            push dpl
1F19 C0E0       623            push acc
1F1B 900D1A     623            mov dptr, #CLEARLINE
1F1E 1200B4     623            lcall ?Send_Constant_String
1F21 D0E0       623            pop acc
1F23 D082       623            pop dpl
1F25 D083       623            pop dph
1F27 C0E0       623            push acc
1F29 7401       623            mov a, #1
1F2B 14         623            dec a
1F2C 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1F2F D0E0       623            pop acc
1F31 C083       623            push dph
1F33 C082       623            push dpl
1F35 C0E0       623            push acc
1F37 900DF7     623            mov dptr, #SettingsTop1
1F3A 1200B4     623            lcall ?Send_Constant_String
1F3D D0E0       623            pop acc
1F3F D082       623            pop dpl
1F41 D083       623            pop dph                 ;display top half, cursor >
1F43            623            ;check if its required to display bottom half
1F43 EA         623            mov a, R2
1F44 5402       623            anl a, #0x02
1F46 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom315
1F49 C0E0       623            push acc
1F4B 7401       623            mov a, #1
1F4D 14         623            dec a
1F4E 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1F51 D0E0       623            pop acc
1F53 C083       623            push dph
1F55 C082       623            push dpl
1F57 C0E0       623            push acc
1F59 900D1A     623            mov dptr, #CLEARLINE
1F5C 1200B4     623            lcall ?Send_Constant_String
1F5F D0E0       623            pop acc
1F61 D082       623            pop dpl
1F63 D083       623            pop dph
1F65 C0E0       623            push acc
1F67 7401       623            mov a, #1
1F69 14         623            dec a
1F6A 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1F6D D0E0       623            pop acc
1F6F C083       623            push dph
1F71 C082       623            push dpl
1F73 C0E0       623            push acc
1F75 900E4C     623            mov dptr, #SettingsBtm3
1F78 1200B4     623            lcall ?Send_Constant_String
1F7B D0E0       623            pop acc
1F7D D082       623            pop dpl
1F7F D083       623            pop dph                 ;display bottom half no cursor
1F81            623   Skip_Displaying_Bottom315:                       
1F81 0220FB     623            ljmp Menu_Done_Display_Cursor_Change314         
1F84            623                    
1F84            623   Menu_Display_not_ONE314:
1F84 E9         623                    mov a, R1
1F85 B40179     623                    cjne a, #0x01, Menu_Display_not_TWO314
1F88 C0E0       623            push acc
1F8A 7401       623            mov a, #1
1F8C 14         623            dec a
1F8D 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1F90 D0E0       623            pop acc
1F92 C083       623            push dph
1F94 C082       623            push dpl
1F96 C0E0       623            push acc
1F98 900D1A     623            mov dptr, #CLEARLINE
1F9B 1200B4     623            lcall ?Send_Constant_String
1F9E D0E0       623            pop acc
1FA0 D082       623            pop dpl
1FA2 D083       623            pop dph
1FA4 C0E0       623            push acc
1FA6 7401       623            mov a, #1
1FA8 14         623            dec a
1FA9 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
1FAC D0E0       623            pop acc
1FAE C083       623            push dph
1FB0 C082       623            push dpl
1FB2 C0E0       623            push acc
1FB4 900E08     623            mov dptr, #SettingsTop2
1FB7 1200B4     623            lcall ?Send_Constant_String
1FBA D0E0       623            pop acc
1FBC D082       623            pop dpl
1FBE D083       623            pop dph                 ;display top half, cursor >
1FC0            623            ;check if its required to display bottom half
1FC0 EA         623            mov a, R2
1FC1 5402       623            anl a, #0x02
1FC3 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom324
1FC6 C0E0       623            push acc
1FC8 7401       623            mov a, #1
1FCA 14         623            dec a
1FCB 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1FCE D0E0       623            pop acc
1FD0 C083       623            push dph
1FD2 C082       623            push dpl
1FD4 C0E0       623            push acc
1FD6 900D1A     623            mov dptr, #CLEARLINE
1FD9 1200B4     623            lcall ?Send_Constant_String
1FDC D0E0       623            pop acc
1FDE D082       623            pop dpl
1FE0 D083       623            pop dph
1FE2 C0E0       623            push acc
1FE4 7401       623            mov a, #1
1FE6 14         623            dec a
1FE7 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
1FEA D0E0       623            pop acc
1FEC C083       623            push dph
1FEE C082       623            push dpl
1FF0 C0E0       623            push acc
1FF2 900E4C     623            mov dptr, #SettingsBtm3
1FF5 1200B4     623            lcall ?Send_Constant_String
1FF8 D0E0       623            pop acc
1FFA D082       623            pop dpl
1FFC D083       623            pop dph                 ;display bottom half no cursor
1FFE            623   Skip_Displaying_Bottom324:
1FFE 0220FB     623                    ljmp Menu_Done_Display_Cursor_Change314
2001            623                                    
2001            623   Menu_Display_not_TWO314:
2001 E9         623                    mov a, R1
2002 B40279     623                    cjne a, #0x02, Menu_Display_not_THREE314
2005 C0E0       623            push acc
2007 7401       623            mov a, #1
2009 14         623            dec a
200A 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
200D D0E0       623            pop acc
200F C083       623            push dph
2011 C082       623            push dpl
2013 C0E0       623            push acc
2015 900D1A     623            mov dptr, #CLEARLINE
2018 1200B4     623            lcall ?Send_Constant_String
201B D0E0       623            pop acc
201D D082       623            pop dpl
201F D083       623            pop dph
2021 C0E0       623            push acc
2023 7401       623            mov a, #1
2025 14         623            dec a
2026 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
2029 D0E0       623            pop acc
202B C083       623            push dph
202D C082       623            push dpl
202F C0E0       623            push acc
2031 900E19     623            mov dptr, #SettingsTop3
2034 1200B4     623            lcall ?Send_Constant_String
2037 D0E0       623            pop acc
2039 D082       623            pop dpl
203B D083       623            pop dph                 ;display top half, cursor >
203D            623            ;check if its required to display bottom half
203D EA         623            mov a, R2
203E 5402       623            anl a, #0x02
2040 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom333
2043 C0E0       623            push acc
2045 7401       623            mov a, #1
2047 14         623            dec a
2048 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
204B D0E0       623            pop acc
204D C083       623            push dph
204F C082       623            push dpl
2051 C0E0       623            push acc
2053 900D1A     623            mov dptr, #CLEARLINE
2056 1200B4     623            lcall ?Send_Constant_String
2059 D0E0       623            pop acc
205B D082       623            pop dpl
205D D083       623            pop dph
205F C0E0       623            push acc
2061 7401       623            mov a, #1
2063 14         623            dec a
2064 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
2067 D0E0       623            pop acc
2069 C083       623            push dph
206B C082       623            push dpl
206D C0E0       623            push acc
206F 900E2A     623            mov dptr, #SettingsBtm1
2072 1200B4     623            lcall ?Send_Constant_String
2075 D0E0       623            pop acc
2077 D082       623            pop dpl
2079 D083       623            pop dph                 ;display bottom half no cursor
207B            623   Skip_Displaying_Bottom333:
207B 0220FB     623                    ljmp Menu_Done_Display_Cursor_Change314
207E            623                                    
207E            623   Menu_Display_not_THREE314:
207E E9         623                    mov a, R1
207F B40379     623                    cjne a, #0x03, Menu_Display_not_FOUR314
2082 C0E0       623            push acc
2084 7401       623            mov a, #1
2086 14         623            dec a
2087 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
208A D0E0       623            pop acc
208C C083       623            push dph
208E C082       623            push dpl
2090 C0E0       623            push acc
2092 900D1A     623            mov dptr, #CLEARLINE
2095 1200B4     623            lcall ?Send_Constant_String
2098 D0E0       623            pop acc
209A D082       623            pop dpl
209C D083       623            pop dph
209E C0E0       623            push acc
20A0 7401       623            mov a, #1
20A2 14         623            dec a
20A3 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
20A6 D0E0       623            pop acc
20A8 C083       623            push dph
20AA C082       623            push dpl
20AC C0E0       623            push acc
20AE 900E19     623            mov dptr, #SettingsTop3
20B1 1200B4     623            lcall ?Send_Constant_String
20B4 D0E0       623            pop acc
20B6 D082       623            pop dpl
20B8 D083       623            pop dph                 ;display top half, cursor >
20BA            623            ;check if its required to display bottom half
20BA EA         623            mov a, R2
20BB 5402       623            anl a, #0x02
20BD B40238     623            cjne a, #0x02, Skip_Displaying_Bottom342
20C0 C0E0       623            push acc
20C2 7401       623            mov a, #1
20C4 14         623            dec a
20C5 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
20C8 D0E0       623            pop acc
20CA C083       623            push dph
20CC C082       623            push dpl
20CE C0E0       623            push acc
20D0 900D1A     623            mov dptr, #CLEARLINE
20D3 1200B4     623            lcall ?Send_Constant_String
20D6 D0E0       623            pop acc
20D8 D082       623            pop dpl
20DA D083       623            pop dph
20DC C0E0       623            push acc
20DE 7401       623            mov a, #1
20E0 14         623            dec a
20E1 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
20E4 D0E0       623            pop acc
20E6 C083       623            push dph
20E8 C082       623            push dpl
20EA C0E0       623            push acc
20EC 900E3B     623            mov dptr, #SettingsBtm2
20EF 1200B4     623            lcall ?Send_Constant_String
20F2 D0E0       623            pop acc
20F4 D082       623            pop dpl
20F6 D083       623            pop dph                 ;display bottom half no cursor
20F8            623   Skip_Displaying_Bottom342:       
20F8 0220FB     623                    ljmp Menu_Done_Display_Cursor_Change314
20FB            623                                    
20FB            623   Menu_Display_not_FOUR314:
20FB            623   Menu_Done_Display_Cursor_Change314:      ;display on LCD
20FB            623            
20FB            623   Menu_Skip_Cursor_DEC236:
20FB            623   
20FB            623            ;Check if the user wanted to exit the level of the menu
20FB E8         623            mov a, R0
20FC B40105     623            cjne a, #0x01, Menu_Stay236     ;if the flag is not 1, continue program, otherwise reset flag and return
20FF 7800       623            mov R0, #0x00
2101 02233F     623            ljmp Menu_Exit_Level236
2104            623            
2104            623   Menu_Stay236:    
2104            623            ;now the code that operates when the "select" button is pressed
2104 20A711     623            jb B1, Menu_Skip_Select_Changetp236     ; if the 'B1' button is not pressed skip
2107 C002       623            push AR2
2109 7A32       623            mov R2, #50
210B 120039     623            lcall ?Wait_Milli_Seconds
210E D002       623            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2110 20A705     623            jb B1, Menu_Skip_Select_Changetp236     ; if the 'B1' button is not pressed skip
2113 30A7FD     623            jnb B1, $                               ; Wait for button release
2116            623            ;The below code is used to get around the max jb jump distance 
2116 8003       623            sjmp Menu_Select_Change236
2118            623   Menu_Skip_Select_Changetp236:
2118 022339     623            ljmp Menu_Skip_Select_Change236         ;the button was not pressed.
211B            623            
211B            623   Menu_Select_Change236:
211B            623            
211B            623   ;We simply compare what number is in the cursor and enter that function
211B E9         623            mov a, R1
211C B40006     623            cjne a, #0x00, Menu_Not_Func_One_Select352
211F            623            ;if here, then the cursor is on the above position
211F 1200ED     623            lcall Menu_Back
2122 022143     623            ljmp Menu_Done_Func352
2125            623                            
2125            623   Menu_Not_Func_One_Select352:
2125 E9         623                    mov a, R1
2126 B40106     623            cjne a, #0x01, Menu_Not_Func_Two_Select352
2129            623            ;if here, then the cursor is on the above position
2129 1200EC     623            lcall Menu_Null
212C 022143     623            ljmp Menu_Done_Func352
212F            623                            
212F            623   Menu_Not_Func_Two_Select352:
212F E9         623            mov a, R1
2130 B40206     623            cjne a, #0x02, Menu_Not_Func_Three_Select352
2133            623            ;if here, then the cursor is on the above position
2133 122355     623            lcall Soak_Settings
2136 022143     623            ljmp Menu_Done_Func352
2139            623                            
2139            623   Menu_Not_Func_Three_Select352:
2139 E9         623            mov a, R1
213A B40306     623            cjne a, #0x03, Menu_Not_Func_Four_Select352
213D            623            ;if here, then the cursor is on the above position
213D 122533     623            lcall Reflow_Settings
2140 022143     623            ljmp Menu_Done_Func352
2143            623                            
2143            623   Menu_Not_Func_Four_Select352:
2143            623   
2143            623   Menu_Done_Func352:
2143            623   
2143            623            ;after selecting the function and exiting it, reset the cursor position and the screen
2143 7900       623            mov R1, #0x00
2145            623            ;display the screen after it has switched. This stays inside the 
2145            623            ;change cursor part so it only updates when pressed, not constantly.
2145 E9         623            mov a, R1
2146 B40079     623            cjne a, #0x00, Menu_Display_not_ONE353
2149 C0E0       623            push acc
214B 7401       623            mov a, #1
214D 14         623            dec a
214E 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
2151 D0E0       623            pop acc
2153 C083       623            push dph
2155 C082       623            push dpl
2157 C0E0       623            push acc
2159 900D1A     623            mov dptr, #CLEARLINE
215C 1200B4     623            lcall ?Send_Constant_String
215F D0E0       623            pop acc
2161 D082       623            pop dpl
2163 D083       623            pop dph
2165 C0E0       623            push acc
2167 7401       623            mov a, #1
2169 14         623            dec a
216A 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
216D D0E0       623            pop acc
216F C083       623            push dph
2171 C082       623            push dpl
2173 C0E0       623            push acc
2175 900DF7     623            mov dptr, #SettingsTop1
2178 1200B4     623            lcall ?Send_Constant_String
217B D0E0       623            pop acc
217D D082       623            pop dpl
217F D083       623            pop dph                 ;display top half, cursor >
2181            623            ;check if its required to display bottom half
2181 EA         623            mov a, R2
2182 5402       623            anl a, #0x02
2184 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom354
2187 C0E0       623            push acc
2189 7401       623            mov a, #1
218B 14         623            dec a
218C 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
218F D0E0       623            pop acc
2191 C083       623            push dph
2193 C082       623            push dpl
2195 C0E0       623            push acc
2197 900D1A     623            mov dptr, #CLEARLINE
219A 1200B4     623            lcall ?Send_Constant_String
219D D0E0       623            pop acc
219F D082       623            pop dpl
21A1 D083       623            pop dph
21A3 C0E0       623            push acc
21A5 7401       623            mov a, #1
21A7 14         623            dec a
21A8 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
21AB D0E0       623            pop acc
21AD C083       623            push dph
21AF C082       623            push dpl
21B1 C0E0       623            push acc
21B3 900E4C     623            mov dptr, #SettingsBtm3
21B6 1200B4     623            lcall ?Send_Constant_String
21B9 D0E0       623            pop acc
21BB D082       623            pop dpl
21BD D083       623            pop dph                 ;display bottom half no cursor
21BF            623   Skip_Displaying_Bottom354:                       
21BF 022339     623            ljmp Menu_Done_Display_Cursor_Change353         
21C2            623                    
21C2            623   Menu_Display_not_ONE353:
21C2 E9         623                    mov a, R1
21C3 B40179     623                    cjne a, #0x01, Menu_Display_not_TWO353
21C6 C0E0       623            push acc
21C8 7401       623            mov a, #1
21CA 14         623            dec a
21CB 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
21CE D0E0       623            pop acc
21D0 C083       623            push dph
21D2 C082       623            push dpl
21D4 C0E0       623            push acc
21D6 900D1A     623            mov dptr, #CLEARLINE
21D9 1200B4     623            lcall ?Send_Constant_String
21DC D0E0       623            pop acc
21DE D082       623            pop dpl
21E0 D083       623            pop dph
21E2 C0E0       623            push acc
21E4 7401       623            mov a, #1
21E6 14         623            dec a
21E7 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
21EA D0E0       623            pop acc
21EC C083       623            push dph
21EE C082       623            push dpl
21F0 C0E0       623            push acc
21F2 900E08     623            mov dptr, #SettingsTop2
21F5 1200B4     623            lcall ?Send_Constant_String
21F8 D0E0       623            pop acc
21FA D082       623            pop dpl
21FC D083       623            pop dph                 ;display top half, cursor >
21FE            623            ;check if its required to display bottom half
21FE EA         623            mov a, R2
21FF 5402       623            anl a, #0x02
2201 B40238     623            cjne a, #0x02, Skip_Displaying_Bottom363
2204 C0E0       623            push acc
2206 7401       623            mov a, #1
2208 14         623            dec a
2209 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
220C D0E0       623            pop acc
220E C083       623            push dph
2210 C082       623            push dpl
2212 C0E0       623            push acc
2214 900D1A     623            mov dptr, #CLEARLINE
2217 1200B4     623            lcall ?Send_Constant_String
221A D0E0       623            pop acc
221C D082       623            pop dpl
221E D083       623            pop dph
2220 C0E0       623            push acc
2222 7401       623            mov a, #1
2224 14         623            dec a
2225 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
2228 D0E0       623            pop acc
222A C083       623            push dph
222C C082       623            push dpl
222E C0E0       623            push acc
2230 900E4C     623            mov dptr, #SettingsBtm3
2233 1200B4     623            lcall ?Send_Constant_String
2236 D0E0       623            pop acc
2238 D082       623            pop dpl
223A D083       623            pop dph                 ;display bottom half no cursor
223C            623   Skip_Displaying_Bottom363:
223C 022339     623                    ljmp Menu_Done_Display_Cursor_Change353
223F            623                                    
223F            623   Menu_Display_not_TWO353:
223F E9         623                    mov a, R1
2240 B40279     623                    cjne a, #0x02, Menu_Display_not_THREE353
2243 C0E0       623            push acc
2245 7401       623            mov a, #1
2247 14         623            dec a
2248 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
224B D0E0       623            pop acc
224D C083       623            push dph
224F C082       623            push dpl
2251 C0E0       623            push acc
2253 900D1A     623            mov dptr, #CLEARLINE
2256 1200B4     623            lcall ?Send_Constant_String
2259 D0E0       623            pop acc
225B D082       623            pop dpl
225D D083       623            pop dph
225F C0E0       623            push acc
2261 7401       623            mov a, #1
2263 14         623            dec a
2264 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
2267 D0E0       623            pop acc
2269 C083       623            push dph
226B C082       623            push dpl
226D C0E0       623            push acc
226F 900E19     623            mov dptr, #SettingsTop3
2272 1200B4     623            lcall ?Send_Constant_String
2275 D0E0       623            pop acc
2277 D082       623            pop dpl
2279 D083       623            pop dph                 ;display top half, cursor >
227B            623            ;check if its required to display bottom half
227B EA         623            mov a, R2
227C 5402       623            anl a, #0x02
227E B40238     623            cjne a, #0x02, Skip_Displaying_Bottom372
2281 C0E0       623            push acc
2283 7401       623            mov a, #1
2285 14         623            dec a
2286 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
2289 D0E0       623            pop acc
228B C083       623            push dph
228D C082       623            push dpl
228F C0E0       623            push acc
2291 900D1A     623            mov dptr, #CLEARLINE
2294 1200B4     623            lcall ?Send_Constant_String
2297 D0E0       623            pop acc
2299 D082       623            pop dpl
229B D083       623            pop dph
229D C0E0       623            push acc
229F 7401       623            mov a, #1
22A1 14         623            dec a
22A2 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
22A5 D0E0       623            pop acc
22A7 C083       623            push dph
22A9 C082       623            push dpl
22AB C0E0       623            push acc
22AD 900E2A     623            mov dptr, #SettingsBtm1
22B0 1200B4     623            lcall ?Send_Constant_String
22B3 D0E0       623            pop acc
22B5 D082       623            pop dpl
22B7 D083       623            pop dph                 ;display bottom half no cursor
22B9            623   Skip_Displaying_Bottom372:
22B9 022339     623                    ljmp Menu_Done_Display_Cursor_Change353
22BC            623                                    
22BC            623   Menu_Display_not_THREE353:
22BC E9         623                    mov a, R1
22BD B40379     623                    cjne a, #0x03, Menu_Display_not_FOUR353
22C0 C0E0       623            push acc
22C2 7401       623            mov a, #1
22C4 14         623            dec a
22C5 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
22C8 D0E0       623            pop acc
22CA C083       623            push dph
22CC C082       623            push dpl
22CE C0E0       623            push acc
22D0 900D1A     623            mov dptr, #CLEARLINE
22D3 1200B4     623            lcall ?Send_Constant_String
22D6 D0E0       623            pop acc
22D8 D082       623            pop dpl
22DA D083       623            pop dph
22DC C0E0       623            push acc
22DE 7401       623            mov a, #1
22E0 14         623            dec a
22E1 1200C1     623            lcall ?Set_Cursor_1 ; Select column and row
22E4 D0E0       623            pop acc
22E6 C083       623            push dph
22E8 C082       623            push dpl
22EA C0E0       623            push acc
22EC 900E19     623            mov dptr, #SettingsTop3
22EF 1200B4     623            lcall ?Send_Constant_String
22F2 D0E0       623            pop acc
22F4 D082       623            pop dpl
22F6 D083       623            pop dph                 ;display top half, cursor >
22F8            623            ;check if its required to display bottom half
22F8 EA         623            mov a, R2
22F9 5402       623            anl a, #0x02
22FB B40238     623            cjne a, #0x02, Skip_Displaying_Bottom381
22FE C0E0       623            push acc
2300 7401       623            mov a, #1
2302 14         623            dec a
2303 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
2306 D0E0       623            pop acc
2308 C083       623            push dph
230A C082       623            push dpl
230C C0E0       623            push acc
230E 900D1A     623            mov dptr, #CLEARLINE
2311 1200B4     623            lcall ?Send_Constant_String
2314 D0E0       623            pop acc
2316 D082       623            pop dpl
2318 D083       623            pop dph
231A C0E0       623            push acc
231C 7401       623            mov a, #1
231E 14         623            dec a
231F 1200BF     623            lcall ?Set_Cursor_2 ; Select column and row
2322 D0E0       623            pop acc
2324 C083       623            push dph
2326 C082       623            push dpl
2328 C0E0       623            push acc
232A 900E3B     623            mov dptr, #SettingsBtm2
232D 1200B4     623            lcall ?Send_Constant_String
2330 D0E0       623            pop acc
2332 D082       623            pop dpl
2334 D083       623            pop dph                 ;display bottom half no cursor
2336            623   Skip_Displaying_Bottom381:       
2336 022339     623                    ljmp Menu_Done_Display_Cursor_Change353
2339            623                                    
2339            623   Menu_Display_not_FOUR353:
2339            623   Menu_Done_Display_Cursor_Change353:
2339            623   
2339            623   Menu_Skip_Select_Change236:
2339            623            
2339            623            ;calling the operation function, which does stuff every cycle.
2339 1200EC     623            lcall Menu_Null
233C 021CD7     623            ljmp Menu_Loop236
233F            623   
233F            623   Menu_Exit_Level236:
233F D0E0       623            pop acc
2341 D007       623            pop  ar7
2343 D006       623            pop  ar6
2345 D005       623            pop  ar5
2347 D004       623            pop  ar4
2349 D003       623            pop  ar3
234B D002       623            pop  ar2
234D D001       623            pop  ar1
234F D000       623            pop  ar0
2351            624            ;after exiting the settings, the program prompts you to save the new settings in one of the presets
2351 122711     625            lcall Save_Settings
2354 22         626            ret
2355            627   
2355            628   ;Soak_Settings
2355            629   Soak_Settings:
2355            630            ;display the current soaksettings and allow the user to change them.
2355 C000       631            push AR0                ;used as the current selection tool
2357 C0E0       632            push acc
2359 C0E0       633            push acc
235B 7401       633            mov a, #1
235D 14         633            dec a
235E 1200C1     633            lcall ?Set_Cursor_1 ; Select column and row
2361 D0E0       633            pop acc
2363 C083       633            push dph
2365 C082       633            push dpl
2367 C0E0       633            push acc
2369 900D1A     633            mov dptr, #CLEARLINE
236C 1200B4     633            lcall ?Send_Constant_String
236F D0E0       633            pop acc
2371 D082       633            pop dpl
2373 D083       633            pop dph
2375 C0E0       633            push acc
2377 7401       633            mov a, #1
2379 14         633            dec a
237A 1200BF     633            lcall ?Set_Cursor_2 ; Select column and row
237D D0E0       633            pop acc
237F C083       633            push dph
2381 C082       633            push dpl
2383 C0E0       633            push acc
2385 900D1A     633            mov dptr, #CLEARLINE
2388 1200B4     633            lcall ?Send_Constant_String
238B D0E0       633            pop acc
238D D082       633            pop dpl
238F D083       633            pop dph
2391 C0E0       633            push acc
2393 7401       633            mov a, #1
2395 14         633            dec a
2396 1200C1     633            lcall ?Set_Cursor_1 ; Select column and row
2399 D0E0       633            pop acc
239B C083       633            push dph
239D C082       633            push dpl
239F C0E0       633            push acc
23A1 900EA5     633            mov dptr, #SoakSettings1
23A4 1200B4     633            lcall ?Send_Constant_String
23A7 D0E0       633            pop acc
23A9 D082       633            pop dpl
23AB D083       633            pop dph
23AD C0E0       633            push acc
23AF 7401       633            mov a, #1
23B1 14         633            dec a
23B2 1200BF     633            lcall ?Set_Cursor_2 ; Select column and row
23B5 D0E0       633            pop acc
23B7 C083       633            push dph
23B9 C082       633            push dpl
23BB C0E0       633            push acc
23BD 900D1A     633            mov dptr, #CLEARLINE
23C0 1200B4     633            lcall ?Send_Constant_String
23C3 D0E0       633            pop acc
23C5 D082       633            pop dpl
23C7 D083       633            pop dph
23C9 7800       634            mov R0, #0x00
23CB C0E0       635            push acc
23CD 7405       635            mov a, #5
23CF 14         635            dec a
23D0 1200BF     635            lcall ?Set_Cursor_2 ; Select column and row
23D3 D0E0       635            pop acc
23D5 C083       636            push dph
23D7 C082       636            push dpl
23D9 C0E0       636            push acc
23DB 900EC7     636            mov dptr, #leftpoint
23DE 1200B4     636            lcall ?Send_Constant_String
23E1 D0E0       636            pop acc
23E3 D082       636            pop dpl
23E5 D083       636            pop dph
23E7            637   Soak_Settings_Loop:
23E7            638            ;check to see if user is going to exit the program
23E7 20A714     639            jb B1, NOT_Exit_Soak_Settings_Loop ; if the 'B0' button is not pressed skip
23EA C002       640            push AR2
23EC 7A32       640            mov R2, #50
23EE 120039     640            lcall ?Wait_Milli_Seconds
23F1 D002       640            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
23F3 20A708     641            jb B1, NOT_Exit_Soak_Settings_Loop ; if the 'B0' button is not pressed skip
23F6 30A7FD     642            jnb B1, $
23F9 D0E0       643            pop acc
23FB D000       644            pop AR0
23FD 22         645            ret     
23FE            646   NOT_Exit_Soak_Settings_Loop:
23FE            647   
23FE            648            ;first the cursor settings.
23FE 20A411     649            jb B3, Skip_INC_Cursor_Soak_Settingstp ; if the 'B0' button is not pressed skip
2401 C002       650            push AR2
2403 7A32       650            mov R2, #50
2405 120039     650            lcall ?Wait_Milli_Seconds
2408 D002       650            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
240A 20A405     651            jb B3, Skip_INC_Cursor_Soak_Settingstp ; if the 'B0' button is not pressed skip
240D 30A4FD     652            jnb B3, $
2410 8003       653            sjmp Soak_Jump
2412            654            
2412            655   Skip_INC_Cursor_Soak_Settingstp:
2412 022494     656            ljmp Skip_INC_Cursor_Soak_Settings
2415            657            
2415            658   Soak_Jump:
2415 08         659            Inc R0
2416 E8         660            mov a, R0
2417 B40204     661            cjne a, #0x02, Soak_Cursor_No_Reset
241A 7800       662            mov R0, #0x00
241C 7400       663            mov a, #0x00
241E            664   
241E            665   Soak_Cursor_No_Reset:
241E B4003B     666            cjne a, #0x00, Soak_Cursor_Not_0
2421 C0E0       667            push acc
2423 7405       667            mov a, #5
2425 14         667            dec a
2426 1200BF     667            lcall ?Set_Cursor_2 ; Select column and row
2429 D0E0       667            pop acc
242B C083       668            push dph
242D C082       668            push dpl
242F C0E0       668            push acc
2431 900EC7     668            mov dptr, #leftpoint
2434 1200B4     668            lcall ?Send_Constant_String
2437 D0E0       668            pop acc
2439 D082       668            pop dpl
243B D083       668            pop dph
243D C0E0       669            push acc
243F 740C       669            mov a, #12
2441 14         669            dec a
2442 1200BF     669            lcall ?Set_Cursor_2 ; Select column and row
2445 D0E0       669            pop acc
2447 C083       670            push dph
2449 C082       670            push dpl
244B C0E0       670            push acc
244D 900ECB     670            mov dptr, #CLEARCHAR
2450 1200B4     670            lcall ?Send_Constant_String
2453 D0E0       670            pop acc
2455 D082       670            pop dpl
2457 D083       670            pop dph
2459 022494     671            ljmp Skip_INC_Cursor_Soak_Settings
245C            672   Soak_Cursor_Not_0:
245C C0E0       673            push acc
245E 740C       673            mov a, #12
2460 14         673            dec a
2461 1200BF     673            lcall ?Set_Cursor_2 ; Select column and row
2464 D0E0       673            pop acc
2466 C083       674            push dph
2468 C082       674            push dpl
246A C0E0       674            push acc
246C 900EC9     674            mov dptr, #rightpoint
246F 1200B4     674            lcall ?Send_Constant_String
2472 D0E0       674            pop acc
2474 D082       674            pop dpl
2476 D083       674            pop dph
2478 C0E0       675            push acc
247A 7405       675            mov a, #5
247C 14         675            dec a
247D 1200BF     675            lcall ?Set_Cursor_2 ; Select column and row
2480 D0E0       675            pop acc
2482 C083       676            push dph
2484 C082       676            push dpl
2486 C0E0       676            push acc
2488 900ECB     676            mov dptr, #CLEARCHAR
248B 1200B4     676            lcall ?Send_Constant_String
248E D0E0       676            pop acc
2490 D082       676            pop dpl
2492 D083       676            pop dph
2494            677            
2494            678   Skip_INC_Cursor_Soak_Settings:
2494            679            ;check if the user increments one of the options
2494 20A620     680            jb B0, Skip_INC_Soak_Setting ; if the 'B0' button is not pressed skip
2497 C002       681            push AR2
2499 7A0A       681            mov R2, #10
249B 120039     681            lcall ?Wait_Milli_Seconds
249E D002       681            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
24A0 20A614     682            jb B0, Skip_INC_Soak_Setting ; if the 'B0' button is not pressed skip
24A3 30A6FD     683            jnb B0, $
24A6 30A5FD     684            jnb B2, $
24A9            685            
24A9 E8         686            mov a, R0
24AA B40005     687            cjne a, #0x00, Soak_Setting_INC_Not_Temp
24AD 0532       688            INC Soak_Settings_Temp_hex
24AF 0224B7     689            ljmp Skip_INC_Soak_Setting
24B2            690   Soak_Setting_INC_Not_Temp:
24B2 0531       691            INC Soak_Settings_T_hex
24B4 0224B7     692            ljmp Skip_INC_Soak_Setting
24B7            693   Skip_INC_Soak_Setting:
24B7            694   
24B7            695            ;check if the user decrements one of the options
24B7 20A520     696            jb B2, Skip_DEC_Soak_Setting ; if the 'B0' button is not pressed skip
24BA C002       697            push AR2
24BC 7A0A       697            mov R2, #10
24BE 120039     697            lcall ?Wait_Milli_Seconds
24C1 D002       697            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
24C3 20A514     698            jb B2, Skip_DEC_Soak_Setting ; if the 'B0' button is not pressed skip
24C6 30A5FD     699            jnb B2, $
24C9 30A6FD     700            jnb B0, $
24CC            701   
24CC E8         702            mov a, R0
24CD B40005     703            cjne a, #0x00, Soak_Setting_DEC_Not_Temp
24D0 1532       704            DEC Soak_Settings_Temp_hex
24D2 0224DA     705            ljmp Skip_DEC_Soak_Setting
24D5            706   Soak_Setting_DEC_Not_Temp:
24D5 1531       707            DEC Soak_Settings_T_hex
24D7 0224DA     708            ljmp Skip_DEC_Soak_Setting
24DA            709   Skip_DEC_Soak_Setting:
24DA            710            
24DA            711   ;now display the values onto the screen by converting them to BCD's
24DA 853247     712            mov x +0, Soak_Settings_Temp_hex
24DD 754800     712            mov x +1, #0x00
24E0 754900     712            mov x +2, #0x00
24E3 754A00     712            mov x +3, #0x00
24E6 120129     712            lcall hex2bcd
24E9 C0E0       712            push acc
24EB 7401       712            mov a, #1
24ED 14         712            dec a
24EE 1200BF     712            lcall ?Set_Cursor_2 ; Select column and row
24F1 D0E0       712            pop acc
24F3 C000       712            push ar0
24F5 A850       712            mov r0, bcd+1
24F7 1200C6     712            lcall ?Display_BCD
24FA D000       712            pop ar0
24FC C000       712            push ar0
24FE A84F       712            mov r0, bcd+0
2500 1200C6     712            lcall ?Display_BCD
2503 D000       712            pop ar0
2505 853147     713            mov x +0, Soak_Settings_T_hex
2508 754800     713            mov x +1, #0x00
250B 754900     713            mov x +2, #0x00
250E 754A00     713            mov x +3, #0x00
2511 120129     713            lcall hex2bcd
2514 C0E0       713            push acc
2516 740D       713            mov a, #13
2518 14         713            dec a
2519 1200BF     713            lcall ?Set_Cursor_2 ; Select column and row
251C D0E0       713            pop acc
251E C000       713            push ar0
2520 A850       713            mov r0, bcd+1
2522 1200C6     713            lcall ?Display_BCD
2525 D000       713            pop ar0
2527 C000       713            push ar0
2529 A84F       713            mov r0, bcd+0
252B 1200C6     713            lcall ?Display_BCD
252E D000       713            pop ar0
2530            714   
2530            715            ;finished displaying the correct values, continue.
2530 0223E7     716   ljmp Soak_Settings_Loop
2533            717   
2533            718   ;Reflow_Settings         
2533            719   Reflow_Settings:
2533            720                    ;display the current soaksettings and allow the user to change them.
2533 C000       721            push AR0                ;used as the current selection tool
2535 C0E0       722            push acc
2537 C0E0       723            push acc
2539 7401       723            mov a, #1
253B 14         723            dec a
253C 1200C1     723            lcall ?Set_Cursor_1 ; Select column and row
253F D0E0       723            pop acc
2541 C083       723            push dph
2543 C082       723            push dpl
2545 C0E0       723            push acc
2547 900D1A     723            mov dptr, #CLEARLINE
254A 1200B4     723            lcall ?Send_Constant_String
254D D0E0       723            pop acc
254F D082       723            pop dpl
2551 D083       723            pop dph
2553 C0E0       723            push acc
2555 7401       723            mov a, #1
2557 14         723            dec a
2558 1200BF     723            lcall ?Set_Cursor_2 ; Select column and row
255B D0E0       723            pop acc
255D C083       723            push dph
255F C082       723            push dpl
2561 C0E0       723            push acc
2563 900D1A     723            mov dptr, #CLEARLINE
2566 1200B4     723            lcall ?Send_Constant_String
2569 D0E0       723            pop acc
256B D082       723            pop dpl
256D D083       723            pop dph
256F C0E0       723            push acc
2571 7401       723            mov a, #1
2573 14         723            dec a
2574 1200C1     723            lcall ?Set_Cursor_1 ; Select column and row
2577 D0E0       723            pop acc
2579 C083       723            push dph
257B C082       723            push dpl
257D C0E0       723            push acc
257F 900EB6     723            mov dptr, #ReflowSettings1
2582 1200B4     723            lcall ?Send_Constant_String
2585 D0E0       723            pop acc
2587 D082       723            pop dpl
2589 D083       723            pop dph
258B C0E0       723            push acc
258D 7401       723            mov a, #1
258F 14         723            dec a
2590 1200BF     723            lcall ?Set_Cursor_2 ; Select column and row
2593 D0E0       723            pop acc
2595 C083       723            push dph
2597 C082       723            push dpl
2599 C0E0       723            push acc
259B 900D1A     723            mov dptr, #CLEARLINE
259E 1200B4     723            lcall ?Send_Constant_String
25A1 D0E0       723            pop acc
25A3 D082       723            pop dpl
25A5 D083       723            pop dph
25A7 7800       724            mov R0, #0x00
25A9 C0E0       725            push acc
25AB 7405       725            mov a, #5
25AD 14         725            dec a
25AE 1200BF     725            lcall ?Set_Cursor_2 ; Select column and row
25B1 D0E0       725            pop acc
25B3 C083       726            push dph
25B5 C082       726            push dpl
25B7 C0E0       726            push acc
25B9 900EC7     726            mov dptr, #leftpoint
25BC 1200B4     726            lcall ?Send_Constant_String
25BF D0E0       726            pop acc
25C1 D082       726            pop dpl
25C3 D083       726            pop dph
25C5            727   Reflow_Settings_Loop:
25C5            728            ;check to see if user is going to exit the program
25C5 20A714     729            jb B1, NOT_Exit_Reflow_Settings_Loop ; if the 'B0' button is not pressed skip
25C8 C002       730            push AR2
25CA 7A32       730            mov R2, #50
25CC 120039     730            lcall ?Wait_Milli_Seconds
25CF D002       730            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
25D1 20A708     731            jb B1, NOT_Exit_Reflow_Settings_Loop ; if the 'B0' button is not pressed skip
25D4 30A7FD     732            jnb B1, $
25D7 D0E0       733            pop acc
25D9 D000       734            pop AR0
25DB 22         735            ret     
25DC            736   NOT_Exit_Reflow_Settings_Loop:
25DC            737   
25DC            738            ;first the cursor settings.
25DC 20A411     739            jb B3, Skip_INC_Cursor_Reflow_Settingstp ; if the 'B0' button is not pressed skip
25DF C002       740            push AR2
25E1 7A32       740            mov R2, #50
25E3 120039     740            lcall ?Wait_Milli_Seconds
25E6 D002       740            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
25E8 20A405     741            jb B3, Skip_INC_Cursor_Reflow_Settingstp ; if the 'B0' button is not pressed skip
25EB 30A4FD     742            jnb B3, $
25EE 8003       743            sjmp Reflow_Jump
25F0            744            
25F0            745   Skip_INC_Cursor_Reflow_Settingstp:
25F0 022672     746            ljmp Skip_INC_Cursor_Reflow_Settings
25F3            747            
25F3            748   Reflow_Jump:
25F3 08         749            Inc R0
25F4 E8         750            mov a, R0
25F5 B40204     751            cjne a, #0x02, Reflow_Cursor_No_Reset
25F8 7800       752            mov R0, #0x00
25FA 7400       753            mov a, #0x00
25FC            754   
25FC            755   Reflow_Cursor_No_Reset:
25FC B4003B     756            cjne a, #0x00, Reflow_Cursor_Not_0
25FF C0E0       757            push acc
2601 7405       757            mov a, #5
2603 14         757            dec a
2604 1200BF     757            lcall ?Set_Cursor_2 ; Select column and row
2607 D0E0       757            pop acc
2609 C083       758            push dph
260B C082       758            push dpl
260D C0E0       758            push acc
260F 900EC7     758            mov dptr, #leftpoint
2612 1200B4     758            lcall ?Send_Constant_String
2615 D0E0       758            pop acc
2617 D082       758            pop dpl
2619 D083       758            pop dph
261B C0E0       759            push acc
261D 740C       759            mov a, #12
261F 14         759            dec a
2620 1200BF     759            lcall ?Set_Cursor_2 ; Select column and row
2623 D0E0       759            pop acc
2625 C083       760            push dph
2627 C082       760            push dpl
2629 C0E0       760            push acc
262B 900ECB     760            mov dptr, #CLEARCHAR
262E 1200B4     760            lcall ?Send_Constant_String
2631 D0E0       760            pop acc
2633 D082       760            pop dpl
2635 D083       760            pop dph
2637 022672     761            ljmp Skip_INC_Cursor_Reflow_Settings
263A            762   Reflow_Cursor_Not_0:
263A C0E0       763            push acc
263C 740C       763            mov a, #12
263E 14         763            dec a
263F 1200BF     763            lcall ?Set_Cursor_2 ; Select column and row
2642 D0E0       763            pop acc
2644 C083       764            push dph
2646 C082       764            push dpl
2648 C0E0       764            push acc
264A 900EC9     764            mov dptr, #rightpoint
264D 1200B4     764            lcall ?Send_Constant_String
2650 D0E0       764            pop acc
2652 D082       764            pop dpl
2654 D083       764            pop dph
2656 C0E0       765            push acc
2658 7405       765            mov a, #5
265A 14         765            dec a
265B 1200BF     765            lcall ?Set_Cursor_2 ; Select column and row
265E D0E0       765            pop acc
2660 C083       766            push dph
2662 C082       766            push dpl
2664 C0E0       766            push acc
2666 900ECB     766            mov dptr, #CLEARCHAR
2669 1200B4     766            lcall ?Send_Constant_String
266C D0E0       766            pop acc
266E D082       766            pop dpl
2670 D083       766            pop dph
2672            767            
2672            768   Skip_INC_Cursor_Reflow_Settings:
2672            769            ;check if the user increments one of the options
2672 20A620     770            jb B0, Skip_INC_Reflow_Setting ; if the 'B0' button is not pressed skip
2675 C002       771            push AR2
2677 7A0A       771            mov R2, #10
2679 120039     771            lcall ?Wait_Milli_Seconds
267C D002       771            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
267E 20A614     772            jb B0, Skip_INC_Reflow_Setting ; if the 'B0' button is not pressed skip
2681 30A6FD     773            jnb B0, $
2684 30A5FD     774            jnb B2, $
2687            775   
2687 E8         776            mov a, R0
2688 B40005     777            cjne a, #0x00, Reflow_Setting_INC_Not_Temp
268B 053D       778            INC Reflow_Settings_Temp_hex
268D 022695     779            ljmp Skip_INC_Reflow_Setting
2690            780   Reflow_Setting_INC_Not_Temp:
2690 0539       781            INC Reflow_Settings_T_hex
2692 022695     782            ljmp Skip_INC_Reflow_Setting
2695            783   Skip_INC_Reflow_Setting:
2695            784   
2695            785            ;check if the user decrements one of the options
2695 20A520     786            jb B2, Skip_DEC_Reflow_Setting ; if the 'B0' button is not pressed skip
2698 C002       787            push AR2
269A 7A0A       787            mov R2, #10
269C 120039     787            lcall ?Wait_Milli_Seconds
269F D002       787            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
26A1 20A514     788            jb B2, Skip_DEC_Reflow_Setting ; if the 'B0' button is not pressed skip
26A4 30A5FD     789            jnb B2, $
26A7 30A6FD     790            jnb B0, $
26AA            791   
26AA E8         792            mov a, R0
26AB B40005     793            cjne a, #0x00, Reflow_Setting_DEC_Not_Temp
26AE 153D       794            DEC Reflow_Settings_Temp_hex
26B0 0226B8     795            ljmp Skip_DEC_Reflow_Setting
26B3            796   Reflow_Setting_DEC_Not_Temp:
26B3 1539       797            DEC Reflow_Settings_T_hex
26B5 0226B8     798            ljmp Skip_DEC_Reflow_Setting
26B8            799   Skip_DEC_Reflow_Setting:
26B8            800            
26B8            801   ;now display the values onto the screen by converting them to BCD's
26B8 853D47     802            mov x +0, Reflow_Settings_Temp_hex
26BB 754800     802            mov x +1, #0x00
26BE 754900     802            mov x +2, #0x00
26C1 754A00     802            mov x +3, #0x00
26C4 120129     802            lcall hex2bcd
26C7 C0E0       802            push acc
26C9 7401       802            mov a, #1
26CB 14         802            dec a
26CC 1200BF     802            lcall ?Set_Cursor_2 ; Select column and row
26CF D0E0       802            pop acc
26D1 C000       802            push ar0
26D3 A850       802            mov r0, bcd+1
26D5 1200C6     802            lcall ?Display_BCD
26D8 D000       802            pop ar0
26DA C000       802            push ar0
26DC A84F       802            mov r0, bcd+0
26DE 1200C6     802            lcall ?Display_BCD
26E1 D000       802            pop ar0
26E3 853947     803            mov x +0, Reflow_Settings_T_hex
26E6 754800     803            mov x +1, #0x00
26E9 754900     803            mov x +2, #0x00
26EC 754A00     803            mov x +3, #0x00
26EF 120129     803            lcall hex2bcd
26F2 C0E0       803            push acc
26F4 740D       803            mov a, #13
26F6 14         803            dec a
26F7 1200BF     803            lcall ?Set_Cursor_2 ; Select column and row
26FA D0E0       803            pop acc
26FC C000       803            push ar0
26FE A850       803            mov r0, bcd+1
2700 1200C6     803            lcall ?Display_BCD
2703 D000       803            pop ar0
2705 C000       803            push ar0
2707 A84F       803            mov r0, bcd+0
2709 1200C6     803            lcall ?Display_BCD
270C D000       803            pop ar0
270E            804            
270E            805            ;finished displaying the correct values, continue.
270E 0225C5     806   ljmp Reflow_Settings_Loop
2711            807   
2711            808   Save_Settings:
2711            809            ;prompt the user to save the current settings into one of the presets
2711 C000       810            push AR0
2713 A830       811            mov R0, Current_Preset
2715 C000       812            Push AR0
2717 C0E0       813            push acc        
2719 C0E0       814            push acc
271B 7401       814            mov a, #1
271D 14         814            dec a
271E 1200C1     814            lcall ?Set_Cursor_1 ; Select column and row
2721 D0E0       814            pop acc
2723 C083       814            push dph
2725 C082       814            push dpl
2727 C0E0       814            push acc
2729 900D1A     814            mov dptr, #CLEARLINE
272C 1200B4     814            lcall ?Send_Constant_String
272F D0E0       814            pop acc
2731 D082       814            pop dpl
2733 D083       814            pop dph
2735 C0E0       814            push acc
2737 7401       814            mov a, #1
2739 14         814            dec a
273A 1200BF     814            lcall ?Set_Cursor_2 ; Select column and row
273D D0E0       814            pop acc
273F C083       814            push dph
2741 C082       814            push dpl
2743 C0E0       814            push acc
2745 900D1A     814            mov dptr, #CLEARLINE
2748 1200B4     814            lcall ?Send_Constant_String
274B D0E0       814            pop acc
274D D082       814            pop dpl
274F D083       814            pop dph
2751 C0E0       814            push acc
2753 7401       814            mov a, #1
2755 14         814            dec a
2756 1200C1     814            lcall ?Set_Cursor_1 ; Select column and row
2759 D0E0       814            pop acc
275B C083       814            push dph
275D C082       814            push dpl
275F C0E0       814            push acc
2761 900E6B     814            mov dptr, #SaveSettings
2764 1200B4     814            lcall ?Send_Constant_String
2767 D0E0       814            pop acc
2769 D082       814            pop dpl
276B D083       814            pop dph
276D C0E0       814            push acc
276F 7401       814            mov a, #1
2771 14         814            dec a
2772 1200BF     814            lcall ?Set_Cursor_2 ; Select column and row
2775 D0E0       814            pop acc
2777 C083       814            push dph
2779 C082       814            push dpl
277B C0E0       814            push acc
277D 900E7B     814            mov dptr, #SaveSettings1
2780 1200B4     814            lcall ?Send_Constant_String
2783 D0E0       814            pop acc
2785 D082       814            pop dpl
2787 D083       814            pop dph
2789            815   
2789            816   Save_Settings_Loop:
2789 20A768     817            jb B1, Save_Settings_Looptp ; if the 'B1' button is not pressed skip
278C C002       818            push AR2
278E 7A32       818            mov R2, #50
2790 120039     818            lcall ?Wait_Milli_Seconds
2793 D002       818            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2795 20A75C     819            jb B1, Save_Settings_Looptp ; if the 'B1' button is not pressed skip
2798            820            ;if the button is pressed, exit the loop after saving the correct information into the appropriate slots
2798 30A7FD     821            jnb B1, $
279B            822            
279B            823            ;now check what preset to save to, and save the proper information to the global variables
279B E530       824            mov a, Current_Preset
279D B40117     825            cjne a, #0x01, Save_Not_1
27A0 C0E0       826            push acc
27A2            826   
27A2 E531       826            mov a, Soak_Settings_T_hex
27A4 F533       826            mov Soak_Preset1_T_hex, a
27A6 E539       826            mov a, Reflow_Settings_T_hex
27A8 F53A       826            mov Reflow_Preset1_T_hex, a
27AA            826            
27AA E532       826            mov a, Soak_Settings_Temp_hex
27AC F536       826            mov Soak_Preset1_Temp_hex, a
27AE E53D       826            mov a, Reflow_Settings_Temp_hex
27B0 F53E       826            mov Reflow_Preset1_Temp_hex, a
27B2            826   
27B2 D0E0       826            pop acc
27B4 0227EB     827            ljmp Save_Not_3
27B7            828            
27B7            829   Save_Not_1:
27B7 B40217     830            cjne a, #0x02, Save_Not_2
27BA C0E0       831            push acc
27BC            831   
27BC E531       831            mov a, Soak_Settings_T_hex
27BE F534       831            mov Soak_Preset2_T_hex, a
27C0 E539       831            mov a, Reflow_Settings_T_hex
27C2 F53B       831            mov Reflow_Preset2_T_hex, a
27C4            831            
27C4 E532       831            mov a, Soak_Settings_Temp_hex
27C6 F537       831            mov Soak_Preset2_Temp_hex, a
27C8 E53D       831            mov a, Reflow_Settings_Temp_hex
27CA F53F       831            mov Reflow_Preset2_Temp_hex, a
27CC            831   
27CC D0E0       831            pop acc
27CE 0227D1     832            ljmp Save_Not_2
27D1            833   Save_Not_2:
27D1 B40317     834            cjne a, #0x03, Save_Not_3
27D4 C0E0       835            push acc
27D6            835   
27D6 E531       835            mov a, Soak_Settings_T_hex
27D8 F535       835            mov Soak_Preset3_T_hex, a
27DA E539       835            mov a, Reflow_Settings_T_hex
27DC F53C       835            mov Reflow_Preset3_T_hex, a
27DE            835            
27DE E532       835            mov a, Soak_Settings_Temp_hex
27E0 F538       835            mov Soak_Preset3_Temp_hex, a
27E2 E53D       835            mov a, Reflow_Settings_Temp_hex
27E4 F540       835            mov Reflow_Preset3_Temp_hex, a
27E6            835   
27E6 D0E0       835            pop acc
27E8 0227EB     836            ljmp Save_Not_3
27EB            837   Save_Not_3:
27EB            838            ;exit the save and return to the main menu
27EB D0E0       839            pop acc
27ED D000       840            pop AR0
27EF 8830       841            mov Current_Preset, R0
27F1 D000       842            Pop AR0
27F3 22         843            ret                     
27F4            844            
27F4            845   Save_Settings_Looptp:
27F4 E530       846            mov a, Current_Preset
27F6 B40116     847            cjne a, #0x01, Save_Draw_Not_1
27F9 C0E0       848            push acc
27FB 740D       848            mov a, #13
27FD 14         848            dec a
27FE 1200BF     848            lcall ?Set_Cursor_2 ; Select column and row
2801 D0E0       848            pop acc
2803 C0E0       849            push acc
2805 7431       849            mov a, #'1'
2807 12007E     849            lcall ?WriteData
280A D0E0       849            pop acc
280C 022841     850            ljmp Save_Draw_Not_3
280F            851   Save_Draw_Not_1:
280F B40216     852            cjne a, #0x02, Save_Draw_Not_2
2812 C0E0       853            push acc
2814 740D       853            mov a, #13
2816 14         853            dec a
2817 1200BF     853            lcall ?Set_Cursor_2 ; Select column and row
281A D0E0       853            pop acc
281C C0E0       854            push acc
281E 7432       854            mov a, #'2'
2820 12007E     854            lcall ?WriteData
2823 D0E0       854            pop acc
2825 022841     855            ljmp Save_Draw_Not_3
2828            856   Save_Draw_Not_2:
2828 B40316     857            cjne a, #0x03, Save_Draw_Not_3
282B C0E0       858            push acc
282D 740D       858            mov a, #13
282F 14         858            dec a
2830 1200BF     858            lcall ?Set_Cursor_2 ; Select column and row
2833 D0E0       858            pop acc
2835 C0E0       859            push acc
2837 7433       859            mov a, #'3'
2839 12007E     859            lcall ?WriteData
283C D0E0       859            pop acc
283E 022841     860            ljmp Save_Draw_Not_3
2841            861   Save_Draw_Not_3:
2841            862   
2841            863            ;now check for incrementing the position
2841 20A618     864            jb B0, Skip_INC_Settings_Preset ; if the 'B1' button is not pressed skip
2844 C002       865            push AR2
2846 7A32       865            mov R2, #50
2848 120039     865            lcall ?Wait_Milli_Seconds
284B D002       865            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
284D 20A60C     866            jb B0, Skip_INC_Settings_Preset ; if the 'B1' button is not pressed skip
2850 30A6FD     867            jnb B0, $
2853            868            ;increment the settings preset,
2853 04         869            INC a
2854 F530       870            mov Current_Preset, a
2856 B40403     871            cjne a, #0x04, No_Reset_Preset_NUM              ;check if max
2859 753001     872            mov     Current_Preset, #0x01
285C            873   No_Reset_Preset_NUM:
285C            874            
285C            875   Skip_INC_Settings_Preset:
285C 022789     876            ljmp Save_Settings_Loop
285F            877            
285F            878   ;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;
285F            879   ;this Code needs to be added as the main page of the system
285F            880   ;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;
285F            881   mainprogram:
285F            882            ;setting up the program
285F 75817F     883            mov SP, #0x7F
2862 120088     884       lcall LCD_4BIT
2865 120F6B     885       lcall Setup_System
2868 120CA9     886       lcall Display_System_Credits
286B            887       ;the home page of the system
286B C000       888            push ar0
286D C001       888            push ar1
286F C002       888            push ar2
2871 C003       888            push ar3
2873 C004       888            push ar4
2875 C005       888            push ar5
2877 C006       888            push ar6
2879 C007       888            push ar7
287B C0E0       888            push acc
287D 7800       888            mov R0, #0x00                   ;R0 is the exit flag, reset the exit flag
287F 7900       888            mov R1, #0x00                   ;R1 is the Cursor position register
2881 7A00       888            mov R2, #0x00                   ;R2 is the number of functions flag
2883            888            
2883            888            
2883            888            ;We put the information about the functions in R2,bits 0,1,2 correspond to funcs 2,3,4
2883 7400       888            mov a, #0x00                    ;clear a
2885            888            ;jnb 1, Menu_No_Func_2
2885 7401       888            mov a, #0x01
2887 B40101     888            cjne a, #0x01, Menu_No_Func_2473
288A 0A         888            inc R2
288B            888            ;orl a, #00000001B              ;put a 1 in bit 0 to indicate FUNC 2 activated
288B            888   Menu_No_Func_2473:
288B            888            ;jnb 1, Menu_No_Func_3
288B 7401       888            mov a, #0x01
288D B40101     888            cjne a, #0x01, Menu_No_Func_3473
2890 0A         888            inc R2
2891            888            ;orl a, #00000010B              ;put a 1 in bit 1 to indicate FUNC 3 activated
2891            888   Menu_No_Func_3473:
2891            888            ;jnb 1, Menu_No_Func_4
2891 7401       888            mov a, #0x01
2893 B40101     888            cjne a, #0x01, Menu_No_Func_4473
2896 0A         888            inc R2
2897            888            ;orl a, #00000100B              ;put a 1 in bit 2 to indicate FUNC 4 activated
2897            888   Menu_No_Func_4473:
2897            888                                    ;put the result into R2, this indicates the #of funcs   ;sets up the function flag register
2897            888            ;R2 is the function flag register
2897            888            
2897            888            ;display the screen after it has switched. This stays inside the 
2897            888            ;change cursor part so it only updates when pressed, not constantly.
2897 E9         888            mov a, R1
2898 B40079     888            cjne a, #0x00, Menu_Display_not_ONE474
289B C0E0       888            push acc
289D 7401       888            mov a, #1
289F 14         888            dec a
28A0 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
28A3 D0E0       888            pop acc
28A5 C083       888            push dph
28A7 C082       888            push dpl
28A9 C0E0       888            push acc
28AB 900D1A     888            mov dptr, #CLEARLINE
28AE 1200B4     888            lcall ?Send_Constant_String
28B1 D0E0       888            pop acc
28B3 D082       888            pop dpl
28B5 D083       888            pop dph
28B7 C0E0       888            push acc
28B9 7401       888            mov a, #1
28BB 14         888            dec a
28BC 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
28BF D0E0       888            pop acc
28C1 C083       888            push dph
28C3 C082       888            push dpl
28C5 C0E0       888            push acc
28C7 900D2B     888            mov dptr, #HomeTop1
28CA 1200B4     888            lcall ?Send_Constant_String
28CD D0E0       888            pop acc
28CF D082       888            pop dpl
28D1 D083       888            pop dph                 ;display top half, cursor >
28D3            888            ;check if its required to display bottom half
28D3 EA         888            mov a, R2
28D4 5402       888            anl a, #0x02
28D6 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom475
28D9 C0E0       888            push acc
28DB 7401       888            mov a, #1
28DD 14         888            dec a
28DE 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
28E1 D0E0       888            pop acc
28E3 C083       888            push dph
28E5 C082       888            push dpl
28E7 C0E0       888            push acc
28E9 900D1A     888            mov dptr, #CLEARLINE
28EC 1200B4     888            lcall ?Send_Constant_String
28EF D0E0       888            pop acc
28F1 D082       888            pop dpl
28F3 D083       888            pop dph
28F5 C0E0       888            push acc
28F7 7401       888            mov a, #1
28F9 14         888            dec a
28FA 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
28FD D0E0       888            pop acc
28FF C083       888            push dph
2901 C082       888            push dpl
2903 C0E0       888            push acc
2905 900D80     888            mov dptr, #HomeBtm3
2908 1200B4     888            lcall ?Send_Constant_String
290B D0E0       888            pop acc
290D D082       888            pop dpl
290F D083       888            pop dph                 ;display bottom half no cursor
2911            888   Skip_Displaying_Bottom475:                       
2911 022A8B     888            ljmp Menu_Done_Display_Cursor_Change474         
2914            888                    
2914            888   Menu_Display_not_ONE474:
2914 E9         888                    mov a, R1
2915 B40179     888                    cjne a, #0x01, Menu_Display_not_TWO474
2918 C0E0       888            push acc
291A 7401       888            mov a, #1
291C 14         888            dec a
291D 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2920 D0E0       888            pop acc
2922 C083       888            push dph
2924 C082       888            push dpl
2926 C0E0       888            push acc
2928 900D1A     888            mov dptr, #CLEARLINE
292B 1200B4     888            lcall ?Send_Constant_String
292E D0E0       888            pop acc
2930 D082       888            pop dpl
2932 D083       888            pop dph
2934 C0E0       888            push acc
2936 7401       888            mov a, #1
2938 14         888            dec a
2939 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
293C D0E0       888            pop acc
293E C083       888            push dph
2940 C082       888            push dpl
2942 C0E0       888            push acc
2944 900D3C     888            mov dptr, #HomeTop2
2947 1200B4     888            lcall ?Send_Constant_String
294A D0E0       888            pop acc
294C D082       888            pop dpl
294E D083       888            pop dph                 ;display top half, cursor >
2950            888            ;check if its required to display bottom half
2950 EA         888            mov a, R2
2951 5402       888            anl a, #0x02
2953 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom484
2956 C0E0       888            push acc
2958 7401       888            mov a, #1
295A 14         888            dec a
295B 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
295E D0E0       888            pop acc
2960 C083       888            push dph
2962 C082       888            push dpl
2964 C0E0       888            push acc
2966 900D1A     888            mov dptr, #CLEARLINE
2969 1200B4     888            lcall ?Send_Constant_String
296C D0E0       888            pop acc
296E D082       888            pop dpl
2970 D083       888            pop dph
2972 C0E0       888            push acc
2974 7401       888            mov a, #1
2976 14         888            dec a
2977 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
297A D0E0       888            pop acc
297C C083       888            push dph
297E C082       888            push dpl
2980 C0E0       888            push acc
2982 900D80     888            mov dptr, #HomeBtm3
2985 1200B4     888            lcall ?Send_Constant_String
2988 D0E0       888            pop acc
298A D082       888            pop dpl
298C D083       888            pop dph                 ;display bottom half no cursor
298E            888   Skip_Displaying_Bottom484:
298E 022A8B     888                    ljmp Menu_Done_Display_Cursor_Change474
2991            888                                    
2991            888   Menu_Display_not_TWO474:
2991 E9         888                    mov a, R1
2992 B40279     888                    cjne a, #0x02, Menu_Display_not_THREE474
2995 C0E0       888            push acc
2997 7401       888            mov a, #1
2999 14         888            dec a
299A 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
299D D0E0       888            pop acc
299F C083       888            push dph
29A1 C082       888            push dpl
29A3 C0E0       888            push acc
29A5 900D1A     888            mov dptr, #CLEARLINE
29A8 1200B4     888            lcall ?Send_Constant_String
29AB D0E0       888            pop acc
29AD D082       888            pop dpl
29AF D083       888            pop dph
29B1 C0E0       888            push acc
29B3 7401       888            mov a, #1
29B5 14         888            dec a
29B6 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
29B9 D0E0       888            pop acc
29BB C083       888            push dph
29BD C082       888            push dpl
29BF C0E0       888            push acc
29C1 900D4D     888            mov dptr, #HomeTop3
29C4 1200B4     888            lcall ?Send_Constant_String
29C7 D0E0       888            pop acc
29C9 D082       888            pop dpl
29CB D083       888            pop dph                 ;display top half, cursor >
29CD            888            ;check if its required to display bottom half
29CD EA         888            mov a, R2
29CE 5402       888            anl a, #0x02
29D0 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom493
29D3 C0E0       888            push acc
29D5 7401       888            mov a, #1
29D7 14         888            dec a
29D8 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
29DB D0E0       888            pop acc
29DD C083       888            push dph
29DF C082       888            push dpl
29E1 C0E0       888            push acc
29E3 900D1A     888            mov dptr, #CLEARLINE
29E6 1200B4     888            lcall ?Send_Constant_String
29E9 D0E0       888            pop acc
29EB D082       888            pop dpl
29ED D083       888            pop dph
29EF C0E0       888            push acc
29F1 7401       888            mov a, #1
29F3 14         888            dec a
29F4 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
29F7 D0E0       888            pop acc
29F9 C083       888            push dph
29FB C082       888            push dpl
29FD C0E0       888            push acc
29FF 900D5E     888            mov dptr, #HomeBtm1
2A02 1200B4     888            lcall ?Send_Constant_String
2A05 D0E0       888            pop acc
2A07 D082       888            pop dpl
2A09 D083       888            pop dph                 ;display bottom half no cursor
2A0B            888   Skip_Displaying_Bottom493:
2A0B 022A8B     888                    ljmp Menu_Done_Display_Cursor_Change474
2A0E            888                                    
2A0E            888   Menu_Display_not_THREE474:
2A0E E9         888                    mov a, R1
2A0F B40379     888                    cjne a, #0x03, Menu_Display_not_FOUR474
2A12 C0E0       888            push acc
2A14 7401       888            mov a, #1
2A16 14         888            dec a
2A17 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2A1A D0E0       888            pop acc
2A1C C083       888            push dph
2A1E C082       888            push dpl
2A20 C0E0       888            push acc
2A22 900D1A     888            mov dptr, #CLEARLINE
2A25 1200B4     888            lcall ?Send_Constant_String
2A28 D0E0       888            pop acc
2A2A D082       888            pop dpl
2A2C D083       888            pop dph
2A2E C0E0       888            push acc
2A30 7401       888            mov a, #1
2A32 14         888            dec a
2A33 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2A36 D0E0       888            pop acc
2A38 C083       888            push dph
2A3A C082       888            push dpl
2A3C C0E0       888            push acc
2A3E 900D4D     888            mov dptr, #HomeTop3
2A41 1200B4     888            lcall ?Send_Constant_String
2A44 D0E0       888            pop acc
2A46 D082       888            pop dpl
2A48 D083       888            pop dph                 ;display top half, cursor >
2A4A            888            ;check if its required to display bottom half
2A4A EA         888            mov a, R2
2A4B 5402       888            anl a, #0x02
2A4D B40238     888            cjne a, #0x02, Skip_Displaying_Bottom502
2A50 C0E0       888            push acc
2A52 7401       888            mov a, #1
2A54 14         888            dec a
2A55 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2A58 D0E0       888            pop acc
2A5A C083       888            push dph
2A5C C082       888            push dpl
2A5E C0E0       888            push acc
2A60 900D1A     888            mov dptr, #CLEARLINE
2A63 1200B4     888            lcall ?Send_Constant_String
2A66 D0E0       888            pop acc
2A68 D082       888            pop dpl
2A6A D083       888            pop dph
2A6C C0E0       888            push acc
2A6E 7401       888            mov a, #1
2A70 14         888            dec a
2A71 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2A74 D0E0       888            pop acc
2A76 C083       888            push dph
2A78 C082       888            push dpl
2A7A C0E0       888            push acc
2A7C 900D6F     888            mov dptr, #HomeBtm2
2A7F 1200B4     888            lcall ?Send_Constant_String
2A82 D0E0       888            pop acc
2A84 D082       888            pop dpl
2A86 D083       888            pop dph                 ;display bottom half no cursor
2A88            888   Skip_Displaying_Bottom502:       
2A88 022A8B     888                    ljmp Menu_Done_Display_Cursor_Change474
2A8B            888                                    
2A8B            888   Menu_Display_not_FOUR474:
2A8B            888   Menu_Done_Display_Cursor_Change474:      ;display on LCD
2A8B            888   
2A8B            888   ;The loop that will happen over and over in each level of the menu
2A8B            888   Menu_Loop472:
2A8B            888   
2A8B            888            ;First, Check to see if the user wants to INC the cursors location
2A8B 20A614     888            jb B0, Menu_Skip_Cursor_INCtp472        ; if the 'B0' button is not pressed skip
2A8E C002       888            push AR2
2A90 7A0A       888            mov R2, #10
2A92 120039     888            lcall ?Wait_Milli_Seconds
2A95 D002       888            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2A97 20A608     888            jb B0, Menu_Skip_Cursor_INCtp472        ; if the 'B0' button is not pressed skip
2A9A 30A6FD     888            jnb B0, $                               ; Wait for button release.
2A9D 30A5FD     888            jnb B2, $                               ; Wait for button release.
2AA0            888            ;The below code is used to get around the max jb jump distance
2AA0 8003       888            sjmp Menu_INC_Cursor472
2AA2            888   Menu_Skip_Cursor_INCtp472:
2AA2 022C9D     888            ljmp Menu_Skip_Cursor_INC472
2AA5            888   Menu_INC_Cursor472:      
2AA5 09         888            INC R1                                                  ;increment the cursors position
2AA6 1210D9     888            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
2AA9            888            ;display the screen after it has switched. This stays inside the 
2AA9            888            ;change cursor part so it only updates when pressed, not constantly.
2AA9 E9         888            mov a, R1
2AAA B40079     888            cjne a, #0x00, Menu_Display_not_ONE512
2AAD C0E0       888            push acc
2AAF 7401       888            mov a, #1
2AB1 14         888            dec a
2AB2 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2AB5 D0E0       888            pop acc
2AB7 C083       888            push dph
2AB9 C082       888            push dpl
2ABB C0E0       888            push acc
2ABD 900D1A     888            mov dptr, #CLEARLINE
2AC0 1200B4     888            lcall ?Send_Constant_String
2AC3 D0E0       888            pop acc
2AC5 D082       888            pop dpl
2AC7 D083       888            pop dph
2AC9 C0E0       888            push acc
2ACB 7401       888            mov a, #1
2ACD 14         888            dec a
2ACE 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2AD1 D0E0       888            pop acc
2AD3 C083       888            push dph
2AD5 C082       888            push dpl
2AD7 C0E0       888            push acc
2AD9 900D2B     888            mov dptr, #HomeTop1
2ADC 1200B4     888            lcall ?Send_Constant_String
2ADF D0E0       888            pop acc
2AE1 D082       888            pop dpl
2AE3 D083       888            pop dph                 ;display top half, cursor >
2AE5            888            ;check if its required to display bottom half
2AE5 EA         888            mov a, R2
2AE6 5402       888            anl a, #0x02
2AE8 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom513
2AEB C0E0       888            push acc
2AED 7401       888            mov a, #1
2AEF 14         888            dec a
2AF0 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2AF3 D0E0       888            pop acc
2AF5 C083       888            push dph
2AF7 C082       888            push dpl
2AF9 C0E0       888            push acc
2AFB 900D1A     888            mov dptr, #CLEARLINE
2AFE 1200B4     888            lcall ?Send_Constant_String
2B01 D0E0       888            pop acc
2B03 D082       888            pop dpl
2B05 D083       888            pop dph
2B07 C0E0       888            push acc
2B09 7401       888            mov a, #1
2B0B 14         888            dec a
2B0C 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2B0F D0E0       888            pop acc
2B11 C083       888            push dph
2B13 C082       888            push dpl
2B15 C0E0       888            push acc
2B17 900D80     888            mov dptr, #HomeBtm3
2B1A 1200B4     888            lcall ?Send_Constant_String
2B1D D0E0       888            pop acc
2B1F D082       888            pop dpl
2B21 D083       888            pop dph                 ;display bottom half no cursor
2B23            888   Skip_Displaying_Bottom513:                       
2B23 022C9D     888            ljmp Menu_Done_Display_Cursor_Change512         
2B26            888                    
2B26            888   Menu_Display_not_ONE512:
2B26 E9         888                    mov a, R1
2B27 B40179     888                    cjne a, #0x01, Menu_Display_not_TWO512
2B2A C0E0       888            push acc
2B2C 7401       888            mov a, #1
2B2E 14         888            dec a
2B2F 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2B32 D0E0       888            pop acc
2B34 C083       888            push dph
2B36 C082       888            push dpl
2B38 C0E0       888            push acc
2B3A 900D1A     888            mov dptr, #CLEARLINE
2B3D 1200B4     888            lcall ?Send_Constant_String
2B40 D0E0       888            pop acc
2B42 D082       888            pop dpl
2B44 D083       888            pop dph
2B46 C0E0       888            push acc
2B48 7401       888            mov a, #1
2B4A 14         888            dec a
2B4B 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2B4E D0E0       888            pop acc
2B50 C083       888            push dph
2B52 C082       888            push dpl
2B54 C0E0       888            push acc
2B56 900D3C     888            mov dptr, #HomeTop2
2B59 1200B4     888            lcall ?Send_Constant_String
2B5C D0E0       888            pop acc
2B5E D082       888            pop dpl
2B60 D083       888            pop dph                 ;display top half, cursor >
2B62            888            ;check if its required to display bottom half
2B62 EA         888            mov a, R2
2B63 5402       888            anl a, #0x02
2B65 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom522
2B68 C0E0       888            push acc
2B6A 7401       888            mov a, #1
2B6C 14         888            dec a
2B6D 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2B70 D0E0       888            pop acc
2B72 C083       888            push dph
2B74 C082       888            push dpl
2B76 C0E0       888            push acc
2B78 900D1A     888            mov dptr, #CLEARLINE
2B7B 1200B4     888            lcall ?Send_Constant_String
2B7E D0E0       888            pop acc
2B80 D082       888            pop dpl
2B82 D083       888            pop dph
2B84 C0E0       888            push acc
2B86 7401       888            mov a, #1
2B88 14         888            dec a
2B89 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2B8C D0E0       888            pop acc
2B8E C083       888            push dph
2B90 C082       888            push dpl
2B92 C0E0       888            push acc
2B94 900D80     888            mov dptr, #HomeBtm3
2B97 1200B4     888            lcall ?Send_Constant_String
2B9A D0E0       888            pop acc
2B9C D082       888            pop dpl
2B9E D083       888            pop dph                 ;display bottom half no cursor
2BA0            888   Skip_Displaying_Bottom522:
2BA0 022C9D     888                    ljmp Menu_Done_Display_Cursor_Change512
2BA3            888                                    
2BA3            888   Menu_Display_not_TWO512:
2BA3 E9         888                    mov a, R1
2BA4 B40279     888                    cjne a, #0x02, Menu_Display_not_THREE512
2BA7 C0E0       888            push acc
2BA9 7401       888            mov a, #1
2BAB 14         888            dec a
2BAC 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2BAF D0E0       888            pop acc
2BB1 C083       888            push dph
2BB3 C082       888            push dpl
2BB5 C0E0       888            push acc
2BB7 900D1A     888            mov dptr, #CLEARLINE
2BBA 1200B4     888            lcall ?Send_Constant_String
2BBD D0E0       888            pop acc
2BBF D082       888            pop dpl
2BC1 D083       888            pop dph
2BC3 C0E0       888            push acc
2BC5 7401       888            mov a, #1
2BC7 14         888            dec a
2BC8 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2BCB D0E0       888            pop acc
2BCD C083       888            push dph
2BCF C082       888            push dpl
2BD1 C0E0       888            push acc
2BD3 900D4D     888            mov dptr, #HomeTop3
2BD6 1200B4     888            lcall ?Send_Constant_String
2BD9 D0E0       888            pop acc
2BDB D082       888            pop dpl
2BDD D083       888            pop dph                 ;display top half, cursor >
2BDF            888            ;check if its required to display bottom half
2BDF EA         888            mov a, R2
2BE0 5402       888            anl a, #0x02
2BE2 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom531
2BE5 C0E0       888            push acc
2BE7 7401       888            mov a, #1
2BE9 14         888            dec a
2BEA 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2BED D0E0       888            pop acc
2BEF C083       888            push dph
2BF1 C082       888            push dpl
2BF3 C0E0       888            push acc
2BF5 900D1A     888            mov dptr, #CLEARLINE
2BF8 1200B4     888            lcall ?Send_Constant_String
2BFB D0E0       888            pop acc
2BFD D082       888            pop dpl
2BFF D083       888            pop dph
2C01 C0E0       888            push acc
2C03 7401       888            mov a, #1
2C05 14         888            dec a
2C06 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2C09 D0E0       888            pop acc
2C0B C083       888            push dph
2C0D C082       888            push dpl
2C0F C0E0       888            push acc
2C11 900D5E     888            mov dptr, #HomeBtm1
2C14 1200B4     888            lcall ?Send_Constant_String
2C17 D0E0       888            pop acc
2C19 D082       888            pop dpl
2C1B D083       888            pop dph                 ;display bottom half no cursor
2C1D            888   Skip_Displaying_Bottom531:
2C1D 022C9D     888                    ljmp Menu_Done_Display_Cursor_Change512
2C20            888                                    
2C20            888   Menu_Display_not_THREE512:
2C20 E9         888                    mov a, R1
2C21 B40379     888                    cjne a, #0x03, Menu_Display_not_FOUR512
2C24 C0E0       888            push acc
2C26 7401       888            mov a, #1
2C28 14         888            dec a
2C29 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2C2C D0E0       888            pop acc
2C2E C083       888            push dph
2C30 C082       888            push dpl
2C32 C0E0       888            push acc
2C34 900D1A     888            mov dptr, #CLEARLINE
2C37 1200B4     888            lcall ?Send_Constant_String
2C3A D0E0       888            pop acc
2C3C D082       888            pop dpl
2C3E D083       888            pop dph
2C40 C0E0       888            push acc
2C42 7401       888            mov a, #1
2C44 14         888            dec a
2C45 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2C48 D0E0       888            pop acc
2C4A C083       888            push dph
2C4C C082       888            push dpl
2C4E C0E0       888            push acc
2C50 900D4D     888            mov dptr, #HomeTop3
2C53 1200B4     888            lcall ?Send_Constant_String
2C56 D0E0       888            pop acc
2C58 D082       888            pop dpl
2C5A D083       888            pop dph                 ;display top half, cursor >
2C5C            888            ;check if its required to display bottom half
2C5C EA         888            mov a, R2
2C5D 5402       888            anl a, #0x02
2C5F B40238     888            cjne a, #0x02, Skip_Displaying_Bottom540
2C62 C0E0       888            push acc
2C64 7401       888            mov a, #1
2C66 14         888            dec a
2C67 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2C6A D0E0       888            pop acc
2C6C C083       888            push dph
2C6E C082       888            push dpl
2C70 C0E0       888            push acc
2C72 900D1A     888            mov dptr, #CLEARLINE
2C75 1200B4     888            lcall ?Send_Constant_String
2C78 D0E0       888            pop acc
2C7A D082       888            pop dpl
2C7C D083       888            pop dph
2C7E C0E0       888            push acc
2C80 7401       888            mov a, #1
2C82 14         888            dec a
2C83 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2C86 D0E0       888            pop acc
2C88 C083       888            push dph
2C8A C082       888            push dpl
2C8C C0E0       888            push acc
2C8E 900D6F     888            mov dptr, #HomeBtm2
2C91 1200B4     888            lcall ?Send_Constant_String
2C94 D0E0       888            pop acc
2C96 D082       888            pop dpl
2C98 D083       888            pop dph                 ;display bottom half no cursor
2C9A            888   Skip_Displaying_Bottom540:       
2C9A 022C9D     888                    ljmp Menu_Done_Display_Cursor_Change512
2C9D            888                                    
2C9D            888   Menu_Display_not_FOUR512:
2C9D            888   Menu_Done_Display_Cursor_Change512:      ;display on LCD
2C9D            888            
2C9D            888   Menu_Skip_Cursor_INC472:
2C9D            888   
2C9D            888            ;Then, Check to see if the user wants to DEC the cursors location
2C9D 20A514     888            jb B2, Menu_Skip_Cursor_DECtp472        ; if the 'B0' button is not pressed skip
2CA0 C002       888            push AR2
2CA2 7A0A       888            mov R2, #10
2CA4 120039     888            lcall ?Wait_Milli_Seconds
2CA7 D002       888            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2CA9 20A508     888            jb B2, Menu_Skip_Cursor_DECtp472        ; if the 'B0' button is not pressed skip
2CAC 30A5FD     888            jnb B2, $                               ; Wait for button release.
2CAF 30A6FD     888            jnb B0, $                               ; Wait for button release.
2CB2            888            ;The below code is used to get around the max jb jump distance
2CB2 8003       888            sjmp Menu_DEC_Cursor472
2CB4            888   Menu_Skip_Cursor_DECtp472:
2CB4 022EAF     888            ljmp Menu_Skip_Cursor_DEC472
2CB7            888   Menu_DEC_Cursor472:      
2CB7 19         888            DEC R1                                                  ;increment the cursors position
2CB8 1210D9     888            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
2CBB            888            ;display the screen after it has switched. This stays inside the 
2CBB            888            ;change cursor part so it only updates when pressed, not constantly.
2CBB E9         888            mov a, R1
2CBC B40079     888            cjne a, #0x00, Menu_Display_not_ONE550
2CBF C0E0       888            push acc
2CC1 7401       888            mov a, #1
2CC3 14         888            dec a
2CC4 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2CC7 D0E0       888            pop acc
2CC9 C083       888            push dph
2CCB C082       888            push dpl
2CCD C0E0       888            push acc
2CCF 900D1A     888            mov dptr, #CLEARLINE
2CD2 1200B4     888            lcall ?Send_Constant_String
2CD5 D0E0       888            pop acc
2CD7 D082       888            pop dpl
2CD9 D083       888            pop dph
2CDB C0E0       888            push acc
2CDD 7401       888            mov a, #1
2CDF 14         888            dec a
2CE0 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2CE3 D0E0       888            pop acc
2CE5 C083       888            push dph
2CE7 C082       888            push dpl
2CE9 C0E0       888            push acc
2CEB 900D2B     888            mov dptr, #HomeTop1
2CEE 1200B4     888            lcall ?Send_Constant_String
2CF1 D0E0       888            pop acc
2CF3 D082       888            pop dpl
2CF5 D083       888            pop dph                 ;display top half, cursor >
2CF7            888            ;check if its required to display bottom half
2CF7 EA         888            mov a, R2
2CF8 5402       888            anl a, #0x02
2CFA B40238     888            cjne a, #0x02, Skip_Displaying_Bottom551
2CFD C0E0       888            push acc
2CFF 7401       888            mov a, #1
2D01 14         888            dec a
2D02 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2D05 D0E0       888            pop acc
2D07 C083       888            push dph
2D09 C082       888            push dpl
2D0B C0E0       888            push acc
2D0D 900D1A     888            mov dptr, #CLEARLINE
2D10 1200B4     888            lcall ?Send_Constant_String
2D13 D0E0       888            pop acc
2D15 D082       888            pop dpl
2D17 D083       888            pop dph
2D19 C0E0       888            push acc
2D1B 7401       888            mov a, #1
2D1D 14         888            dec a
2D1E 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2D21 D0E0       888            pop acc
2D23 C083       888            push dph
2D25 C082       888            push dpl
2D27 C0E0       888            push acc
2D29 900D80     888            mov dptr, #HomeBtm3
2D2C 1200B4     888            lcall ?Send_Constant_String
2D2F D0E0       888            pop acc
2D31 D082       888            pop dpl
2D33 D083       888            pop dph                 ;display bottom half no cursor
2D35            888   Skip_Displaying_Bottom551:                       
2D35 022EAF     888            ljmp Menu_Done_Display_Cursor_Change550         
2D38            888                    
2D38            888   Menu_Display_not_ONE550:
2D38 E9         888                    mov a, R1
2D39 B40179     888                    cjne a, #0x01, Menu_Display_not_TWO550
2D3C C0E0       888            push acc
2D3E 7401       888            mov a, #1
2D40 14         888            dec a
2D41 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2D44 D0E0       888            pop acc
2D46 C083       888            push dph
2D48 C082       888            push dpl
2D4A C0E0       888            push acc
2D4C 900D1A     888            mov dptr, #CLEARLINE
2D4F 1200B4     888            lcall ?Send_Constant_String
2D52 D0E0       888            pop acc
2D54 D082       888            pop dpl
2D56 D083       888            pop dph
2D58 C0E0       888            push acc
2D5A 7401       888            mov a, #1
2D5C 14         888            dec a
2D5D 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2D60 D0E0       888            pop acc
2D62 C083       888            push dph
2D64 C082       888            push dpl
2D66 C0E0       888            push acc
2D68 900D3C     888            mov dptr, #HomeTop2
2D6B 1200B4     888            lcall ?Send_Constant_String
2D6E D0E0       888            pop acc
2D70 D082       888            pop dpl
2D72 D083       888            pop dph                 ;display top half, cursor >
2D74            888            ;check if its required to display bottom half
2D74 EA         888            mov a, R2
2D75 5402       888            anl a, #0x02
2D77 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom560
2D7A C0E0       888            push acc
2D7C 7401       888            mov a, #1
2D7E 14         888            dec a
2D7F 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2D82 D0E0       888            pop acc
2D84 C083       888            push dph
2D86 C082       888            push dpl
2D88 C0E0       888            push acc
2D8A 900D1A     888            mov dptr, #CLEARLINE
2D8D 1200B4     888            lcall ?Send_Constant_String
2D90 D0E0       888            pop acc
2D92 D082       888            pop dpl
2D94 D083       888            pop dph
2D96 C0E0       888            push acc
2D98 7401       888            mov a, #1
2D9A 14         888            dec a
2D9B 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2D9E D0E0       888            pop acc
2DA0 C083       888            push dph
2DA2 C082       888            push dpl
2DA4 C0E0       888            push acc
2DA6 900D80     888            mov dptr, #HomeBtm3
2DA9 1200B4     888            lcall ?Send_Constant_String
2DAC D0E0       888            pop acc
2DAE D082       888            pop dpl
2DB0 D083       888            pop dph                 ;display bottom half no cursor
2DB2            888   Skip_Displaying_Bottom560:
2DB2 022EAF     888                    ljmp Menu_Done_Display_Cursor_Change550
2DB5            888                                    
2DB5            888   Menu_Display_not_TWO550:
2DB5 E9         888                    mov a, R1
2DB6 B40279     888                    cjne a, #0x02, Menu_Display_not_THREE550
2DB9 C0E0       888            push acc
2DBB 7401       888            mov a, #1
2DBD 14         888            dec a
2DBE 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2DC1 D0E0       888            pop acc
2DC3 C083       888            push dph
2DC5 C082       888            push dpl
2DC7 C0E0       888            push acc
2DC9 900D1A     888            mov dptr, #CLEARLINE
2DCC 1200B4     888            lcall ?Send_Constant_String
2DCF D0E0       888            pop acc
2DD1 D082       888            pop dpl
2DD3 D083       888            pop dph
2DD5 C0E0       888            push acc
2DD7 7401       888            mov a, #1
2DD9 14         888            dec a
2DDA 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2DDD D0E0       888            pop acc
2DDF C083       888            push dph
2DE1 C082       888            push dpl
2DE3 C0E0       888            push acc
2DE5 900D4D     888            mov dptr, #HomeTop3
2DE8 1200B4     888            lcall ?Send_Constant_String
2DEB D0E0       888            pop acc
2DED D082       888            pop dpl
2DEF D083       888            pop dph                 ;display top half, cursor >
2DF1            888            ;check if its required to display bottom half
2DF1 EA         888            mov a, R2
2DF2 5402       888            anl a, #0x02
2DF4 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom569
2DF7 C0E0       888            push acc
2DF9 7401       888            mov a, #1
2DFB 14         888            dec a
2DFC 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2DFF D0E0       888            pop acc
2E01 C083       888            push dph
2E03 C082       888            push dpl
2E05 C0E0       888            push acc
2E07 900D1A     888            mov dptr, #CLEARLINE
2E0A 1200B4     888            lcall ?Send_Constant_String
2E0D D0E0       888            pop acc
2E0F D082       888            pop dpl
2E11 D083       888            pop dph
2E13 C0E0       888            push acc
2E15 7401       888            mov a, #1
2E17 14         888            dec a
2E18 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2E1B D0E0       888            pop acc
2E1D C083       888            push dph
2E1F C082       888            push dpl
2E21 C0E0       888            push acc
2E23 900D5E     888            mov dptr, #HomeBtm1
2E26 1200B4     888            lcall ?Send_Constant_String
2E29 D0E0       888            pop acc
2E2B D082       888            pop dpl
2E2D D083       888            pop dph                 ;display bottom half no cursor
2E2F            888   Skip_Displaying_Bottom569:
2E2F 022EAF     888                    ljmp Menu_Done_Display_Cursor_Change550
2E32            888                                    
2E32            888   Menu_Display_not_THREE550:
2E32 E9         888                    mov a, R1
2E33 B40379     888                    cjne a, #0x03, Menu_Display_not_FOUR550
2E36 C0E0       888            push acc
2E38 7401       888            mov a, #1
2E3A 14         888            dec a
2E3B 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2E3E D0E0       888            pop acc
2E40 C083       888            push dph
2E42 C082       888            push dpl
2E44 C0E0       888            push acc
2E46 900D1A     888            mov dptr, #CLEARLINE
2E49 1200B4     888            lcall ?Send_Constant_String
2E4C D0E0       888            pop acc
2E4E D082       888            pop dpl
2E50 D083       888            pop dph
2E52 C0E0       888            push acc
2E54 7401       888            mov a, #1
2E56 14         888            dec a
2E57 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2E5A D0E0       888            pop acc
2E5C C083       888            push dph
2E5E C082       888            push dpl
2E60 C0E0       888            push acc
2E62 900D4D     888            mov dptr, #HomeTop3
2E65 1200B4     888            lcall ?Send_Constant_String
2E68 D0E0       888            pop acc
2E6A D082       888            pop dpl
2E6C D083       888            pop dph                 ;display top half, cursor >
2E6E            888            ;check if its required to display bottom half
2E6E EA         888            mov a, R2
2E6F 5402       888            anl a, #0x02
2E71 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom578
2E74 C0E0       888            push acc
2E76 7401       888            mov a, #1
2E78 14         888            dec a
2E79 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2E7C D0E0       888            pop acc
2E7E C083       888            push dph
2E80 C082       888            push dpl
2E82 C0E0       888            push acc
2E84 900D1A     888            mov dptr, #CLEARLINE
2E87 1200B4     888            lcall ?Send_Constant_String
2E8A D0E0       888            pop acc
2E8C D082       888            pop dpl
2E8E D083       888            pop dph
2E90 C0E0       888            push acc
2E92 7401       888            mov a, #1
2E94 14         888            dec a
2E95 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2E98 D0E0       888            pop acc
2E9A C083       888            push dph
2E9C C082       888            push dpl
2E9E C0E0       888            push acc
2EA0 900D6F     888            mov dptr, #HomeBtm2
2EA3 1200B4     888            lcall ?Send_Constant_String
2EA6 D0E0       888            pop acc
2EA8 D082       888            pop dpl
2EAA D083       888            pop dph                 ;display bottom half no cursor
2EAC            888   Skip_Displaying_Bottom578:       
2EAC 022EAF     888                    ljmp Menu_Done_Display_Cursor_Change550
2EAF            888                                    
2EAF            888   Menu_Display_not_FOUR550:
2EAF            888   Menu_Done_Display_Cursor_Change550:      ;display on LCD
2EAF            888            
2EAF            888   Menu_Skip_Cursor_DEC472:
2EAF            888   
2EAF            888            ;Check if the user wanted to exit the level of the menu
2EAF E8         888            mov a, R0
2EB0 B40105     888            cjne a, #0x01, Menu_Stay472     ;if the flag is not 1, continue program, otherwise reset flag and return
2EB3 7800       888            mov R0, #0x00
2EB5 0230F3     888            ljmp Menu_Exit_Level472
2EB8            888            
2EB8            888   Menu_Stay472:    
2EB8            888            ;now the code that operates when the "select" button is pressed
2EB8 20A711     888            jb B1, Menu_Skip_Select_Changetp472     ; if the 'B1' button is not pressed skip
2EBB C002       888            push AR2
2EBD 7A32       888            mov R2, #50
2EBF 120039     888            lcall ?Wait_Milli_Seconds
2EC2 D002       888            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2EC4 20A705     888            jb B1, Menu_Skip_Select_Changetp472     ; if the 'B1' button is not pressed skip
2EC7 30A7FD     888            jnb B1, $                               ; Wait for button release
2ECA            888            ;The below code is used to get around the max jb jump distance 
2ECA 8003       888            sjmp Menu_Select_Change472
2ECC            888   Menu_Skip_Select_Changetp472:
2ECC 0230ED     888            ljmp Menu_Skip_Select_Change472         ;the button was not pressed.
2ECF            888            
2ECF            888   Menu_Select_Change472:
2ECF            888            
2ECF            888   ;We simply compare what number is in the cursor and enter that function
2ECF E9         888            mov a, R1
2ED0 B40006     888            cjne a, #0x00, Menu_Not_Func_One_Select588
2ED3            888            ;if here, then the cursor is on the above position
2ED3 12329D     888            lcall Start_Process
2ED6 022EF7     888            ljmp Menu_Done_Func588
2ED9            888                            
2ED9            888   Menu_Not_Func_One_Select588:
2ED9 E9         888                    mov a, R1
2EDA B40106     888            cjne a, #0x01, Menu_Not_Func_Two_Select588
2EDD            888            ;if here, then the cursor is on the above position
2EDD 121A66     888            lcall Settings
2EE0 022EF7     888            ljmp Menu_Done_Func588
2EE3            888                            
2EE3            888   Menu_Not_Func_Two_Select588:
2EE3 E9         888            mov a, R1
2EE4 B40206     888            cjne a, #0x02, Menu_Not_Func_Three_Select588
2EE7            888            ;if here, then the cursor is on the above position
2EE7 1211B9     888            lcall Select_Presets
2EEA 022EF7     888            ljmp Menu_Done_Func588
2EED            888                            
2EED            888   Menu_Not_Func_Three_Select588:
2EED E9         888            mov a, R1
2EEE B40306     888            cjne a, #0x03, Menu_Not_Func_Four_Select588
2EF1            888            ;if here, then the cursor is on the above position
2EF1 123105     888            lcall Menu_Probes
2EF4 022EF7     888            ljmp Menu_Done_Func588
2EF7            888                            
2EF7            888   Menu_Not_Func_Four_Select588:
2EF7            888   
2EF7            888   Menu_Done_Func588:
2EF7            888   
2EF7            888            ;after selecting the function and exiting it, reset the cursor position and the screen
2EF7 7900       888            mov R1, #0x00
2EF9            888            ;display the screen after it has switched. This stays inside the 
2EF9            888            ;change cursor part so it only updates when pressed, not constantly.
2EF9 E9         888            mov a, R1
2EFA B40079     888            cjne a, #0x00, Menu_Display_not_ONE589
2EFD C0E0       888            push acc
2EFF 7401       888            mov a, #1
2F01 14         888            dec a
2F02 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2F05 D0E0       888            pop acc
2F07 C083       888            push dph
2F09 C082       888            push dpl
2F0B C0E0       888            push acc
2F0D 900D1A     888            mov dptr, #CLEARLINE
2F10 1200B4     888            lcall ?Send_Constant_String
2F13 D0E0       888            pop acc
2F15 D082       888            pop dpl
2F17 D083       888            pop dph
2F19 C0E0       888            push acc
2F1B 7401       888            mov a, #1
2F1D 14         888            dec a
2F1E 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2F21 D0E0       888            pop acc
2F23 C083       888            push dph
2F25 C082       888            push dpl
2F27 C0E0       888            push acc
2F29 900D2B     888            mov dptr, #HomeTop1
2F2C 1200B4     888            lcall ?Send_Constant_String
2F2F D0E0       888            pop acc
2F31 D082       888            pop dpl
2F33 D083       888            pop dph                 ;display top half, cursor >
2F35            888            ;check if its required to display bottom half
2F35 EA         888            mov a, R2
2F36 5402       888            anl a, #0x02
2F38 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom590
2F3B C0E0       888            push acc
2F3D 7401       888            mov a, #1
2F3F 14         888            dec a
2F40 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2F43 D0E0       888            pop acc
2F45 C083       888            push dph
2F47 C082       888            push dpl
2F49 C0E0       888            push acc
2F4B 900D1A     888            mov dptr, #CLEARLINE
2F4E 1200B4     888            lcall ?Send_Constant_String
2F51 D0E0       888            pop acc
2F53 D082       888            pop dpl
2F55 D083       888            pop dph
2F57 C0E0       888            push acc
2F59 7401       888            mov a, #1
2F5B 14         888            dec a
2F5C 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2F5F D0E0       888            pop acc
2F61 C083       888            push dph
2F63 C082       888            push dpl
2F65 C0E0       888            push acc
2F67 900D80     888            mov dptr, #HomeBtm3
2F6A 1200B4     888            lcall ?Send_Constant_String
2F6D D0E0       888            pop acc
2F6F D082       888            pop dpl
2F71 D083       888            pop dph                 ;display bottom half no cursor
2F73            888   Skip_Displaying_Bottom590:                       
2F73 0230ED     888            ljmp Menu_Done_Display_Cursor_Change589         
2F76            888                    
2F76            888   Menu_Display_not_ONE589:
2F76 E9         888                    mov a, R1
2F77 B40179     888                    cjne a, #0x01, Menu_Display_not_TWO589
2F7A C0E0       888            push acc
2F7C 7401       888            mov a, #1
2F7E 14         888            dec a
2F7F 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2F82 D0E0       888            pop acc
2F84 C083       888            push dph
2F86 C082       888            push dpl
2F88 C0E0       888            push acc
2F8A 900D1A     888            mov dptr, #CLEARLINE
2F8D 1200B4     888            lcall ?Send_Constant_String
2F90 D0E0       888            pop acc
2F92 D082       888            pop dpl
2F94 D083       888            pop dph
2F96 C0E0       888            push acc
2F98 7401       888            mov a, #1
2F9A 14         888            dec a
2F9B 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2F9E D0E0       888            pop acc
2FA0 C083       888            push dph
2FA2 C082       888            push dpl
2FA4 C0E0       888            push acc
2FA6 900D3C     888            mov dptr, #HomeTop2
2FA9 1200B4     888            lcall ?Send_Constant_String
2FAC D0E0       888            pop acc
2FAE D082       888            pop dpl
2FB0 D083       888            pop dph                 ;display top half, cursor >
2FB2            888            ;check if its required to display bottom half
2FB2 EA         888            mov a, R2
2FB3 5402       888            anl a, #0x02
2FB5 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom599
2FB8 C0E0       888            push acc
2FBA 7401       888            mov a, #1
2FBC 14         888            dec a
2FBD 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2FC0 D0E0       888            pop acc
2FC2 C083       888            push dph
2FC4 C082       888            push dpl
2FC6 C0E0       888            push acc
2FC8 900D1A     888            mov dptr, #CLEARLINE
2FCB 1200B4     888            lcall ?Send_Constant_String
2FCE D0E0       888            pop acc
2FD0 D082       888            pop dpl
2FD2 D083       888            pop dph
2FD4 C0E0       888            push acc
2FD6 7401       888            mov a, #1
2FD8 14         888            dec a
2FD9 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
2FDC D0E0       888            pop acc
2FDE C083       888            push dph
2FE0 C082       888            push dpl
2FE2 C0E0       888            push acc
2FE4 900D80     888            mov dptr, #HomeBtm3
2FE7 1200B4     888            lcall ?Send_Constant_String
2FEA D0E0       888            pop acc
2FEC D082       888            pop dpl
2FEE D083       888            pop dph                 ;display bottom half no cursor
2FF0            888   Skip_Displaying_Bottom599:
2FF0 0230ED     888                    ljmp Menu_Done_Display_Cursor_Change589
2FF3            888                                    
2FF3            888   Menu_Display_not_TWO589:
2FF3 E9         888                    mov a, R1
2FF4 B40279     888                    cjne a, #0x02, Menu_Display_not_THREE589
2FF7 C0E0       888            push acc
2FF9 7401       888            mov a, #1
2FFB 14         888            dec a
2FFC 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
2FFF D0E0       888            pop acc
3001 C083       888            push dph
3003 C082       888            push dpl
3005 C0E0       888            push acc
3007 900D1A     888            mov dptr, #CLEARLINE
300A 1200B4     888            lcall ?Send_Constant_String
300D D0E0       888            pop acc
300F D082       888            pop dpl
3011 D083       888            pop dph
3013 C0E0       888            push acc
3015 7401       888            mov a, #1
3017 14         888            dec a
3018 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
301B D0E0       888            pop acc
301D C083       888            push dph
301F C082       888            push dpl
3021 C0E0       888            push acc
3023 900D4D     888            mov dptr, #HomeTop3
3026 1200B4     888            lcall ?Send_Constant_String
3029 D0E0       888            pop acc
302B D082       888            pop dpl
302D D083       888            pop dph                 ;display top half, cursor >
302F            888            ;check if its required to display bottom half
302F EA         888            mov a, R2
3030 5402       888            anl a, #0x02
3032 B40238     888            cjne a, #0x02, Skip_Displaying_Bottom608
3035 C0E0       888            push acc
3037 7401       888            mov a, #1
3039 14         888            dec a
303A 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
303D D0E0       888            pop acc
303F C083       888            push dph
3041 C082       888            push dpl
3043 C0E0       888            push acc
3045 900D1A     888            mov dptr, #CLEARLINE
3048 1200B4     888            lcall ?Send_Constant_String
304B D0E0       888            pop acc
304D D082       888            pop dpl
304F D083       888            pop dph
3051 C0E0       888            push acc
3053 7401       888            mov a, #1
3055 14         888            dec a
3056 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
3059 D0E0       888            pop acc
305B C083       888            push dph
305D C082       888            push dpl
305F C0E0       888            push acc
3061 900D5E     888            mov dptr, #HomeBtm1
3064 1200B4     888            lcall ?Send_Constant_String
3067 D0E0       888            pop acc
3069 D082       888            pop dpl
306B D083       888            pop dph                 ;display bottom half no cursor
306D            888   Skip_Displaying_Bottom608:
306D 0230ED     888                    ljmp Menu_Done_Display_Cursor_Change589
3070            888                                    
3070            888   Menu_Display_not_THREE589:
3070 E9         888                    mov a, R1
3071 B40379     888                    cjne a, #0x03, Menu_Display_not_FOUR589
3074 C0E0       888            push acc
3076 7401       888            mov a, #1
3078 14         888            dec a
3079 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
307C D0E0       888            pop acc
307E C083       888            push dph
3080 C082       888            push dpl
3082 C0E0       888            push acc
3084 900D1A     888            mov dptr, #CLEARLINE
3087 1200B4     888            lcall ?Send_Constant_String
308A D0E0       888            pop acc
308C D082       888            pop dpl
308E D083       888            pop dph
3090 C0E0       888            push acc
3092 7401       888            mov a, #1
3094 14         888            dec a
3095 1200C1     888            lcall ?Set_Cursor_1 ; Select column and row
3098 D0E0       888            pop acc
309A C083       888            push dph
309C C082       888            push dpl
309E C0E0       888            push acc
30A0 900D4D     888            mov dptr, #HomeTop3
30A3 1200B4     888            lcall ?Send_Constant_String
30A6 D0E0       888            pop acc
30A8 D082       888            pop dpl
30AA D083       888            pop dph                 ;display top half, cursor >
30AC            888            ;check if its required to display bottom half
30AC EA         888            mov a, R2
30AD 5402       888            anl a, #0x02
30AF B40238     888            cjne a, #0x02, Skip_Displaying_Bottom617
30B2 C0E0       888            push acc
30B4 7401       888            mov a, #1
30B6 14         888            dec a
30B7 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
30BA D0E0       888            pop acc
30BC C083       888            push dph
30BE C082       888            push dpl
30C0 C0E0       888            push acc
30C2 900D1A     888            mov dptr, #CLEARLINE
30C5 1200B4     888            lcall ?Send_Constant_String
30C8 D0E0       888            pop acc
30CA D082       888            pop dpl
30CC D083       888            pop dph
30CE C0E0       888            push acc
30D0 7401       888            mov a, #1
30D2 14         888            dec a
30D3 1200BF     888            lcall ?Set_Cursor_2 ; Select column and row
30D6 D0E0       888            pop acc
30D8 C083       888            push dph
30DA C082       888            push dpl
30DC C0E0       888            push acc
30DE 900D6F     888            mov dptr, #HomeBtm2
30E1 1200B4     888            lcall ?Send_Constant_String
30E4 D0E0       888            pop acc
30E6 D082       888            pop dpl
30E8 D083       888            pop dph                 ;display bottom half no cursor
30EA            888   Skip_Displaying_Bottom617:       
30EA 0230ED     888                    ljmp Menu_Done_Display_Cursor_Change589
30ED            888                                    
30ED            888   Menu_Display_not_FOUR589:
30ED            888   Menu_Done_Display_Cursor_Change589:
30ED            888   
30ED            888   Menu_Skip_Select_Change472:
30ED            888            
30ED            888            ;calling the operation function, which does stuff every cycle.
30ED 121125     888            lcall Extra_Functions_Home
30F0 022A8B     888            ljmp Menu_Loop472
30F3            888   
30F3            888   Menu_Exit_Level472:
30F3 D0E0       888            pop acc
30F5 D007       888            pop  ar7
30F7 D006       888            pop  ar6
30F9 D005       888            pop  ar5
30FB D004       888            pop  ar4
30FD D003       888            pop  ar3
30FF D002       888            pop  ar2
3101 D001       888            pop  ar1
3103 D000       888            pop  ar0
3105            889            
3105            890            
3105            891   Menu_Probes:
3105 C0E0       892            push acc
3107 7401       892            mov a, #1
3109 14         892            dec a
310A 1200C1     892            lcall ?Set_Cursor_1 ; Select column and row
310D D0E0       892            pop acc
310F C083       892            push dph
3111 C082       892            push dpl
3113 C0E0       892            push acc
3115 900D1A     892            mov dptr, #CLEARLINE
3118 1200B4     892            lcall ?Send_Constant_String
311B D0E0       892            pop acc
311D D082       892            pop dpl
311F D083       892            pop dph
3121 C0E0       892            push acc
3123 7401       892            mov a, #1
3125 14         892            dec a
3126 1200BF     892            lcall ?Set_Cursor_2 ; Select column and row
3129 D0E0       892            pop acc
312B C083       892            push dph
312D C082       892            push dpl
312F C0E0       892            push acc
3131 900D1A     892            mov dptr, #CLEARLINE
3134 1200B4     892            lcall ?Send_Constant_String
3137 D0E0       892            pop acc
3139 D082       892            pop dpl
313B D083       892            pop dph
313D C0E0       892            push acc
313F 7401       892            mov a, #1
3141 14         892            dec a
3142 1200C1     892            lcall ?Set_Cursor_1 ; Select column and row
3145 D0E0       892            pop acc
3147 C083       892            push dph
3149 C082       892            push dpl
314B C0E0       892            push acc
314D 900F49     892            mov dptr, #ProbeTop
3150 1200B4     892            lcall ?Send_Constant_String
3153 D0E0       892            pop acc
3155 D082       892            pop dpl
3157 D083       892            pop dph
3159 C0E0       892            push acc
315B 7401       892            mov a, #1
315D 14         892            dec a
315E 1200BF     892            lcall ?Set_Cursor_2 ; Select column and row
3161 D0E0       892            pop acc
3163 C083       892            push dph
3165 C082       892            push dpl
3167 C0E0       892            push acc
3169 900F5A     892            mov dptr, #ProbeBtm
316C 1200B4     892            lcall ?Send_Constant_String
316F D0E0       892            pop acc
3171 D082       892            pop dpl
3173 D083       892            pop dph
3175 C002       893            push AR2
3177 7AFA       893            mov R2, #250
3179 120039     893            lcall ?Wait_Milli_Seconds
317C D002       893            pop AR2
317E C002       894            push AR2
3180 7AFA       894            mov R2, #250
3182 120039     894            lcall ?Wait_Milli_Seconds
3185 D002       894            pop AR2
3187 C002       895            push AR2
3189 7AFA       895            mov R2, #250
318B 120039     895            lcall ?Wait_Milli_Seconds
318E D002       895            pop AR2
3190            896   Menu_Probes_Loop:
3190            897                    ;check if the emergency button has been pressed
3190 20A710     898            jb B1, Skip_Exit_Probes ; if the 'B0' button is not pressed skip
3193 C002       899            push AR2
3195 7A32       899            mov R2, #50
3197 120039     899            lcall ?Wait_Milli_Seconds
319A D002       899            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
319C 20A704     900            jb B1,Skip_Exit_Probes ; if the 'B0' button is not pressed skip
319F 30A7FD     901            jnb B1, $
31A2            902            ;check if the user wants to exit
31A2 22         903            ret
31A3            904   Skip_Exit_Probes:        
31A3 12117C     905            lcall Error_Code_1Check         
31A6 855A47     906            mov x + 0, Probe1_Temp+0
31A9 855B48     907            mov x + 1, Probe1_Temp+1
31AC 754900     908            mov x + 2, #0x00
31AF 754A00     909            mov x + 3, #0x00
31B2 120129     910            lcall hex2bcd           ;change hex number to bcd so it can be displayed
31B5 C0E0       911            push acc
31B7 7401       911            mov a, #1
31B9 14         911            dec a
31BA 1200C1     911            lcall ?Set_Cursor_1 ; Select column and row
31BD D0E0       911            pop acc
31BF C000       912            push ar0
31C1 A851       912            mov r0, bcd+2
31C3 1200C6     912            lcall ?Display_BCD
31C6 D000       912            pop ar0
31C8 C000       913            push ar0
31CA A850       913            mov r0, bcd+1
31CC 1200C6     913            lcall ?Display_BCD
31CF D000       913            pop ar0
31D1 C0E0       914            push acc
31D3 742E       914            mov a, #'.'
31D5 12007E     914            lcall ?WriteData
31D8 D0E0       914            pop acc
31DA C000       915            push ar0
31DC A84F       915            mov r0, bcd+0
31DE 1200C6     915            lcall ?Display_BCD
31E1 D000       915            pop ar0
31E3            916            
31E3 855C47     917            mov x + 0, Probe2_Temp+0
31E6 855D48     918            mov x + 1, Probe2_Temp+1
31E9 754900     919            mov x + 2, #0x00
31EC 754A00     920            mov x + 3, #0x00
31EF 120129     921            lcall hex2bcd           ;change hex number to bcd so it can be displayed
31F2 C0E0       922            push acc
31F4 7401       922            mov a, #1
31F6 14         922            dec a
31F7 1200BF     922            lcall ?Set_Cursor_2 ; Select column and row
31FA D0E0       922            pop acc
31FC C000       923            push ar0
31FE A851       923            mov r0, bcd+2
3200 1200C6     923            lcall ?Display_BCD
3203 D000       923            pop ar0
3205 C000       924            push ar0
3207 A850       924            mov r0, bcd+1
3209 1200C6     924            lcall ?Display_BCD
320C D000       924            pop ar0
320E C0E0       925            push acc
3210 742E       925            mov a, #'.'
3212 12007E     925            lcall ?WriteData
3215 D0E0       925            pop acc
3217 C000       926            push ar0
3219 A84F       926            mov r0, bcd+0
321B 1200C6     926            lcall ?Display_BCD
321E D000       926            pop ar0
3220            927            
3220 855E47     928            mov x + 0, Probe3_Temp+0
3223 855F48     929            mov x + 1, Probe3_Temp+1
3226 754900     930            mov x + 2, #0x00
3229 754A00     931            mov x + 3, #0x00
322C 120129     932            lcall hex2bcd           ;change hex number to bcd so it can be displayed
322F C0E0       933            push acc
3231 740A       933            mov a, #10
3233 14         933            dec a
3234 1200C1     933            lcall ?Set_Cursor_1 ; Select column and row
3237 D0E0       933            pop acc
3239 C000       934            push ar0
323B A851       934            mov r0, bcd+2
323D 1200C6     934            lcall ?Display_BCD
3240 D000       934            pop ar0
3242 C000       935            push ar0
3244 A850       935            mov r0, bcd+1
3246 1200C6     935            lcall ?Display_BCD
3249 D000       935            pop ar0
324B C0E0       936            push acc
324D 742E       936            mov a, #'.'
324F 12007E     936            lcall ?WriteData
3252 D0E0       936            pop acc
3254 C000       937            push ar0
3256 A84F       937            mov r0, bcd+0
3258 1200C6     937            lcall ?Display_BCD
325B D000       937            pop ar0
325D            938            
325D 857D47     939            mov x + 0, Calibrated_Result+0
3260 857E48     940            mov x + 1, Calibrated_Result+1
3263 754900     941            mov x + 2, #0x00
3266 754A00     942            mov x + 3, #0x00
3269 120129     943            lcall hex2bcd           ;change hex number to bcd so it can be displayed
326C C0E0       944            push acc
326E 740A       944            mov a, #10
3270 14         944            dec a
3271 1200BF     944            lcall ?Set_Cursor_2 ; Select column and row
3274 D0E0       944            pop acc
3276 C000       945            push ar0
3278 A851       945            mov r0, bcd+2
327A 1200C6     945            lcall ?Display_BCD
327D D000       945            pop ar0
327F C000       946            push ar0
3281 A850       946            mov r0, bcd+1
3283 1200C6     946            lcall ?Display_BCD
3286 D000       946            pop ar0
3288 C0E0       947            push acc
328A 742E       947            mov a, #'.'
328C 12007E     947            lcall ?WriteData
328F D0E0       947            pop acc
3291 C000       948            push ar0
3293 A84F       948            mov r0, bcd+0
3295 1200C6     948            lcall ?Display_BCD
3298 D000       948            pop ar0
329A            949   
329A 023190     950            ljmp Menu_Probes_Loop
329D            951            
329D            952            
329D            953   ;----------------------;
329D            954   ;Start_Process
329D            955   ;----------------------;
329D            956   ;when the user starts the process, this is entered.
329D            957   Start_Process:
329D C0E0       958            push acc
329F            959            ;first move the preset variables into the process variabes
329F E530       960            mov a, Current_Preset   ;determine the current preset
32A1 B40116     961            cjne a, #0x01, Loading_Preset_Start_T_Not_1
32A4 C0E0       962            push acc
32A6            962   
32A6 E533       962            mov a, Soak_Preset1_T_hex
32A8 F541       962            mov Soak_Start_T_hex, a         
32AA E53A       962            mov a, Reflow_Preset1_T_hex
32AC F542       962            mov Reflow_Start_T_hex, a       
32AE            962            
32AE E536       962            mov a, Soak_Preset1_Temp_hex
32B0 F543       962            mov Soak_Start_Temp_hex, a      
32B2 E53E       962            mov a, Reflow_Preset1_Temp_hex
32B4 F544       962            mov Reflow_Start_Temp_hex, a    
32B6            962   
32B6 D0E0       962            pop acc
32B8            962            
32B8 8032       963            sjmp Done_Loading_Preset_Start_T
32BA            964            
32BA            965   Loading_Preset_Start_T_Not_1:
32BA B40216     966            cjne a, #0x02, Loading_Preset_Start_T_Not_2
32BD C0E0       967            push acc
32BF            967   
32BF E534       967            mov a, Soak_Preset2_T_hex
32C1 F541       967            mov Soak_Start_T_hex, a         
32C3 E53B       967            mov a, Reflow_Preset2_T_hex
32C5 F542       967            mov Reflow_Start_T_hex, a       
32C7            967            
32C7 E537       967            mov a, Soak_Preset2_Temp_hex
32C9 F543       967            mov Soak_Start_Temp_hex, a      
32CB E53F       967            mov a, Reflow_Preset2_Temp_hex
32CD F544       967            mov Reflow_Start_Temp_hex, a    
32CF            967   
32CF D0E0       967            pop acc
32D1 8019       968            sjmp Done_Loading_Preset_Start_T
32D3            969            
32D3            970   Loading_Preset_Start_T_Not_2:
32D3 B40316     971            cjne a, #0x03, Loading_Preset_Start_T_Not_3
32D6 C0E0       972            push acc
32D8            972   
32D8 E535       972            mov a, Soak_Preset3_T_hex
32DA F541       972            mov Soak_Start_T_hex, a         
32DC E53C       972            mov a, Reflow_Preset3_T_hex
32DE F542       972            mov Reflow_Start_T_hex, a       
32E0            972            
32E0 E538       972            mov a, Soak_Preset3_Temp_hex
32E2 F543       972            mov Soak_Start_Temp_hex, a      
32E4 E540       972            mov a, Reflow_Preset3_Temp_hex
32E6 F544       972            mov Reflow_Start_Temp_hex, a    
32E8            972   
32E8 D0E0       972            pop acc
32EA 8000       973            sjmp Done_Loading_Preset_Start_T
32EC            974            
32EC            975   Loading_Preset_Start_T_Not_3:
32EC            976   
32EC            977            ;now the correct values have been stored in the process variables
32EC            978   Done_Loading_Preset_Start_T:
32EC C0E0       979            push acc
32EE 7401       979            mov a, #1
32F0 14         979            dec a
32F1 1200C1     979            lcall ?Set_Cursor_1 ; Select column and row
32F4 D0E0       979            pop acc
32F6 C083       980            push dph
32F8 C082       980            push dpl
32FA C0E0       980            push acc
32FC 900D1A     980            mov dptr, #CLEARLINE
32FF 1200B4     980            lcall ?Send_Constant_String
3302 D0E0       980            pop acc
3304 D082       980            pop dpl
3306 D083       980            pop dph
3308 C0E0       981            push acc
330A 7401       981            mov a, #1
330C 14         981            dec a
330D 1200BF     981            lcall ?Set_Cursor_2 ; Select column and row
3310 D0E0       981            pop acc
3312 C083       982            push dph
3314 C082       982            push dpl
3316 C0E0       982            push acc
3318 900D1A     982            mov dptr, #CLEARLINE
331B 1200B4     982            lcall ?Send_Constant_String
331E D0E0       982            pop acc
3320 D082       982            pop dpl
3322 D083       982            pop dph
3324            983            ;reset runtime timer to 0
3324 755400     984            mov BCD_counter+0,                                      #0x00
3327 755500     985            mov BCD_counter+1,                                      #0x00
332A 755600     986            mov BCD_state_counter+0,                        #0x00
332D 755700     987            mov BCD_state_counter+1,                        #0x00
3330 754501     988            mov oven_state, #0x01
3333 12353A     989            lcall Print_FSM_State_Info
3336 D21A       990            setb state1tempflag
3338 D21B       991            setb state3tempflag
333A C202       992            clr abort_flag
333C D21C       993            setb Check_Code_1
333E 123823     994            lcall Oven_FSM
3341 7900       995            mov R1, #0x00
3343            996            ;display the screen after it has switched. This stays inside the 
3343            996            ;change cursor part so it only updates when pressed, not constantly.
3343 E9         996            mov a, R1
3344 B40079     996            cjne a, #0x00, Menu_Display_not_ONE666
3347 C0E0       996            push acc
3349 7401       996            mov a, #1
334B 14         996            dec a
334C 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
334F D0E0       996            pop acc
3351 C083       996            push dph
3353 C082       996            push dpl
3355 C0E0       996            push acc
3357 900D1A     996            mov dptr, #CLEARLINE
335A 1200B4     996            lcall ?Send_Constant_String
335D D0E0       996            pop acc
335F D082       996            pop dpl
3361 D083       996            pop dph
3363 C0E0       996            push acc
3365 7401       996            mov a, #1
3367 14         996            dec a
3368 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
336B D0E0       996            pop acc
336D C083       996            push dph
336F C082       996            push dpl
3371 C0E0       996            push acc
3373 900D2B     996            mov dptr, #HomeTop1
3376 1200B4     996            lcall ?Send_Constant_String
3379 D0E0       996            pop acc
337B D082       996            pop dpl
337D D083       996            pop dph                 ;display top half, cursor >
337F            996            ;check if its required to display bottom half
337F EA         996            mov a, R2
3380 5402       996            anl a, #0x02
3382 B40238     996            cjne a, #0x02, Skip_Displaying_Bottom667
3385 C0E0       996            push acc
3387 7401       996            mov a, #1
3389 14         996            dec a
338A 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
338D D0E0       996            pop acc
338F C083       996            push dph
3391 C082       996            push dpl
3393 C0E0       996            push acc
3395 900D1A     996            mov dptr, #CLEARLINE
3398 1200B4     996            lcall ?Send_Constant_String
339B D0E0       996            pop acc
339D D082       996            pop dpl
339F D083       996            pop dph
33A1 C0E0       996            push acc
33A3 7401       996            mov a, #1
33A5 14         996            dec a
33A6 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
33A9 D0E0       996            pop acc
33AB C083       996            push dph
33AD C082       996            push dpl
33AF C0E0       996            push acc
33B1 900D80     996            mov dptr, #HomeBtm3
33B4 1200B4     996            lcall ?Send_Constant_String
33B7 D0E0       996            pop acc
33B9 D082       996            pop dpl
33BB D083       996            pop dph                 ;display bottom half no cursor
33BD            996   Skip_Displaying_Bottom667:                       
33BD 023537     996            ljmp Menu_Done_Display_Cursor_Change666         
33C0            996                    
33C0            996   Menu_Display_not_ONE666:
33C0 E9         996                    mov a, R1
33C1 B40179     996                    cjne a, #0x01, Menu_Display_not_TWO666
33C4 C0E0       996            push acc
33C6 7401       996            mov a, #1
33C8 14         996            dec a
33C9 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
33CC D0E0       996            pop acc
33CE C083       996            push dph
33D0 C082       996            push dpl
33D2 C0E0       996            push acc
33D4 900D1A     996            mov dptr, #CLEARLINE
33D7 1200B4     996            lcall ?Send_Constant_String
33DA D0E0       996            pop acc
33DC D082       996            pop dpl
33DE D083       996            pop dph
33E0 C0E0       996            push acc
33E2 7401       996            mov a, #1
33E4 14         996            dec a
33E5 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
33E8 D0E0       996            pop acc
33EA C083       996            push dph
33EC C082       996            push dpl
33EE C0E0       996            push acc
33F0 900D3C     996            mov dptr, #HomeTop2
33F3 1200B4     996            lcall ?Send_Constant_String
33F6 D0E0       996            pop acc
33F8 D082       996            pop dpl
33FA D083       996            pop dph                 ;display top half, cursor >
33FC            996            ;check if its required to display bottom half
33FC EA         996            mov a, R2
33FD 5402       996            anl a, #0x02
33FF B40238     996            cjne a, #0x02, Skip_Displaying_Bottom676
3402 C0E0       996            push acc
3404 7401       996            mov a, #1
3406 14         996            dec a
3407 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
340A D0E0       996            pop acc
340C C083       996            push dph
340E C082       996            push dpl
3410 C0E0       996            push acc
3412 900D1A     996            mov dptr, #CLEARLINE
3415 1200B4     996            lcall ?Send_Constant_String
3418 D0E0       996            pop acc
341A D082       996            pop dpl
341C D083       996            pop dph
341E C0E0       996            push acc
3420 7401       996            mov a, #1
3422 14         996            dec a
3423 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
3426 D0E0       996            pop acc
3428 C083       996            push dph
342A C082       996            push dpl
342C C0E0       996            push acc
342E 900D80     996            mov dptr, #HomeBtm3
3431 1200B4     996            lcall ?Send_Constant_String
3434 D0E0       996            pop acc
3436 D082       996            pop dpl
3438 D083       996            pop dph                 ;display bottom half no cursor
343A            996   Skip_Displaying_Bottom676:
343A 023537     996                    ljmp Menu_Done_Display_Cursor_Change666
343D            996                                    
343D            996   Menu_Display_not_TWO666:
343D E9         996                    mov a, R1
343E B40279     996                    cjne a, #0x02, Menu_Display_not_THREE666
3441 C0E0       996            push acc
3443 7401       996            mov a, #1
3445 14         996            dec a
3446 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
3449 D0E0       996            pop acc
344B C083       996            push dph
344D C082       996            push dpl
344F C0E0       996            push acc
3451 900D1A     996            mov dptr, #CLEARLINE
3454 1200B4     996            lcall ?Send_Constant_String
3457 D0E0       996            pop acc
3459 D082       996            pop dpl
345B D083       996            pop dph
345D C0E0       996            push acc
345F 7401       996            mov a, #1
3461 14         996            dec a
3462 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
3465 D0E0       996            pop acc
3467 C083       996            push dph
3469 C082       996            push dpl
346B C0E0       996            push acc
346D 900D4D     996            mov dptr, #HomeTop3
3470 1200B4     996            lcall ?Send_Constant_String
3473 D0E0       996            pop acc
3475 D082       996            pop dpl
3477 D083       996            pop dph                 ;display top half, cursor >
3479            996            ;check if its required to display bottom half
3479 EA         996            mov a, R2
347A 5402       996            anl a, #0x02
347C B40238     996            cjne a, #0x02, Skip_Displaying_Bottom685
347F C0E0       996            push acc
3481 7401       996            mov a, #1
3483 14         996            dec a
3484 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
3487 D0E0       996            pop acc
3489 C083       996            push dph
348B C082       996            push dpl
348D C0E0       996            push acc
348F 900D1A     996            mov dptr, #CLEARLINE
3492 1200B4     996            lcall ?Send_Constant_String
3495 D0E0       996            pop acc
3497 D082       996            pop dpl
3499 D083       996            pop dph
349B C0E0       996            push acc
349D 7401       996            mov a, #1
349F 14         996            dec a
34A0 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
34A3 D0E0       996            pop acc
34A5 C083       996            push dph
34A7 C082       996            push dpl
34A9 C0E0       996            push acc
34AB 900D5E     996            mov dptr, #HomeBtm1
34AE 1200B4     996            lcall ?Send_Constant_String
34B1 D0E0       996            pop acc
34B3 D082       996            pop dpl
34B5 D083       996            pop dph                 ;display bottom half no cursor
34B7            996   Skip_Displaying_Bottom685:
34B7 023537     996                    ljmp Menu_Done_Display_Cursor_Change666
34BA            996                                    
34BA            996   Menu_Display_not_THREE666:
34BA E9         996                    mov a, R1
34BB B40379     996                    cjne a, #0x03, Menu_Display_not_FOUR666
34BE C0E0       996            push acc
34C0 7401       996            mov a, #1
34C2 14         996            dec a
34C3 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
34C6 D0E0       996            pop acc
34C8 C083       996            push dph
34CA C082       996            push dpl
34CC C0E0       996            push acc
34CE 900D1A     996            mov dptr, #CLEARLINE
34D1 1200B4     996            lcall ?Send_Constant_String
34D4 D0E0       996            pop acc
34D6 D082       996            pop dpl
34D8 D083       996            pop dph
34DA C0E0       996            push acc
34DC 7401       996            mov a, #1
34DE 14         996            dec a
34DF 1200C1     996            lcall ?Set_Cursor_1 ; Select column and row
34E2 D0E0       996            pop acc
34E4 C083       996            push dph
34E6 C082       996            push dpl
34E8 C0E0       996            push acc
34EA 900D4D     996            mov dptr, #HomeTop3
34ED 1200B4     996            lcall ?Send_Constant_String
34F0 D0E0       996            pop acc
34F2 D082       996            pop dpl
34F4 D083       996            pop dph                 ;display top half, cursor >
34F6            996            ;check if its required to display bottom half
34F6 EA         996            mov a, R2
34F7 5402       996            anl a, #0x02
34F9 B40238     996            cjne a, #0x02, Skip_Displaying_Bottom694
34FC C0E0       996            push acc
34FE 7401       996            mov a, #1
3500 14         996            dec a
3501 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
3504 D0E0       996            pop acc
3506 C083       996            push dph
3508 C082       996            push dpl
350A C0E0       996            push acc
350C 900D1A     996            mov dptr, #CLEARLINE
350F 1200B4     996            lcall ?Send_Constant_String
3512 D0E0       996            pop acc
3514 D082       996            pop dpl
3516 D083       996            pop dph
3518 C0E0       996            push acc
351A 7401       996            mov a, #1
351C 14         996            dec a
351D 1200BF     996            lcall ?Set_Cursor_2 ; Select column and row
3520 D0E0       996            pop acc
3522 C083       996            push dph
3524 C082       996            push dpl
3526 C0E0       996            push acc
3528 900D6F     996            mov dptr, #HomeBtm2
352B 1200B4     996            lcall ?Send_Constant_String
352E D0E0       996            pop acc
3530 D082       996            pop dpl
3532 D083       996            pop dph                 ;display bottom half no cursor
3534            996   Skip_Displaying_Bottom694:       
3534 023537     996                    ljmp Menu_Done_Display_Cursor_Change666
3537            996                                    
3537            996   Menu_Display_not_FOUR666:
3537            996   Menu_Done_Display_Cursor_Change666:
3537 D0E0       997            pop acc
3539 22         998            ret
353A            999   
353A           1000   ;------------------------------;
353A           1001   ;Print_FSM_State_Info
353A           1002   ;------------------------------;
353A           1003   Print_FSM_State_Info:
353A           1004            ;print the name of the current state you are in.
353A 200803    1005            jb state_display_flag, Display_Diagramtp
353D 023543    1006            ljmp Print_FSM_Jump
3540           1007   Display_Diagramtp:                       ;used to get around jump limits
3540 0235FB    1008            ljmp Display_Diagram
3543           1009                    
3543           1010   Print_FSM_Jump:
3543 E545      1011            mov a, oven_state
3545 B40122    1012            cjne a, #0x01, Print_FSM_Check_S2
3548 1200F0    1013            lcall Print_FSM_Clear_Name
354B C0E0      1014            push acc
354D 7407      1014            mov a, #7
354F 14        1014            dec a
3550 1200C1    1014            lcall ?Set_Cursor_1 ; Select column and row
3553 D0E0      1014            pop acc
3555 C083      1014            push dph
3557 C082      1014            push dpl
3559 C0E0      1014            push acc
355B 900EF1    1014            mov dptr, #RampToSoak
355E 1200B4    1014            lcall ?Send_Constant_String
3561 D0E0      1014            pop acc
3563 D082      1014            pop dpl
3565 D083      1014            pop dph
3567 0236EE    1015            ljmp Print_FSM_Complete
356A           1016            
356A           1017   Print_FSM_Check_S2:
356A B40222    1018            cjne a, #0x02, Print_FSM_Check_S3
356D 1200F0    1019            lcall Print_FSM_Clear_Name
3570 C0E0      1020            push acc
3572 740D      1020            mov a, #13
3574 14        1020            dec a
3575 1200C1    1020            lcall ?Set_Cursor_1 ; Select column and row
3578 D0E0      1020            pop acc
357A C083      1020            push dph
357C C082      1020            push dpl
357E C0E0      1020            push acc
3580 900EFC    1020            mov dptr, #Soak
3583 1200B4    1020            lcall ?Send_Constant_String
3586 D0E0      1020            pop acc
3588 D082      1020            pop dpl
358A D083      1020            pop dph
358C 0236EE    1021            ljmp Print_FSM_Complete
358F           1022            
358F           1023   Print_FSM_Check_S3:
358F B40322    1024            cjne a, #0x03, Print_FSM_Check_S4
3592 1200F0    1025            lcall Print_FSM_Clear_Name
3595 C0E0      1026            push acc
3597 7407      1026            mov a, #7
3599 14        1026            dec a
359A 1200C1    1026            lcall ?Set_Cursor_1 ; Select column and row
359D D0E0      1026            pop acc
359F C083      1026            push dph
35A1 C082      1026            push dpl
35A3 C0E0      1026            push acc
35A5 900F01    1026            mov dptr, #RampToPeak
35A8 1200B4    1026            lcall ?Send_Constant_String
35AB D0E0      1026            pop acc
35AD D082      1026            pop dpl
35AF D083      1026            pop dph
35B1 0236EE    1027            ljmp Print_FSM_Complete
35B4           1028            
35B4           1029   Print_FSM_Check_S4:
35B4 B40422    1030            cjne a, #0x04, Print_FSM_Check_S5
35B7 1200F0    1031            lcall Print_FSM_Clear_Name
35BA C0E0      1032            push acc
35BC 740B      1032            mov a, #11
35BE 14        1032            dec a
35BF 1200C1    1032            lcall ?Set_Cursor_1 ; Select column and row
35C2 D0E0      1032            pop acc
35C4 C083      1032            push dph
35C6 C082      1032            push dpl
35C8 C0E0      1032            push acc
35CA 900F0C    1032            mov dptr, #Reflow
35CD 1200B4    1032            lcall ?Send_Constant_String
35D0 D0E0      1032            pop acc
35D2 D082      1032            pop dpl
35D4 D083      1032            pop dph
35D6 0236EE    1033            ljmp Print_FSM_Complete
35D9           1034            
35D9           1035   Print_FSM_Check_S5:
35D9 1200F0    1036            lcall Print_FSM_Clear_Name
35DC C0E0      1037            push acc
35DE 740A      1037            mov a, #10
35E0 14        1037            dec a
35E1 1200C1    1037            lcall ?Set_Cursor_1 ; Select column and row
35E4 D0E0      1037            pop acc
35E6 C083      1037            push dph
35E8 C082      1037            push dpl
35EA C0E0      1037            push acc
35EC 900F13    1037            mov dptr, #Cooling
35EF 1200B4    1037            lcall ?Send_Constant_String
35F2 D0E0      1037            pop acc
35F4 D082      1037            pop dpl
35F6 D083      1037            pop dph
35F8 0236EE    1038            ljmp Print_FSM_Complete
35FB           1039   
35FB           1040   ;If not displaying the name, display the position of the state
35FB           1041   Display_Diagram:
35FB 1200F0    1042            lcall Print_FSM_Clear_Name
35FE C0E0      1043            push acc
3600 740C      1043            mov a, #12
3602 14        1043            dec a
3603 1200C1    1043            lcall ?Set_Cursor_1 ; Select column and row
3606 D0E0      1043            pop acc
3608 C083      1044            push dph
360A C082      1044            push dpl
360C C0E0      1044            push acc
360E 900F1B    1044            mov dptr, #StateDiagramLayout
3611 1200B4    1044            lcall ?Send_Constant_String
3614 D0E0      1044            pop acc
3616 D082      1044            pop dpl
3618 D083      1044            pop dph
361A           1045            ;now check which state and print the corresponding position
361A 856447    1046            mov x + 0, Set_Temp
361D 754800    1047            mov x + 1, #0x00
3620 754900    1048            mov x + 2, #0x00
3623 754A00    1049            mov x + 3, #0x00
3626 120129    1050            lcall hex2bcd
3629 C0E0      1051            push acc
362B 7407      1051            mov a, #7
362D 14        1051            dec a
362E 1200C1    1051            lcall ?Set_Cursor_1 ; Select column and row
3631 D0E0      1051            pop acc
3633 C000      1052            push ar0
3635 A850      1052            mov r0, bcd+1
3637 1200C6    1052            lcall ?Display_BCD
363A D000      1052            pop ar0
363C C000      1053            push ar0
363E A84F      1053            mov r0, bcd+0
3640 1200C6    1053            lcall ?Display_BCD
3643 D000      1053            pop ar0
3645           1054            ;the above prints the desired temp beside the current temp
3645 E545      1055            mov a, oven_state
3647 B4011F    1056            cjne a, #0x01, Print_FSM_Diagram_Check_S2
364A C0E0      1057            push acc
364C 740C      1057            mov a, #12
364E 14        1057            dec a
364F 1200C1    1057            lcall ?Set_Cursor_1 ; Select column and row
3652 D0E0      1057            pop acc
3654 C083      1057            push dph
3656 C082      1057            push dpl
3658 C0E0      1057            push acc
365A 900ED6    1057            mov dptr, #o
365D 1200B4    1057            lcall ?Send_Constant_String
3660 D0E0      1057            pop acc
3662 D082      1057            pop dpl
3664 D083      1057            pop dph
3666           1057            
3666 0236EE    1058            ljmp Print_FSM_Complete
3669           1059            
3669           1060   Print_FSM_Diagram_Check_S2:
3669 B4021F    1061            cjne a, #0x02, Print_FSM_Diagram_Check_S3
366C C0E0      1062            push acc
366E 740D      1062            mov a, #13
3670 14        1062            dec a
3671 1200C1    1062            lcall ?Set_Cursor_1 ; Select column and row
3674 D0E0      1062            pop acc
3676 C083      1062            push dph
3678 C082      1062            push dpl
367A C0E0      1062            push acc
367C 900ED6    1062            mov dptr, #o
367F 1200B4    1062            lcall ?Send_Constant_String
3682 D0E0      1062            pop acc
3684 D082      1062            pop dpl
3686 D083      1062            pop dph
3688           1062            
3688 0236EE    1063            ljmp Print_FSM_Complete
368B           1064            
368B           1065   Print_FSM_Diagram_Check_S3:
368B B4031F    1066            cjne a, #0x03, Print_FSM_Diagram_Check_S4
368E C0E0      1067            push acc
3690 740E      1067            mov a, #14
3692 14        1067            dec a
3693 1200C1    1067            lcall ?Set_Cursor_1 ; Select column and row
3696 D0E0      1067            pop acc
3698 C083      1067            push dph
369A C082      1067            push dpl
369C C0E0      1067            push acc
369E 900ED6    1067            mov dptr, #o
36A1 1200B4    1067            lcall ?Send_Constant_String
36A4 D0E0      1067            pop acc
36A6 D082      1067            pop dpl
36A8 D083      1067            pop dph
36AA           1067            
36AA 0236EE    1068            ljmp Print_FSM_Complete
36AD           1069            
36AD           1070   Print_FSM_Diagram_Check_S4:
36AD B4041F    1071            cjne a, #0x04, Print_FSM_Diagram_Check_S5
36B0 C0E0      1072            push acc
36B2 740F      1072            mov a, #15
36B4 14        1072            dec a
36B5 1200C1    1072            lcall ?Set_Cursor_1 ; Select column and row
36B8 D0E0      1072            pop acc
36BA C083      1072            push dph
36BC C082      1072            push dpl
36BE C0E0      1072            push acc
36C0 900ED6    1072            mov dptr, #o
36C3 1200B4    1072            lcall ?Send_Constant_String
36C6 D0E0      1072            pop acc
36C8 D082      1072            pop dpl
36CA D083      1072            pop dph
36CC           1072            
36CC 0236EE    1073            ljmp Print_FSM_Complete
36CF           1074            
36CF           1075   Print_FSM_Diagram_Check_S5:
36CF           1076   
36CF C0E0      1077            push acc
36D1 7410      1077            mov a, #16
36D3 14        1077            dec a
36D4 1200C1    1077            lcall ?Set_Cursor_1 ; Select column and row
36D7 D0E0      1077            pop acc
36D9 C083      1077            push dph
36DB C082      1077            push dpl
36DD C0E0      1077            push acc
36DF 900ED6    1077            mov dptr, #o
36E2 1200B4    1077            lcall ?Send_Constant_String
36E5 D0E0      1077            pop acc
36E7 D082      1077            pop dpl
36E9 D083      1077            pop dph
36EB           1077            
36EB 0236EE    1078            ljmp Print_FSM_Complete
36EE           1079   Print_FSM_Complete:
36EE 22        1080            ret
36EF           1081   ;------------------------------;
36EF           1082   ;Print_FSM_Time_Info
36EF           1083   ;------------------------------; 
36EF           1084   Print_FSM_Time_Info:
36EF C0E0      1085            push acc
36F1 7401      1085            mov a, #1
36F3 14        1085            dec a
36F4 1200BF    1085            lcall ?Set_Cursor_2 ; Select column and row
36F7 D0E0      1085            pop acc
36F9           1085   
36F9 C000      1086            push ar0
36FB A855      1086            mov r0, BCD_counter+1
36FD 1200C6    1086            lcall ?Display_BCD
3700 D000      1086            pop ar0
3702 C000      1087            push ar0
3704 A854      1087            mov r0, BCD_counter+0
3706 1200C6    1087            lcall ?Display_BCD
3709 D000      1087            pop ar0
370B C0E0      1088            push acc
370D 740D      1088            mov a, #13
370F 14        1088            dec a
3710 1200BF    1088            lcall ?Set_Cursor_2 ; Select column and row
3713 D0E0      1088            pop acc
3715 C000      1089            push ar0
3717 A857      1089            mov r0, BCD_state_counter+1
3719 1200C6    1089            lcall ?Display_BCD
371C D000      1089            pop ar0
371E C000      1090            push ar0
3720 A856      1090            mov r0, BCD_state_counter+0
3722 1200C6    1090            lcall ?Display_BCD
3725 D000      1090            pop ar0
3727 22        1091            ret
3728           1092   ;------------------------------;
3728           1093   ;Print_FSM_Temp_Info
3728           1094   ;------------------------------; 
3728           1095   Print_FSM_Temp_Info:
3728           1096            
3728 856247    1097            mov x + 0, Temp+0
372B 856348    1098            mov x + 1, Temp+1
372E 754900    1099            mov x + 2, #0x00
3731 754A00    1100            mov x + 3, #0x00
3734           1101            
3734 120129    1102            lcall hex2bcd           ;change hex number to bcd so it can be displayed
3737 C0E0      1103            push acc
3739 7401      1103            mov a, #1
373B 14        1103            dec a
373C 1200C1    1103            lcall ?Set_Cursor_1 ; Select column and row
373F D0E0      1103            pop acc
3741 C000      1104            push ar0
3743 A850      1104            mov r0, bcd+1
3745 1200C6    1104            lcall ?Display_BCD
3748 D000      1104            pop ar0
374A C000      1105            push ar0
374C A84F      1105            mov r0, bcd+0
374E 1200C6    1105            lcall ?Display_BCD
3751 D000      1105            pop ar0
3753           1106   
3753 22        1107            ret
3754           1108            
3754           1109   ;------------------------------;
3754           1110   ;Check_Runtime_Errors
3754           1111   ;------------------------------;
3754           1112   Check_Runtime_Errors:
3754           1113            
3754 12375B    1114            lcall Error_Code_1
3757 123782    1115            lcall Error_Code_2
375A 22        1116            ret     
375B           1117   
375B           1118   Error_Code_1:                            ;at runtime = 50, if temp < 50 abort
375B E555      1119            mov a, BCD_counter+1
375D 75F00A    1120            mov b, #10
3760 A4        1121            mul ab
3761 FF        1122            mov R7, a
3762 E554      1123            mov a, BCD_counter+0
3764 C4        1124            swap a
3765 540F      1125            anl a, #0x0f
3767 2F        1126            add a, R7
3768 75F00A    1127            mov b, #10
376B A4        1128            mul ab
376C FF        1129            mov R7, a
376D E554      1130            mov a, BCD_counter+0
376F 540F      1131            anl a, #0x0f
3771 2F        1132            add a, R7
3772 9432      1133            subb a, #50
3774 700B      1134            jnz skip_code_1
3776 E562      1135            mov a, Temp
3778 943C      1136            subb a, #60
377A 5005      1137            jnc skip_code_1
377C D202      1138            setb abort_flag
377E 437F40    1139            orl Error_Codes, #01000000b     
3781           1140   skip_code_1:
3781 22        1141            ret
3782           1142   
3782           1143   ;        mov bcd+0, bcd_counter+0
3782           1144   ;        mov bcd+1, bcd_counter+1
3782           1145   ;        mov bcd+2, #0
3782           1146   ;        mov bcd+3, #0
3782           1147   ;        mov bcd+4, #0
3782           1148   ;        lcall bcd2hex
3782           1149   ;        mov a, x+0
3782           1150   ;        cjne a, #50, Checking_Overflow_Time
3782           1151   ;C;hecking_Overflow_Time:
3782           1152   ;        jc Less_Than_50s
3782           1153   ;        mov a, Temp
3782           1154   ;        cjne a, #60, Checking_Temp_Overflow
3782           1155   ;        ljmp Less_Than_50s
3782           1156   ;C;hecking_Temp_Overflow:
3782           1157   ;        jc ERROR_1
3782           1158   ;        ljmp Less_Than_50s
3782           1159   ;ERROR_1:
3782           1160   ;        cpl p3.6
3782           1161   ;        setb abort_flag         
3782           1162   ;        orl Error_Codes, #01000000b     
3782           1163   ;L;ess_Than_50s:
3782           1164   ;        ret
3782           1165            
3782           1166   Error_Code_2:                            ;if door not closed during runtime, abort()())()()()()()(()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()
3782           1167   ;        jnb     DoorPIN, Error_2_clear
3782           1168   ;        setb abort_flag
3782           1169   ;Error_2_clear:
3782 22        1170            ret
3783           1171            
3783           1172   ;------------------------------;
3783           1173   ;Oven_Abort_State
3783           1174   ;------------------------------;
3783           1175   Oven_Abort_State:
3783 C0E0      1176            push acc
3785 7401      1176            mov a, #1
3787 14        1176            dec a
3788 1200C1    1176            lcall ?Set_Cursor_1 ; Select column and row
378B D0E0      1176            pop acc
378D C083      1177            push dph
378F C082      1177            push dpl
3791 C0E0      1177            push acc
3793 900D1A    1177            mov dptr, #CLEARLINE
3796 1200B4    1177            lcall ?Send_Constant_String
3799 D0E0      1177            pop acc
379B D082      1177            pop dpl
379D D083      1177            pop dph
379F C0E0      1178            push acc
37A1 7401      1178            mov a, #1
37A3 14        1178            dec a
37A4 1200C1    1178            lcall ?Set_Cursor_1 ; Select column and row
37A7 D0E0      1178            pop acc
37A9 C083      1179            push dph
37AB C082      1179            push dpl
37AD C0E0      1179            push acc
37AF 900F21    1179            mov dptr, #EXITTEXTTOP
37B2 1200B4    1179            lcall ?Send_Constant_String
37B5 D0E0      1179            pop acc
37B7 D082      1179            pop dpl
37B9 D083      1179            pop dph
37BB C0E0      1180            push acc
37BD 7401      1180            mov a, #1
37BF 14        1180            dec a
37C0 1200BF    1180            lcall ?Set_Cursor_2 ; Select column and row
37C3 D0E0      1180            pop acc
37C5           1180   
37C5 C083      1181            push dph
37C7 C082      1181            push dpl
37C9 C0E0      1181            push acc
37CB 900D1A    1181            mov dptr, #CLEARLINE
37CE 1200B4    1181            lcall ?Send_Constant_String
37D1 D0E0      1181            pop acc
37D3 D082      1181            pop dpl
37D5 D083      1181            pop dph
37D7 C0E0      1182            push acc
37D9 7401      1182            mov a, #1
37DB 14        1182            dec a
37DC 1200BF    1182            lcall ?Set_Cursor_2 ; Select column and row
37DF D0E0      1182            pop acc
37E1 C083      1183            push dph
37E3 C082      1183            push dpl
37E5 C0E0      1183            push acc
37E7 900F30    1183            mov dptr, #EXITTEXTBTM
37EA 1200B4    1183            lcall ?Send_Constant_String
37ED D0E0      1183            pop acc
37EF D082      1183            pop dpl
37F1 D083      1183            pop dph
37F3 75640A    1184            mov Set_Temp, #0x0A
37F6 D214      1185            setb change_temperature_flag
37F8 754500    1186            mov oven_state, #0x00
37FB 120C95    1187            lcall Reset_Alarms
37FE C002      1188            push AR2
3800 7AFA      1188            mov R2, #250
3802 120039    1188            lcall ?Wait_Milli_Seconds
3805 D002      1188            pop AR2
3807 C002      1189            push AR2
3809 7AFA      1189            mov R2, #250
380B 120039    1189            lcall ?Wait_Milli_Seconds
380E D002      1189            pop AR2
3810 C002      1190            push AR2
3812 7AFA      1190            mov R2, #250
3814 120039    1190            lcall ?Wait_Milli_Seconds
3817 D002      1190            pop AR2
3819 C002      1191            push AR2
381B 7AFA      1191            mov R2, #250
381D 120039    1191            lcall ?Wait_Milli_Seconds
3820 D002      1191            pop AR2
3822 22        1192            ret
3823           1193   ;------------------------------;
3823           1194   ;Oven_FSM
3823           1195   ;------------------------------;
3823           1196   Oven_FSM:
3823           1197            
3823 123754    1198            lcall Check_Runtime_Errors
3826 200203    1199            jb abort_flag, Oven_Abort_Statetp
3829 02382F    1200            ljmp Oven_Abort_Statetp2
382C           1201   Oven_Abort_Statetp:
382C 023783    1202            ljmp Oven_Abort_State
382F           1203   Oven_Abort_Statetp2:                     ;above gets around maximum offset
382F           1204   
382F 1236EF    1205            lcall Print_FSM_Time_Info
3832 123728    1206            lcall Print_FSM_Temp_Info
3835           1207            
3835           1208            ;display the screen if required
3835 30090D    1209            jnb state_display_flag2, Oven_FSM_Skip_Display
3838 12353A    1210            lcall Print_FSM_State_Info
383B C209      1211            clr state_display_flag2                         ;reset flag
383D           1212   
383D           1213            ;check for remote stop
383D 300E05    1214            jnb Remote_Stop, Skip_Remote_Stop
3840 C20E      1215            clr Remote_Stop
3842 023783    1216            ljmp Oven_Abort_State
3845           1217   Skip_Remote_Stop:
3845           1218            
3845           1219   Oven_FSM_Skip_Display:
3845 E545      1220            mov a, oven_state
3847           1221            ;check if the emergency button has been pressed
3847 208212    1222            jb ESTOP, Oven_State1 ; if the 'B0' button is not pressed skip
384A C002      1223            push AR2
384C 7A32      1223            mov R2, #50
384E 120039    1223            lcall ?Wait_Milli_Seconds
3851 D002      1223            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
3853 208206    1224            jb ESTOP,Oven_State1 ; if the 'B0' button is not pressed skip
3856 3082FD    1225            jnb ESTOP, $
3859           1226            ;ESTOP pressed, jump to abort state
3859 023783    1227            ljmp Oven_Abort_State
385C           1228   
385C           1229   ;------;
385C           1230   ;state1;
385C           1231   Oven_State1:
385C           1232   
385C           1233   State1_Temp_Flag_Change_Jump:
385C B4012A    1234            cjne a, #0x01, Oven_State2
385F           1235   
385F 301A08    1236            jnb state1tempflag, State1_hop
3862 E543      1237            mov a,  Soak_Start_Temp_hex
3864 F564      1237            mov Set_Temp, a
3866 D214      1238            setb change_temperature_flag
3868 C21A      1239            clr state1tempflag
386A           1240   State1_hop:
386A           1241            
386A           1242            ;compare the desired tempurature of the state and check if we move to next state.
386A E562      1243            mov a, Temp
386C B54302    1244            cjne a, Soak_Start_Temp_hex, FSM_Check_Carry_Soak
386F           1245            ;if equal change to state 2
386F 8005      1246            sjmp State_1To2_Transition
3871           1247   FSM_Check_Carry_Soak:
3871 5003      1248            jnc State_1To2_Transition       ;if carry not set, change state
3873 023823    1249            ljmp Oven_FSM
3876           1250   State_1To2_Transition:   
3876           1251            
3876 C203      1252            clr state1_exit_flag
3878 0545      1253            INC oven_state
387A 755600    1254            mov BCD_state_counter, #0x00
387D 755700    1255            mov BCD_state_counter+1, #0x00
3880 12353A    1256            lcall Print_FSM_State_Info
3883           1257            
3883 120C71    1258            lcall Trigger_Short_Alarm
3886           1259            
3886 023823    1260            ljmp Oven_FSM
3889           1261   
3889           1262   ;------;
3889           1263   ;state2;         
3889           1264   Oven_State2:
3889 B4022E    1265            cjne a, #0x02, Oven_State3
388C           1266            
388C           1267            ;determine if the desired state time has finished
388C E557      1268            mov a, BCD_state_counter+1
388E 75F00A    1269            mov b, #10
3891 A4        1270            mul ab
3892 FF        1271            mov R7, a
3893 E556      1272            mov a, BCD_state_counter+0
3895 C4        1273            swap a
3896 540F      1274            anl a, #0x0f
3898 2F        1275            add a, R7
3899 75F00A    1276            mov b, #10
389C A4        1277            mul ab
389D FF        1278            mov R7, a
389E E556      1279            mov a, BCD_state_counter+0
38A0 540F      1280            anl a, #0x0f
38A2 2F        1281            add a, R7
38A3 B54111    1282            cjne a, Soak_Start_T_hex, Oven_FSMtp2
38A6           1283   
38A6 C204      1284            clr state2_exit_flag
38A8 754503    1285            mov oven_state, #0x03
38AB 755600    1286            mov BCD_state_counter+0, #0x00
38AE 755700    1287            mov BCD_state_counter+1, #0x00
38B1 12353A    1288            lcall Print_FSM_State_Info
38B4           1289            
38B4 120C71    1290            lcall Trigger_Short_Alarm
38B7           1291            
38B7           1292   Oven_FSMtp2:     
38B7 023823    1293            ljmp Oven_FSM
38BA           1294   ;------;
38BA           1295   ;state3;         
38BA           1296   Oven_State3:
38BA B4032E    1297            cjne a, #0x03, Oven_State4
38BD           1298            
38BD 301B08    1299            jnb state3tempflag, State3_hop  
38C0 E544      1300            mov a,  Reflow_Start_Temp_hex
38C2 F564      1300            mov Set_Temp, a
38C4 D214      1301            setb change_temperature_flag
38C6 C21B      1302            clr state3tempflag
38C8           1303   State3_hop:
38C8           1304            
38C8           1305            
38C8           1306   State3_Temp_Flag_Change_Jump:
38C8           1307   
38C8           1308            ;compare the desired tempurature of the state and check if we move to next state.
38C8 E562      1309            mov a, Temp
38CA B54402    1310            cjne a, Reflow_Start_Temp_hex, FSM_Check_Carry_Reflow
38CD           1311            ;if equal change to state 2
38CD 8005      1312            sjmp State_3To4_Transition
38CF           1313   FSM_Check_Carry_Reflow:
38CF 5003      1314            jnc State_3To4_Transition       ;if carry not set, change state
38D1 023823    1315            ljmp Oven_FSM
38D4           1316   State_3To4_Transition:   
38D4           1317            
38D4 C205      1318            clr state3_exit_flag
38D6 754504    1319            mov oven_state, #0x04
38D9 755600    1320            mov BCD_state_counter, #0x00
38DC 755700    1321            mov BCD_state_counter+1, #0x00
38DF 12353A    1322            lcall Print_FSM_State_Info
38E2           1323            
38E2 120C71    1324            lcall Trigger_Short_Alarm
38E5           1325            
38E5 023823    1326            ljmp Oven_FSM
38E8           1327   
38E8           1328   Oven_FSMtp3:
38E8 023823    1329            ljmp Oven_FSM
38EB           1330   ;------;
38EB           1331   ;state4;
38EB           1332   Oven_State4:
38EB           1333   
38EB B4042E    1334            cjne a, #0x04, Oven_State5
38EE           1335   
38EE           1336            ;determine if the desired state time has finished
38EE E557      1337            mov a, BCD_state_counter+1
38F0 75F00A    1338            mov b, #10
38F3 A4        1339            mul ab
38F4 FF        1340            mov R7, a
38F5 E556      1341            mov a, BCD_state_counter+0
38F7 C4        1342            swap a
38F8 540F      1343            anl a, #0x0f
38FA 2F        1344            add a, R7
38FB 75F00A    1345            mov b, #10
38FE A4        1346            mul ab
38FF FF        1347            mov R7, a
3900 E556      1348            mov a, BCD_state_counter+0
3902 540F      1349            anl a, #0x0f
3904 2F        1350            add a, R7
3905 B5422C    1351            cjne a, Reflow_Start_T_hex, Oven_FSMtp
3908           1352   
3908 C206      1353            clr state4_exit_flag
390A 754505    1354            mov oven_state, #0x05
390D 755600    1355            mov BCD_state_counter, #0x00
3910 755700    1356            mov BCD_state_counter+1, #0x00
3913 12353A    1357            lcall Print_FSM_State_Info
3916           1358            
3916 120C7D    1359            lcall Trigger_Long_Alarm
3919 023823    1360            ljmp Oven_FSM
391C           1361   ;------;
391C           1362   ;state5;
391C           1363   Oven_State5:
391C 75640A    1364            mov Set_Temp, #0x0A     ;set the desired temp to 0
391F D214      1365            setb change_temperature_flag
3921           1366            
3921           1367            ;compare the desired tempurature of the state and check if we move to next state.
3921 E562      1368            mov a, Temp
3923 B43C02    1369            cjne a, #60, FSM_Check_Carry_Cool
3926           1370            ;if equal change to state 2
3926 8005      1371            sjmp State_5To0_Transition
3928           1372   FSM_Check_Carry_Cool:
3928 4003      1373            jc State_5To0_Transition        ;if carry not set, change state
392A 023823    1374            ljmp Oven_FSM
392D           1375   State_5To0_Transition:   
392D 120C89    1376            lcall Trigger_Beeping_Alarm
3930 754500    1377            mov oven_state, #0
3933 22        1378            ret
3934           1379            
3934           1380   Oven_FSMtp:
3934 023823    1381            ljmp Oven_FSM
3937           1382            
3937           1383   end 
