0000              1   ;Project 1 Main-Frame
0000              2   ;Authors- Lewis Mason, 
0000              3   
                 -1   $MODLP51
0000              1   ;--------------------------------------------------------
0000              2   ; Special Function Registers
0000              3   ;--------------------------------------------------------
0000              4   ACC            DATA 0xe0
0000              5   B              DATA 0xf0
0000              6   PSW            DATA 0xd0
0000              7   SP             DATA 0x81
0000              8   SPX            DATA 0xef
0000              9   DPL            DATA 0x82
0000             10   DPH            DATA 0x83
0000             11   DPLB           DATA 0xd4
0000             12   DPHB           DATA 0xd5
0000             13   PAGE           DATA 0xf6
0000             14   AX             DATA 0xe1
0000             15   BX             DATA 0xf7
0000             16   DSPR           DATA 0xe2
0000             17   FIRD           DATA 0xe3
0000             18   MACL           DATA 0xe4
0000             19   MACH           DATA 0xe5
0000             20   PCON           DATA 0x87
0000             21   AUXR           DATA 0x8e
0000             22   AUXR1          DATA 0xa2
0000             23   DPCF           DATA 0xa1
0000             24   CKRL           DATA 0x97
0000             25   CKCKON0        DATA 0x8f
0000             26   CKCKON1        DATA 0xaf
0000             27   CKSEL          DATA 0x85
0000             28   CLKREG         DATA 0xae
0000             29   OSCCON         DATA 0x85
0000             30   IE             DATA 0xa8
0000             31   IEN0           DATA 0xa8
0000             32   IEN1           DATA 0xb1
0000             33   IPH0           DATA 0xb7
0000             34   IP             DATA 0xb8
0000             35   IPL0           DATA 0xb8
0000             36   IPH1           DATA 0xb3
0000             37   IPL1           DATA 0xb2
0000             38   P0             DATA 0x80
0000             39   P1             DATA 0x90
0000             40   P2             DATA 0xa0
0000             41   P3             DATA 0xb0
0000             42   P4             DATA 0xc0
0000             43   P0M0           DATA 0xe6
0000             44   P0M1           DATA 0xe7
0000             45   P1M0           DATA 0xd6
0000             46   P1M1           DATA 0xd7
0000             47   P2M0           DATA 0xce
0000             48   P2M1           DATA 0xcf
0000             49   P3M0           DATA 0xc6
0000             50   P3M1           DATA 0xc7
0000             51   P4M0           DATA 0xbe
0000             52   P4M1           DATA 0xbf
0000             53   SCON           DATA 0x98
0000             54   SBUF           DATA 0x99
0000             55   SADEN          DATA 0xb9
0000             56   SADDR          DATA 0xa9
0000             57   BDRCON         DATA 0x9b
0000             58   BRL            DATA 0x9a
0000             59   TCON           DATA 0x88
0000             60   TMOD           DATA 0x89
0000             61   TCONB          DATA 0x91
0000             62   TL0            DATA 0x8a
0000             63   TH0            DATA 0x8c
0000             64   TL1            DATA 0x8b
0000             65   TH1            DATA 0x8d
0000             66   RL0            DATA 0xf2
0000             67   RH0            DATA 0xf3
0000             68   RTL1           DATA 0xf4
0000             69   RH1            DATA 0xf5
0000             70   WDTRST         DATA 0xa6
0000             71   WDTPRG         DATA 0xa7
0000             72   T2CON          DATA 0xc8
0000             73   T2MOD          DATA 0xc9
0000             74   RCAP2H         DATA 0xcb
0000             75   RCAP2L         DATA 0xca
0000             76   TH2            DATA 0xcd
0000             77   TL2            DATA 0xcc
0000             78   SPCON          DATA 0xc3
0000             79   SPSTA          DATA 0xc4
0000             80   SPDAT          DATA 0xc5
0000             81   SSCON          DATA 0x93
0000             82   SSCS           DATA 0x94
0000             83   SSDAT          DATA 0x95
0000             84   SSADR          DATA 0x96
0000             85   KBLS           DATA 0x9c
0000             86   KBE            DATA 0x9d
0000             87   KBF            DATA 0x9e
0000             88   KBMOD          DATA 0x9f
0000             89   BMSEL          DATA 0x92
0000             90   FCON           DATA 0xd2
0000             91   EECON          DATA 0xd2
0000             92   ACSRA          DATA 0xa3
0000             93   ACSRB          DATA 0xab
0000             94   AREF           DATA 0xbd
0000             95   DADC           DATA 0xa4
0000             96   DADI           DATA 0xa5
0000             97   DADL           DATA 0xac
0000             98   DADH           DATA 0xad
0000             99   CCON           DATA 0xd8
0000            100   CMOD           DATA 0xd9
0000            101   CL             DATA 0xe9
0000            102   CH             DATA 0xf9
0000            103   CCAPM0         DATA 0xda
0000            104   CCAPM1         DATA 0xdb
0000            105   CCAPM2         DATA 0xdc
0000            106   CCAPM3         DATA 0xdd
0000            107   CCAPM4         DATA 0xde
0000            108   CCAP0H         DATA 0xfa
0000            109   CCAP1H         DATA 0xfb
0000            110   CCAP2H         DATA 0xfc
0000            111   CCAP3H         DATA 0xfd
0000            112   CCAP4H         DATA 0xfe
0000            113   CCAP0L         DATA 0xea
0000            114   CCAP1L         DATA 0xeb
0000            115   CCAP2L         DATA 0xec
0000            116   CCAP3L         DATA 0xed
0000            117   CCAP4L         DATA 0xee
0000            118   ;--------------------------------------------------------
0000            119   ; special function bits
0000            120   ;--------------------------------------------------------
0000            121   P              BIT 0xd0
0000            122   F1             BIT 0xd1
0000            123   OV             BIT 0xd2
0000            124   RS0            BIT 0xd3
0000            125   RS1            BIT 0xd4
0000            126   F0             BIT 0xd5
0000            127   AC             BIT 0xd6
0000            128   CY             BIT 0xd7
0000            129   EX0            BIT 0xa8
0000            130   ET0            BIT 0xa9
0000            131   EX1            BIT 0xaa
0000            132   ET1            BIT 0xab
0000            133   ES             BIT 0xac
0000            134   ET2            BIT 0xad
0000            135   EC             BIT 0xae
0000            136   EA             BIT 0xaf
0000            137   PX0            BIT 0xb8
0000            138   PT0            BIT 0xb9
0000            139   PX1            BIT 0xba
0000            140   PT1            BIT 0xbb
0000            141   PS             BIT 0xbc
0000            142   PT2            BIT 0xbd
0000            143   IP0D           BIT 0xbf
0000            144   PPCL           BIT 0xbe
0000            145   PT2L           BIT 0xbd
0000            146   PLS            BIT 0xbc
0000            147   PT1L           BIT 0xbb
0000            148   PX1L           BIT 0xba
0000            149   PT0L           BIT 0xb9
0000            150   PX0L           BIT 0xb8
0000            151   RXD            BIT 0xb0
0000            152   TXD            BIT 0xb1
0000            153   INT0           BIT 0xb2
0000            154   INT1           BIT 0xb3
0000            155   T0             BIT 0xb4
0000            156   T1             BIT 0xb5
0000            157   WR             BIT 0xb6
0000            158   RD             BIT 0xb7
0000            159   RI             BIT 0x98
0000            160   TI             BIT 0x99
0000            161   RB8            BIT 0x9a
0000            162   TB8            BIT 0x9b
0000            163   REN            BIT 0x9c
0000            164   SM2            BIT 0x9d
0000            165   SM1            BIT 0x9e
0000            166   SM0            BIT 0x9f
0000            167   IT0            BIT 0x88
0000            168   IE0            BIT 0x89
0000            169   IT1            BIT 0x8a
0000            170   IE1            BIT 0x8b
0000            171   TR0            BIT 0x8c
0000            172   TF0            BIT 0x8d
0000            173   TR1            BIT 0x8e
0000            174   TF1            BIT 0x8f
0000            175   CP_RL2         BIT 0xc8
0000            176   C_T2           BIT 0xc9
0000            177   TR2            BIT 0xca
0000            178   EXEN2          BIT 0xcb
0000            179   TCLK           BIT 0xcc
0000            180   RCLK           BIT 0xcd
0000            181   EXF2           BIT 0xce
0000            182   TF2            BIT 0xcf
0000            183   CF             BIT 0xdf
0000            184   CR             BIT 0xde
0000            185   CCF4           BIT 0xdc
0000            186   CCF3           BIT 0xdb
0000            187   CCF2           BIT 0xda
0000            188   CCF1           BIT 0xd9
0000            189   CCF0           BIT 0xd8
0000              5   
0000              6   ; Reset vector
0000              7   org 0x0000
0000 022846       8       ljmp mainprogram
0003              9   
0003             10   
0003             11   ; External interrupt 0 vector (not used in this code)
0003             12   org 0x0003
0003 32          13            reti
0004             14   
0004             15   ; Timer/Counter 0 overflow interrupt vector
000B             16   org 0x000B
000B             17            ;ljmp Timer0_ISR
000B 32          18            reti
000C             19   
000C             20   ; External interrupt 1 vector (not used in this code)
0013             21   org 0x0013
0013 32          22            reti
0014             23   
0014             24   ; Timer/Counter 1 overflow interrupt vector (not used in this code)
001B             25   org 0x001B
001B 0205A5      26            ljmp Timer1_ISR
001E             27   
001E             28   ; Serial port receive/transmit interrupt vector
0023             29   org 0x0023 
0023 020FF1      30            ljmp Serial_ISR
0026 32          31            reti
0027             32            
0027             33   ; Timer/Counter 2 overflow interrupt vector
002B             34   org 0x002B
002B 0205C1      35            ljmp Timer2_ISR
002E             36            
002E             37      ;current
002E             38    
                546   $LIST
                 46   	$LIST
0D07             48   
0D07             49   TIMER0_RELOAD_L DATA 0xf2
0D07             50   TIMER1_RELOAD_L DATA 0xf3
0D07             51   TIMER0_RELOAD_H DATA 0xf4
0D07             52   TIMER1_RELOAD_H DATA 0xf5
0D07             53   
0D07             54   CLK           EQU 22118400 ; Microcontroller system crystal frequency in Hz
0D07             55   TIMER0_RATE   EQU 500     ; 2048Hz squarewave (peak amplitude of CEM-1203 speaker)
0D07             56   TIMER0_RELOAD EQU ((65536-(CLK/TIMER0_RATE)))
0D07             57   TIMER1_RATE   EQU 4096     ; 2048Hz squarewave (peak amplitude of CEM-1203 speaker)
0D07             58   TIMER1_RELOAD EQU ((65536-(CLK/TIMER1_RATE)))
0D07             59   TIMER2_RATE   EQU 500     ; 1000Hz, for a timer tick of 1ms
0D07             60   TIMER2_RELOAD EQU ((65536-(CLK/TIMER2_RATE)))
0D07             61   
0D07             62   BAUD               equ 115200
0D07             63   BRG_VAL            equ (0x100-(CLK/(16*BAUD)))
0D07             64   ROOM_T             equ 2450
0D07             65   
0D07             66   SOUND_OUT     equ P3.7
0D07             67   
0030             68   Dseg at 30H
0030             69   Current_Preset:                          ds 1    ;1 byte to be used globally, determining the current preset
0031             70   
0031             71   Soak_Settings_T_hex:             ds 1
0032             72   Soak_Settings_Temp_hex:          ds 1
0033             73   Soak_Preset1_T_hex:              ds 1
0034             74   Soak_Preset2_T_hex:              ds 1
0035             75   Soak_Preset3_T_hex:              ds 1
0036             76   Soak_Preset1_Temp_hex:           ds 1
0037             77   Soak_Preset2_Temp_hex:           ds 1
0038             78   Soak_Preset3_Temp_hex:           ds 1
0039             79   
0039             80   Reflow_Settings_T_hex:           ds 1
003A             81   Reflow_Preset1_T_hex:            ds 1
003B             82   Reflow_Preset2_T_hex:            ds 1
003C             83   Reflow_Preset3_T_hex:            ds 1
003D             84   Reflow_Settings_Temp_hex:        ds 1
003E             85   Reflow_Preset1_Temp_hex:         ds 1
003F             86   Reflow_Preset2_Temp_hex:         ds 1
0040             87   Reflow_Preset3_Temp_hex:         ds 1
0041             88   
0041             89   ;when the process starts, the current values of temp and time settings get put into the below,
0041             90   Soak_Start_T_hex:                        ds 1
0042             91   Reflow_Start_T_hex:              ds 1
0043             92   Soak_Start_Temp_hex:             ds 1
0044             93   Reflow_Start_Temp_hex:           ds 1
0045             94   ;other variables used during runtime
0045             95   oven_state:                              ds 1    ;contains the current state of the running process
0046             96   state_flag_counter:                      ds 1    ;used to determine what is displayed for the current state on the lcd
0047             97   
0047             98   ;variables that are used for math functions
0047             99   x:                                                       ds 4
004B            100   y:                                                       ds 4    
004F            101   bcd:                                             ds 5
0054            102   BCD_counter:                             ds 2    ; The BCD counter incrememted in the ISR and displayed in the main loop
0056            103   BCD_state_counter:                       ds 2    ; The BCD counter incrememted in the ISR and displayed in the main loop
0058            104   Count1ms:                                ds 2    ; Used to determine when half second has passed
005A            105   
005A            106   Probe1_Temp:                             ds 2
005C            107   Probe2_Temp:                             ds 2
005E            108   Probe3_Temp:                             ds 2
0060            109   Room_Temp:                                       ds 2
0062            110   Temp:                                            ds 2    ; The current bitbanged-Temperature, stored as a binary number
0064            111   Set_Temp:                                        ds 1    ; The temp used to transition states
0065            112   Probe3_Temp_Sample1:             ds 2
0067            113   Probe3_Temp_Sample2:             ds 2
0069            114   Probe2_Temp_Sample1:             ds 2
006B            115   Probe2_Temp_Sample2:             ds 2
006D            116   Probe1_Temp_Sample1:             ds 2
006F            117   Probe1_Temp_Sample2:             ds 2
0071            118   ;NOTE: Put the desired tempurature into Set_Temp for any given state
0071            119   
0071            120   ;The following variables are used for serial port communication
0071            121   Count2ms:                        ds 1
0072            122   Result:                          ds 2
0074            123   upper_bound:             ds 1
0075            124   lower_bound:             ds 1
0076            125   computed_DC:             ds 1
0077            126   Duty_Cycle:              ds 1
0078            127   Width_Count:             ds 1
0079            128   Count10ms:                       ds 1
007A            129   early_stop_time:         ds 1
007B            130   early_stop_temp:         ds 1
007C            131   Door_Open_Timer:         ds 1
007D            132   
007D            133   Calibrated_Result:  ds 2
007F            134   
007F            135   
007F            136   Error_Codes:             ds 1
0080            137   
0080            138   ;Variables for alarms (being replaced by registers in register bank 1)
0080            139   ;Count_one: ds 2 ; {R1, R0}
0080            140   ;Count_two: ds 2 ; {R3, R2}
0080            141   ;Count_three: ds 2 ; {R5, R4}
0080            142   
0000            143   BSEG
0000            144   mf:                                      dbit 1
0001            145   half_seconds_flag:               dbit 1          ;Set to one in the ISR every time 500 ms had passed
0002            146   ;bits used throughout runtime
0002            147   abort_flag:                              dbit 1  ;used to flag aborting the runtime process
0003            148   state1_exit_flag:                        dbit 1  ;temperature activated flag, high when run-temp > Soak_Start_Temp_hex
0004            149   state2_exit_flag:                        dbit 1  ;time activated flag, high after state-run-time > Soak_Start_T_hex
0005            150   state3_exit_flag:                        dbit 1  ;temperature activated flag, high when run-temp > Reflow_Start_Temp_hex
0006            151   state4_exit_flag:                        dbit 1  ;time activated flag, high after state-run-time > Reflow_Start_T_hex
0007            152   state5_exit_flag:                        dbit 1  ;temperature activated flag, high when run-temp < 60
0008            153   state_display_flag:              dbit 1          ;determines what will be displayed for the state during runtime
0009            154   state_display_flag2:             dbit 1  ; a flag that is used to print the state display
000A            155   
000A            156   Probe_Flag: dbit 1
000B            157   Door_Open:                                       dbit 1
000C            158   
000C            159   
000C            160   ;The following bits are used for serial port communication
000C            161   Tx_Ready:                                        dbit 1
000D            162   Remote_Start:                            dbit 1
000E            163   Remote_Stop:                             dbit 1
000F            164   Remote_Data:                             dbit 1
0010            165   Remote_STemp:                            dbit 1
0011            166   Remote_Stime:                            dbit 1
0012            167   Remote_RTemp:                            dbit 1
0013            168   Remote_Rtime:                            dbit 1  ;a flag used to tell the program that the temp needs to be changed, as well as the duty cycle calculations
0014            169   change_temperature_flag:         dbit 1
0015            170   full_power_flag:                         dbit 1
0016            171   early_stop_flag:                         dbit 1
0017            172   PWM_flag:                                        dbit 1
0018            173   
0018            174   One_Sec:                                         dbit 1
0019            175   One_Sec2:                                        dbit 1
001A            176   
001A            177   state1tempflag:                          dbit 1
001B            178   state3tempflag:                          dbit 1
001C            179   Check_Code_1:                            dbit 1
001D            180   
001D            181   ;Flags for alarms
001D            182   flag_one: dbit 1
001E            183   flag_two: dbit 1
001F            184   flag_three: dbit 1
0020            185   
0D07            186     CSEG  
0D07            187   B0               equ     P2.6            ;the signal that increments the cursor
0D07            188   B1               equ     P2.7            ;the signal the selects the option the cursor is hovering
0D07            189   B2               equ     P2.5            ;the signal that decrements the cursor
0D07            190   B3               equ     P2.4            ;the signal that toggles settings when 
0D07            191   ;below needs to be changed
0D07            192   ESTOP    equ     P0.2
0D07            193   
0D07            194   ; These ’EQU’ must match the wiring between the microcontroller and ADC
0D07            195   CE_ADC  EQU P2.0         ;SS'
0D07            196   MY_MOSI EQU P2.1         ;MOSI
0D07            197   MY_MISO EQU P2.2         ;MISO
0D07            198   MY_SCLK EQU P2.3         ;CLK
0D07            199   ; These ’EQU’ must match the wiring between the microcontroller and LCD
0D07            200   LCD_RS   equ     P1.1
0D07            201   LCD_RW   equ     P1.2
0D07            202   LCD_E    equ     P1.3            ;this is the pin that enables the menu LCD      (clr)
0D07            203   ;LCD_SE equ              ;this is the pin that enables the status LCD    (clr)
0D07            204   LCD_D4   equ     P3.2    
0D07            205   LCD_D5   equ     P3.3
0D07            206   LCD_D6   equ     P3.4
0D07            207   
0D07            208   LCD_D7   equ     P3.5    
0D07            209   ;used for serial communication
0D07            210   P_out    equ     P0.1
0D07            211   DoorPIN equ      P0.7
0D07            212   
0D07            213   
0D07 20202020   214   CLEARLINE:       db              '                ', 0   ;used to clear the LCD
     20202020
     20202020
     20202020
     00
0D18            215   
0D18            216   ;Home display strings
0D18 53746172   217   HomeTop1:                db                      'Start<  Settings', 0
     743C2020
     53657474
     696E6773
     00
0D29 53746172   218   HomeTop2:                db                      'Start  >Settings', 0
     7420203E
     53657474
     696E6773
     00
0D3A 53746172   219   HomeTop3:                db                      'Start   Settings', 0
     74202020
     53657474
     696E6773
     00
0D4B 50726573   220   HomeBtm1:                db                      'Preset <  Probes', 0
     6574203C
     20205072
     6F626573
     00
0D5C 50726573   221   HomeBtm2:                db                      'Preset   >Probes', 0
     65742020
     203E5072
     6F626573
     00
0D6D 50726573   222   HomeBtm3:                db                      'Preset    Probes', 0
     65742020
     20205072
     6F626573
     00
0D7E            223   
0D7E            224   ;Preset select display strings
0D7E 4261636B   225   PresetTop1:              db              'Back<    Preset1', 0
     3C202020
     20507265
     73657431
     00
0D8F 4261636B   226   PresetTop2:              db              'Back    >Preset1', 0
     20202020
     3E507265
     73657431
     00
0DA0 4261636B   227   PresetTop3:              db              'Back     Preset1', 0
     20202020
     20507265
     73657431
     00
0DB1 50726573   228   PresetBtm1:              db              'Preset2< Preset3', 0
     6574323C
     20507265
     73657433
     00
0DC2 50726573   229   PresetBtm2:              db              'Preset2 >Preset3', 0
     65743220
     3E507265
     73657433
     00
0DD3 50726573   230   PresetBtm3:              db              'Preset2  Preset3', 0
     65743220
     20507265
     73657433
     00
0DE4            231   
0DE4            232   ;Settings display strings
0DE4 53617665   233   SettingsTop1:            db              'Save<      Other', 0
     3C202020
     2020204F
     74686572
     00
0DF5 53617665   234   SettingsTop2:            db              'Save      >Other', 0
     20202020
     20203E4F
     74686572
     00
0E06 53617665   235   SettingsTop3:            db              'Save       Other', 0
     20202020
     2020204F
     74686572
     00
0E17 536F616B   236   SettingsBtm1:            db              'Soak-T< Reflow-T', 0
     2D543C20
     5265666C
     6F772D54
     00
0E28 536F616B   237   SettingsBtm2:            db              'Soak-T >Reflow-T', 0
     2D54203E
     5265666C
     6F772D54
     00
0E39 536F616B   238   SettingsBtm3:            db              'Soak-T  Reflow-T', 0
     2D542020
     5265666C
     6F772D54
     00
0E4A            239   
0E4A            240   
0E4A            241   ;Other Strings
0E4A 53656C65   242   SelectPreset:            db                      'Select Preset',0
     63742050
     72657365
     7400
0E58            243   ;SaveSettingsQ1:         db                      'Save the settings?',0
0E58 43686F6F   244   SaveSettings:            db                      'Choose preset #',0
     73652070
     72657365
     74202300
0E68 746F2073   245   SaveSettings1:           db                      'to save to:',0
     61766520
     746F3A00
0E74 53657474   246   SettingsSaved:           db                      'Settings Saved',0
     696E6773
     20536176
     656400
0E83 53617665   247   SaveSettings?:           db                      'Save Settings?',0
     20536574
     74696E67
     733F00
0E92 54656D70   248   SoakSettings1:           db                      'Temp    Duration', 0
     20202020
     44757261
     74696F6E
     00
0EA3 54656D70   249   ReflowSettings1:         db                      'Temp    Duration', 0
     20202020
     44757261
     74696F6E
     00
0EB4 3C00       250   leftpoint:                       db                      '<',0
0EB6 3E00       251   rightpoint:              db                      '>',0
0EB8 2000       252   CLEARCHAR:                       db                      ' ',0
0EBA 20202020   253   CLEARHALFLINE:           db                      '        ',0
     20202020
     00
0EC3 4F00       254   o:                                       db                      'O',0
0EC5            255   
0EC5            256   ;runtime strings
0EC5 78787878   257   CurrentStateSetup:  db                   'xxxxxxxx', 0
     78787878
     00
0ECE 63636363   258   CurrentTempSetup:   db                   'ccccc', 0
     6300
0ED4 72727272   259   CurrentRTimeSetup:  db                   'rrrr', 0
     00
0ED9 74747474   260   CurrentTimeSetup:   db                   'tttt', 0
     00
0EDE            261   
0EDE            262   ;state names
0EDE 52616D70   263   RampToSoak:              db                      'RampToSoak', 0
     546F536F
     616B00
0EE9 536F616B   264   Soak:                        db                          'Soak', 0
     00
0EEE 52616D70   265   RampToPeak:              db                      'RampToPeak', 0
     546F5065
     616B00
0EF9 5265666C   266   Reflow:                      db                          'Reflow', 0
     6F7700
0F00 436F6F6C   267   Cooling:                     db                          'Cooling', 0
     696E6700
0F08 2D2D2D2D   268   StateDiagramLayout: db                   '-----', 0
     2D00
0F0E 55736572   269   EXITTEXTTOP:             db                      'User exception',0
     20657863
     65707469
     6F6E00
0F1D 41626F72   270   EXITTEXTBTM:             db                      'Aborting',0
     74696E67
     00
0F26            271   
0F26            272   ;error codes
0F26 4552524F   273   ERROR:                           db                      'ERROR', 0
     5200
0F2C            274   
0F2C            275   ;delete these later
0F2C 434F4F4C   276   COOL:                    db 'COOL',0
     00
0F31 68656174   277   HEAT:                    db 'heat',0
     00
0F36            278   
0F36 50726F62   279   ProbeTop:                db 'Probe1    Probe3',0
     65312020
     20205072
     6F626533
     00
0F47 50726F62   280   ProbeBtm:                db 'Probe2    Result',0
     65322020
     20205265
     73756C74
     00
0F58            281   
0F58            282   ;splashscreen
0F58            283   
0F58            284   
0F58            285   ;------------------------------;
0F58            286   ;Setup_System
0F58            287   ;------------------------------;
0F58            288   Setup_System:
0F58            289   ;        lcall Timer0_Init
0F58 12058E     290            lcall Timer1_Init
0F5B 1205A8     291       lcall Timer2_Init
0F5E 120399     292       lcall InitSerialPort
0F61            293       
0F61 D2AF       294       setb EA   ; Enable Global interrupts
0F63 753001     295            mov Current_Preset,                     #0x01
0F66            296            
0F66            297            ;soak initializing
0F66 753100     298            mov     Soak_Settings_T_hex,            #0x00
0F69 753200     299            mov     Soak_Settings_Temp_hex,         #0x00
0F6C 753373     300            mov     Soak_Preset1_T_hex,             #115
0F6F 75343C     301            mov     Soak_Preset2_T_hex,             #60
0F72 753578     302            mov     Soak_Preset3_T_hex,             #120
0F75 753696     303            mov     Soak_Preset1_Temp_hex,                  #150
0F78 753796     304            mov     Soak_Preset2_Temp_hex,                  #150
0F7B 753896     305            mov     Soak_Preset3_Temp_hex,                  #150
0F7E            306            ;reflow initializing
0F7E 753900     307            mov     Reflow_Settings_T_hex,          #0x00
0F81 753A4B     308            mov     Reflow_Preset1_T_hex,           #75
0F84 753B2D     309            mov     Reflow_Preset2_T_hex,           #45
0F87 753C4B     310            mov     Reflow_Preset3_T_hex,           #75
0F8A 753D00     311            mov     Reflow_Settings_Temp_hex,       #0x00
0F8D 753ED9     312            mov     Reflow_Preset1_Temp_hex,        #217
0F90 753FD9     313            mov     Reflow_Preset2_Temp_hex,        #217
0F93 7540D9     314            mov     Reflow_Preset3_Temp_hex,        #217
0F96            315            ;start of the process initializing, changes in program.
0F96 754100     316            mov     Soak_Start_T_hex,                       #0x00
0F99 754200     317            mov     Reflow_Start_T_hex,             #0x00
0F9C 754300     318            mov     Soak_Start_Temp_hex,            #0x00
0F9F 754400     319            mov     Reflow_Start_Temp_hex,                  #0x00
0FA2            320            ;initializing oven info
0FA2 C202       321            clr abort_flag
0FA4 750300     322            mov state1_exit_flag,                   #0x00
0FA7 750400     323            mov state2_exit_flag,                   #0x00
0FAA 750500     324            mov state3_exit_flag,                   #0x00
0FAD 750600     325            mov state4_exit_flag,                   #0x00
0FB0 754500     326            mov oven_state,                                 #0x00
0FB3 C209       327            clr state_display_flag2
0FB5 C208       328            clr state_display_flag
0FB7            329            ;initializing the timers
0FB7 755400     330            mov BCD_counter+0,                              #0x00
0FBA 755500     331            mov BCD_counter+1,                              #0x00
0FBD 755600     332            mov BCD_state_counter+0,                #0x00
0FC0 755700     333            mov BCD_state_counter+1,                #0x00
0FC3 75E600     334            mov P0M0, #0
0FC6 75E700     335            mov P0M1, #0
0FC9            336       ;Temp variables
0FC9 756200     337       mov Temp,                                            #0x00
0FCC 756109     338       mov Room_Temp+1,                             #high(ROOM_T)
0FCF 756092     339       mov Room_Temp+0,                             #low(ROOM_T)
0FD2 756400     340       mov Set_Temp,                                        #0x00
0FD5 D214       341       setb change_temperature_flag
0FD7            342      ; mov early_stop_bound,                       #150
0FD7 C20D       343       clr Remote_Start
0FD9 C20E       344       clr Remote_Stop
0FDB C20F       345       clr Remote_Data
0FDD            346            ; Alarm variables
0FDD D2B7       347       setb SOUND_OUT
0FDF C21D       348       clr flag_one
0FE1 C21E       349       clr flag_two
0FE3 C21F       350       clr flag_three
0FE5            351       
0FE5            352       ;mov Count_one,                              #0x00
0FE5            353       ;mov Count_two,                                      #0x00
0FE5            354       ;mov Count_three,                            #0x00
0FE5 D2D3       355       setb RS0
0FE7 E4         356       clr a
0FE8 F8         357       mov r0,                                                      a
0FE9 F9         358       mov r1,                                              a
0FEA FA         359       mov r2,                                                      a
0FEB FB         360       mov r3,                                                      a
0FEC FC         361       mov r4,                                                      a
0FED FD         362       mov r5,                                                      a
0FEE C2D3       363       clr RS0
0FF0            364    
0FF0 22         365            ret
0FF1            366            
0FF1            367   Serial_ISR:
0FF1 309905     368            jnb TI, Rx_ISR
0FF4 C299       369            clr TI
0FF6 D20C       370            setb Tx_Ready
0FF8 32         371            reti
0FF9            372   Rx_ISR:
0FF9 C298       373       clr RI
0FFB C0E0       374       push acc
0FFD C0D0       375       push psw
0FFF E599       376       mov a, SBUF
1001 200F08     377       jb Remote_Data, Take_Data
1004 1203B5     378       lcall take_instruction
1007            379   Rx_Done:
1007 D0D0       380       pop psw
1009 D0E0       381       pop acc
100B 32         382       reti
100C            383   Take_Data:
100C            384   
100C            385            ;cpl P3.6       ;debugging.
100C            386            
100C C20F       387            clr Remote_Data
100E 301007     388            jnb Remote_STemp, check_Stime
1011 F532       389            mov Soak_Settings_Temp_hex, a
1013 753300     390            mov Soak_Settings_Temp_hex+1, #0
1016 8020       391            sjmp Save_Remote_Settings
1018            392   check_Stime:
1018 301107     393            jnb Remote_Stime, check_RTemp
101B F531       394            mov Soak_Settings_T_hex, a
101D 753200     395            mov Soak_Settings_T_hex+1, #0
1020 8016       396            sjmp Save_Remote_Settings
1022            397   check_RTemp:
1022 301207     398            jnb Remote_RTemp, check_Rtime
1025 F53D       399            mov Reflow_Settings_Temp_hex, a
1027 753E00     400            mov Reflow_Settings_Temp_hex+1, #0
102A 800C       401            sjmp Save_Remote_Settings
102C            402   check_Rtime:
102C 301307     403            jnb Remote_Rtime, Rx_Error
102F F539       404            mov Reflow_Settings_T_hex, a
1031 753A00     405            mov Reflow_Settings_T_hex+1, #0
1034 8002       406            sjmp Save_Remote_Settings
1036            407   Rx_Error:
1036 80CF       408            sjmp Rx_Done
1038            409   Save_Remote_Settings:
1038 C0E0       410            push acc
103A            410            
103A E530       410            mov a, Current_Preset
103C B40117     410            cjne a, #0x01, Preset_Not_1M68
103F C0E0       410            push acc
1041            410   
1041 E531       410            mov a, Soak_Settings_T_hex
1043 F533       410            mov Soak_Preset1_T_hex, a
1045 E539       410            mov a, Reflow_Settings_T_hex
1047 F53A       410            mov Reflow_Preset1_T_hex, a
1049            410            
1049 E532       410            mov a, Soak_Settings_Temp_hex
104B F536       410            mov Soak_Preset1_Temp_hex, a
104D E53D       410            mov a, Reflow_Settings_Temp_hex
104F F53E       410            mov Reflow_Preset1_Temp_hex, a
1051            410   
1051 D0E0       410            pop acc
1053 02108A     410            ljmp Preset_Not_3M68
1056            410            
1056            410   Preset_Not_1M68:
1056 B40217     410            cjne a, #0x02, Preset_Not_2M68
1059 C0E0       410            push acc
105B            410   
105B E531       410            mov a, Soak_Settings_T_hex
105D F534       410            mov Soak_Preset2_T_hex, a
105F E539       410            mov a, Reflow_Settings_T_hex
1061 F53B       410            mov Reflow_Preset2_T_hex, a
1063            410            
1063 E532       410            mov a, Soak_Settings_Temp_hex
1065 F537       410            mov Soak_Preset2_Temp_hex, a
1067 E53D       410            mov a, Reflow_Settings_Temp_hex
1069 F53F       410            mov Reflow_Preset2_Temp_hex, a
106B            410   
106B D0E0       410            pop acc
106D 02108A     410            ljmp Preset_Not_3M68
1070            410            
1070            410   Preset_Not_2M68:
1070 B40317     410            cjne a, #0x03, Preset_Not_3M68
1073 C0E0       410            push acc
1075            410   
1075 E531       410            mov a, Soak_Settings_T_hex
1077 F535       410            mov Soak_Preset3_T_hex, a
1079 E539       410            mov a, Reflow_Settings_T_hex
107B F53C       410            mov Reflow_Preset3_T_hex, a
107D            410            
107D E532       410            mov a, Soak_Settings_Temp_hex
107F F538       410            mov Soak_Preset3_Temp_hex, a
1081 E53D       410            mov a, Reflow_Settings_Temp_hex
1083 F540       410            mov Reflow_Preset3_Temp_hex, a
1085            410   
1085 D0E0       410            pop acc
1087 02108A     410            ljmp Preset_Not_3M68
108A            410            
108A            410   Preset_Not_3M68:
108A D0E0       410            pop acc
108C 021007     411            ljmp Rx_Done
108F            412            
108F            413   ;------------------------------;
108F            414   ;functions for serial communication
108F            415   ;------------------------------;
108F            416   
108F            417   INIT_SPI:
108F D2A2       418             setb MY_MISO ; Make MISO an input pin
1091 C2A3       419             clr MY_SCLK ; For mode (0,0) SCLK is zero
1093 22         420             ret
1094            421   
1094            422   DO_SPI_G:
1094 C0E0       423             push acc
1096 7C00       424             mov R4, #0 ; Received byte stored in R1
1098 7D08       425             mov R5, #8 ; Loop counter (8-bits)
109A            426   DO_SPI_G_LOOP:
109A EB         427             mov a, R3 ; Byte to write is in R0
109B 33         428             rlc a ; Carry flag has bit to write
109C FB         429             mov R3, a
109D 92A1       430             mov MY_MOSI, c
109F D2A3       431             setb MY_SCLK ; Transmit
10A1 A2A2       432             mov c, MY_MISO ; Read received bit
10A3 EC         433             mov a, R4 ; Save received bit in R1
10A4 33         434             rlc a
10A5 FC         435             mov R4, a
10A6 C2A3       436             clr MY_SCLK
10A8 DDF0       437             djnz R5, DO_SPI_G_LOOP
10AA D0E0       438             pop acc
10AC 22         439             ret
10AD            440   
10AD            441   ; Send a character using the serial port
10AD            442   putchar:
10AD 300CFD     443       jnb Tx_Ready, putchar
10B0 C20C       444       clr Tx_Ready
10B2 F599       445       mov SBUF, a
10B4 22         446       ret
10B5            447   ; Send a constant-zero-terminated string using the serial port
10B5            448   SendString:
10B5 E4         449       clr A
10B6 93         450       movc A, @A+DPTR
10B7 6006       451       jz SendStringDone
10B9 1210AD     452       lcall putchar
10BC A3         453       inc DPTR
10BD 80F6       454       sjmp SendString
10BF            455   SendStringDone:
10BF 22         456       ret
10C0            457    
10C0            458   ;------------------------------;
10C0            459   ;Menu_Change_Cursor_Func
10C0            460   ;------------------------------;
10C0            461   ;The necessary function used to change the cursors position
10C0            462   Menu_Change_Cursor_Func:
10C0            463            ;first case to check is there are no other funcs enabled
10C0 EA         464            mov a, R2               
10C1 B40005     465            cjne a, #00000000B, Menu_NOTONE_Func_E          ;see if 1 function
10C4 7900       466            mov R1, #0x00                                                   ;reset cursor position
10C6 02110B     467            ljmp Menu_Display_LCD
10C9            468                            
10C9            469   Menu_NOTONE_Func_E:
10C9            470            ;next check if there are 1 funcs enabled
10C9 EA         471            mov a, R2
10CA B40111     472            cjne a, #0x01, Menu_NOTTWO_FUNC_E               ;see if 2 functions
10CD            473            ;now change the cursors position
10CD E9         474            mov a, R1
10CE B4FF05     475            cjne a, #0xFF, Menu_Display_Not_Dec_Bound_TWOFUNC       ; if not = to lower bout continue
10D1 7901       476            mov R1, #0x01
10D3 02110B     477            ljmp Menu_Display_LCD
10D6            478   Menu_Display_Not_Dec_Bound_TWOFUNC:      
10D6 B40232     479            cjne a, #0x02, Menu_Display_LCD         ;if not = to uper bound, continue
10D9 7900       480            mov R1, #0x00                                                   ;was = to upper bound, reset
10DB 02110B     481            ljmp Menu_Display_LCD
10DE            482                            
10DE            483   Menu_NOTTWO_FUNC_E:
10DE            484            ;next check if there are 1 funcs enabled
10DE EA         485            mov a, R2
10DF B40211     486            cjne a, #0x02, Menu_NOTTHREE_FUNC_E     ;see if 3 functions
10E2            487            ;now change the cursors position
10E2 E9         488            mov a, R1
10E3 B4FF05     489            cjne a, #0xFF, Menu_Display_Not_Dec_Bound_THREEFUNC     ; if not = to lower bout continue
10E6 7902       490            mov R1, #0x02
10E8 02110B     491            ljmp Menu_Display_LCD
10EB            492   Menu_Display_Not_Dec_Bound_THREEFUNC:
10EB B4031D     493            cjne a, #0x03, Menu_Display_LCD         ;if not = to uper bound, continue
10EE 7900       494            mov R1, #0x00                                                   ;was = to upper bound, reset
10F0 02110B     495            ljmp Menu_Display_LCD
10F3            496                            
10F3            497   Menu_NOTTHREE_FUNC_E:
10F3            498            ;next check if there are 1 funcs enabled
10F3 EA         499            mov a, R2
10F4 B40311     500            cjne a, #0x03, Menu_NOTFOUR_FUNC_E      ;see if 4 functions
10F7            501            ;now change the cursors position
10F7 E9         502            mov a, R1
10F8 B4FF05     503            cjne a, #0xFF, Menu_Display_Not_Dec_Bound_FOURFUNC      ; if not = to lower bout continue
10FB 7903       504            mov R1, #0x03
10FD 02110B     505            ljmp Menu_Display_LCD
1100            506   Menu_Display_Not_Dec_Bound_FOURFUNC:
1100 B40408     507            cjne a, #0x04, Menu_Display_LCD         ;if not = to uper bound, continue
1103 7900       508            mov R1, #0x00                                                   ;was = to upper bound, reset
1105 02110B     509            ljmp Menu_Display_LCD
1108            510                            
1108            511   Menu_NOTFOUR_FUNC_E:
1108 02110B     512            ljmp Menu_Display_LCD   
110B            513   Menu_Display_LCD:
110B 22         514            ret
110C            515            
110C            516   ;----------------------;
110C            517   ;Extra_Functions_Home
110C            518   ;----------------------;
110C            519   Extra_Functions_Home:
110C            520            ;first check what the preset is, and print it on the screen
110C C0E0       521            push acc
110E E530       522            mov a, Current_Preset
1110 B40115     523            cjne a, #0x01, Current_Preset_Not_1
1113            524            ;The current preset is 1, print 1
1113 C0E0       525            push acc
1115 7407       525            mov a, #7
1117 14         525            dec a
1118 1200BF     525            lcall ?Set_Cursor_2 ; Select column and row
111B D0E0       525            pop acc
111D C0E0       526            push acc
111F 7431       526            mov a, #'1'
1121 12007E     526            lcall ?WriteData
1124 D0E0       526            pop acc
1126 8030       527            sjmp Done_Displaying_Current_Preset
1128            528   Current_Preset_Not_1:    
1128 B40215     529            cjne a, #0x02, Current_Preset_Not_2
112B            530            ;The current preset is 2, print 2
112B C0E0       531            push acc
112D 7407       531            mov a, #7
112F 14         531            dec a
1130 1200BF     531            lcall ?Set_Cursor_2 ; Select column and row
1133 D0E0       531            pop acc
1135 C0E0       532            push acc
1137 7432       532            mov a, #'2'
1139 12007E     532            lcall ?WriteData
113C D0E0       532            pop acc
113E 8018       533            sjmp Done_Displaying_Current_Preset
1140            534   Current_Preset_Not_2:
1140 B40315     535            cjne a, #0x03, Current_Preset_Not_3
1143            536            ;The current preset is 3, print 3
1143 C0E0       537            push acc
1145 7407       537            mov a, #7
1147 14         537            dec a
1148 1200BF     537            lcall ?Set_Cursor_2 ; Select column and row
114B D0E0       537            pop acc
114D C0E0       538            push acc
114F 7433       538            mov a, #'3'
1151 12007E     538            lcall ?WriteData
1154 D0E0       538            pop acc
1156 8000       539            sjmp Done_Displaying_Current_Preset
1158            540            
1158            541   Current_Preset_Not_3:
1158            542   Done_Displaying_Current_Preset:
1158            543   
1158            544            ;check if the computer has inputted a signal
1158            545            ;if Remote_Start is high, start the process,
1158 300D05     546            jnb Remote_Start, Skip_Remote_Start
115B            547            
115B 123284     548            lcall Start_Process
115E C20D       549            clr Remote_Start
1160            550   Skip_Remote_Start:
1160            551   
1160 D0E0       552            pop acc
1162 22         553            ret
1163            554            
1163            555   ;check for error code 1
1163            556   Error_Code_1Check:
1163 120464     557            lcall clear_xy
1166 855A47     558            mov x+0, Probe1_Temp+0
1169 855B48     559            mov x+1, Probe1_Temp+1
116C 754B88     560            mov y+0, #low (5000 % 0x10000) 
116F 754C13     560            mov y+1, #high(5000 % 0x10000) 
1172 754D00     560            mov y+2, #low (5000 / 0x10000) 
1175 754E00     560            mov y+3, #high(5000 / 0x10000) 
1178 12024D     561            lcall x_gt_y
117B 300003     562            jnb mf, No_Probe1_Error
117E 437F80     563            orl Error_Codes, #10000000b
1181            564   No_Probe1_Error:
1181 855C47     565            mov x+0, Probe2_Temp+0
1184 855D48     566            mov x+1, Probe2_Temp+1
1187 12024D     567            lcall x_gt_y
118A 300003     568            jnb mf, No_Probe2_Error
118D 437F80     569            orl Error_Codes, #10000000b
1190            570   No_Probe2_Error:
1190 855E47     571            mov x+0, Probe3_Temp+0
1193 855F48     572            mov x+1, Probe3_Temp+1
1196 12024D     573            lcall x_gt_y
1199 300003     574            jnb mf, No_Probe3_Error
119C 437F80     575            orl Error_Codes, #10000000b
119F            576   No_Probe3_Error:
119F 22         577            ret
11A0            578   
11A0            579   ;--------------------------------------------;
11A0            580   ;Select_Presets and the preset functions
11A0            581   ;--------------------------------------------;
11A0            582   Select_Presets:
11A0 C000       583            push ar0
11A2 C001       583            push ar1
11A4 C002       583            push ar2
11A6 C003       583            push ar3
11A8 C004       583            push ar4
11AA C005       583            push ar5
11AC C006       583            push ar6
11AE C007       583            push ar7
11B0 C0E0       583            push acc
11B2 7800       583            mov R0, #0x00                   ;R0 is the exit flag, reset the exit flag
11B4 7900       583            mov R1, #0x00                   ;R1 is the Cursor position register
11B6 7A00       583            mov R2, #0x00                   ;R2 is the number of functions flag
11B8            583            
11B8            583            
11B8            583            ;We put the information about the functions in R2,bits 0,1,2 correspond to funcs 2,3,4
11B8 7400       583            mov a, #0x00                    ;clear a
11BA            583            ;jnb 1, Menu_No_Func_2
11BA 7401       583            mov a, #0x01
11BC B40101     583            cjne a, #0x01, Menu_No_Func_280
11BF 0A         583            inc R2
11C0            583            ;orl a, #00000001B              ;put a 1 in bit 0 to indicate FUNC 2 activated
11C0            583   Menu_No_Func_280:
11C0            583            ;jnb 1, Menu_No_Func_3
11C0 7401       583            mov a, #0x01
11C2 B40101     583            cjne a, #0x01, Menu_No_Func_380
11C5 0A         583            inc R2
11C6            583            ;orl a, #00000010B              ;put a 1 in bit 1 to indicate FUNC 3 activated
11C6            583   Menu_No_Func_380:
11C6            583            ;jnb 1, Menu_No_Func_4
11C6 7401       583            mov a, #0x01
11C8 B40101     583            cjne a, #0x01, Menu_No_Func_480
11CB 0A         583            inc R2
11CC            583            ;orl a, #00000100B              ;put a 1 in bit 2 to indicate FUNC 4 activated
11CC            583   Menu_No_Func_480:
11CC            583                                    ;put the result into R2, this indicates the #of funcs   ;sets up the function flag register
11CC            583            ;R2 is the function flag register
11CC            583            
11CC            583            ;display the screen after it has switched. This stays inside the 
11CC            583            ;change cursor part so it only updates when pressed, not constantly.
11CC E9         583            mov a, R1
11CD B40079     583            cjne a, #0x00, Menu_Display_not_ONE81
11D0 C0E0       583            push acc
11D2 7401       583            mov a, #1
11D4 14         583            dec a
11D5 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
11D8 D0E0       583            pop acc
11DA C083       583            push dph
11DC C082       583            push dpl
11DE C0E0       583            push acc
11E0 900D07     583            mov dptr, #CLEARLINE
11E3 1200B4     583            lcall ?Send_Constant_String
11E6 D0E0       583            pop acc
11E8 D082       583            pop dpl
11EA D083       583            pop dph
11EC C0E0       583            push acc
11EE 7401       583            mov a, #1
11F0 14         583            dec a
11F1 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
11F4 D0E0       583            pop acc
11F6 C083       583            push dph
11F8 C082       583            push dpl
11FA C0E0       583            push acc
11FC 900D7E     583            mov dptr, #PresetTop1
11FF 1200B4     583            lcall ?Send_Constant_String
1202 D0E0       583            pop acc
1204 D082       583            pop dpl
1206 D083       583            pop dph                 ;display top half, cursor >
1208            583            ;check if its required to display bottom half
1208 EA         583            mov a, R2
1209 5402       583            anl a, #0x02
120B B40238     583            cjne a, #0x02, Skip_Displaying_Bottom82
120E C0E0       583            push acc
1210 7401       583            mov a, #1
1212 14         583            dec a
1213 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1216 D0E0       583            pop acc
1218 C083       583            push dph
121A C082       583            push dpl
121C C0E0       583            push acc
121E 900D07     583            mov dptr, #CLEARLINE
1221 1200B4     583            lcall ?Send_Constant_String
1224 D0E0       583            pop acc
1226 D082       583            pop dpl
1228 D083       583            pop dph
122A C0E0       583            push acc
122C 7401       583            mov a, #1
122E 14         583            dec a
122F 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1232 D0E0       583            pop acc
1234 C083       583            push dph
1236 C082       583            push dpl
1238 C0E0       583            push acc
123A 900DD3     583            mov dptr, #PresetBtm3
123D 1200B4     583            lcall ?Send_Constant_String
1240 D0E0       583            pop acc
1242 D082       583            pop dpl
1244 D083       583            pop dph                 ;display bottom half no cursor
1246            583   Skip_Displaying_Bottom82:                        
1246 0213C0     583            ljmp Menu_Done_Display_Cursor_Change81  
1249            583                    
1249            583   Menu_Display_not_ONE81:
1249 E9         583                    mov a, R1
124A B40179     583                    cjne a, #0x01, Menu_Display_not_TWO81
124D C0E0       583            push acc
124F 7401       583            mov a, #1
1251 14         583            dec a
1252 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1255 D0E0       583            pop acc
1257 C083       583            push dph
1259 C082       583            push dpl
125B C0E0       583            push acc
125D 900D07     583            mov dptr, #CLEARLINE
1260 1200B4     583            lcall ?Send_Constant_String
1263 D0E0       583            pop acc
1265 D082       583            pop dpl
1267 D083       583            pop dph
1269 C0E0       583            push acc
126B 7401       583            mov a, #1
126D 14         583            dec a
126E 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1271 D0E0       583            pop acc
1273 C083       583            push dph
1275 C082       583            push dpl
1277 C0E0       583            push acc
1279 900D8F     583            mov dptr, #PresetTop2
127C 1200B4     583            lcall ?Send_Constant_String
127F D0E0       583            pop acc
1281 D082       583            pop dpl
1283 D083       583            pop dph                 ;display top half, cursor >
1285            583            ;check if its required to display bottom half
1285 EA         583            mov a, R2
1286 5402       583            anl a, #0x02
1288 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom91
128B C0E0       583            push acc
128D 7401       583            mov a, #1
128F 14         583            dec a
1290 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1293 D0E0       583            pop acc
1295 C083       583            push dph
1297 C082       583            push dpl
1299 C0E0       583            push acc
129B 900D07     583            mov dptr, #CLEARLINE
129E 1200B4     583            lcall ?Send_Constant_String
12A1 D0E0       583            pop acc
12A3 D082       583            pop dpl
12A5 D083       583            pop dph
12A7 C0E0       583            push acc
12A9 7401       583            mov a, #1
12AB 14         583            dec a
12AC 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
12AF D0E0       583            pop acc
12B1 C083       583            push dph
12B3 C082       583            push dpl
12B5 C0E0       583            push acc
12B7 900DD3     583            mov dptr, #PresetBtm3
12BA 1200B4     583            lcall ?Send_Constant_String
12BD D0E0       583            pop acc
12BF D082       583            pop dpl
12C1 D083       583            pop dph                 ;display bottom half no cursor
12C3            583   Skip_Displaying_Bottom91:
12C3 0213C0     583                    ljmp Menu_Done_Display_Cursor_Change81
12C6            583                                    
12C6            583   Menu_Display_not_TWO81:
12C6 E9         583                    mov a, R1
12C7 B40279     583                    cjne a, #0x02, Menu_Display_not_THREE81
12CA C0E0       583            push acc
12CC 7401       583            mov a, #1
12CE 14         583            dec a
12CF 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
12D2 D0E0       583            pop acc
12D4 C083       583            push dph
12D6 C082       583            push dpl
12D8 C0E0       583            push acc
12DA 900D07     583            mov dptr, #CLEARLINE
12DD 1200B4     583            lcall ?Send_Constant_String
12E0 D0E0       583            pop acc
12E2 D082       583            pop dpl
12E4 D083       583            pop dph
12E6 C0E0       583            push acc
12E8 7401       583            mov a, #1
12EA 14         583            dec a
12EB 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
12EE D0E0       583            pop acc
12F0 C083       583            push dph
12F2 C082       583            push dpl
12F4 C0E0       583            push acc
12F6 900DA0     583            mov dptr, #PresetTop3
12F9 1200B4     583            lcall ?Send_Constant_String
12FC D0E0       583            pop acc
12FE D082       583            pop dpl
1300 D083       583            pop dph                 ;display top half, cursor >
1302            583            ;check if its required to display bottom half
1302 EA         583            mov a, R2
1303 5402       583            anl a, #0x02
1305 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom100
1308 C0E0       583            push acc
130A 7401       583            mov a, #1
130C 14         583            dec a
130D 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1310 D0E0       583            pop acc
1312 C083       583            push dph
1314 C082       583            push dpl
1316 C0E0       583            push acc
1318 900D07     583            mov dptr, #CLEARLINE
131B 1200B4     583            lcall ?Send_Constant_String
131E D0E0       583            pop acc
1320 D082       583            pop dpl
1322 D083       583            pop dph
1324 C0E0       583            push acc
1326 7401       583            mov a, #1
1328 14         583            dec a
1329 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
132C D0E0       583            pop acc
132E C083       583            push dph
1330 C082       583            push dpl
1332 C0E0       583            push acc
1334 900DB1     583            mov dptr, #PresetBtm1
1337 1200B4     583            lcall ?Send_Constant_String
133A D0E0       583            pop acc
133C D082       583            pop dpl
133E D083       583            pop dph                 ;display bottom half no cursor
1340            583   Skip_Displaying_Bottom100:
1340 0213C0     583                    ljmp Menu_Done_Display_Cursor_Change81
1343            583                                    
1343            583   Menu_Display_not_THREE81:
1343 E9         583                    mov a, R1
1344 B40379     583                    cjne a, #0x03, Menu_Display_not_FOUR81
1347 C0E0       583            push acc
1349 7401       583            mov a, #1
134B 14         583            dec a
134C 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
134F D0E0       583            pop acc
1351 C083       583            push dph
1353 C082       583            push dpl
1355 C0E0       583            push acc
1357 900D07     583            mov dptr, #CLEARLINE
135A 1200B4     583            lcall ?Send_Constant_String
135D D0E0       583            pop acc
135F D082       583            pop dpl
1361 D083       583            pop dph
1363 C0E0       583            push acc
1365 7401       583            mov a, #1
1367 14         583            dec a
1368 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
136B D0E0       583            pop acc
136D C083       583            push dph
136F C082       583            push dpl
1371 C0E0       583            push acc
1373 900DA0     583            mov dptr, #PresetTop3
1376 1200B4     583            lcall ?Send_Constant_String
1379 D0E0       583            pop acc
137B D082       583            pop dpl
137D D083       583            pop dph                 ;display top half, cursor >
137F            583            ;check if its required to display bottom half
137F EA         583            mov a, R2
1380 5402       583            anl a, #0x02
1382 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom109
1385 C0E0       583            push acc
1387 7401       583            mov a, #1
1389 14         583            dec a
138A 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
138D D0E0       583            pop acc
138F C083       583            push dph
1391 C082       583            push dpl
1393 C0E0       583            push acc
1395 900D07     583            mov dptr, #CLEARLINE
1398 1200B4     583            lcall ?Send_Constant_String
139B D0E0       583            pop acc
139D D082       583            pop dpl
139F D083       583            pop dph
13A1 C0E0       583            push acc
13A3 7401       583            mov a, #1
13A5 14         583            dec a
13A6 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
13A9 D0E0       583            pop acc
13AB C083       583            push dph
13AD C082       583            push dpl
13AF C0E0       583            push acc
13B1 900DC2     583            mov dptr, #PresetBtm2
13B4 1200B4     583            lcall ?Send_Constant_String
13B7 D0E0       583            pop acc
13B9 D082       583            pop dpl
13BB D083       583            pop dph                 ;display bottom half no cursor
13BD            583   Skip_Displaying_Bottom109:       
13BD 0213C0     583                    ljmp Menu_Done_Display_Cursor_Change81
13C0            583                                    
13C0            583   Menu_Display_not_FOUR81:
13C0            583   Menu_Done_Display_Cursor_Change81:       ;display on LCD
13C0            583   
13C0            583   ;The loop that will happen over and over in each level of the menu
13C0            583   Menu_Loop79:
13C0            583   
13C0            583            ;First, Check to see if the user wants to INC the cursors location
13C0 20A614     583            jb B0, Menu_Skip_Cursor_INCtp79         ; if the 'B0' button is not pressed skip
13C3 C002       583            push AR2
13C5 7A0A       583            mov R2, #10
13C7 120039     583            lcall ?Wait_Milli_Seconds
13CA D002       583            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
13CC 20A608     583            jb B0, Menu_Skip_Cursor_INCtp79         ; if the 'B0' button is not pressed skip
13CF 30A6FD     583            jnb B0, $                               ; Wait for button release.
13D2 30A5FD     583            jnb B2, $                               ; Wait for button release.
13D5            583            ;The below code is used to get around the max jb jump distance
13D5 8003       583            sjmp Menu_INC_Cursor79
13D7            583   Menu_Skip_Cursor_INCtp79:
13D7 0215D2     583            ljmp Menu_Skip_Cursor_INC79
13DA            583   Menu_INC_Cursor79:       
13DA 09         583            INC R1                                                  ;increment the cursors position
13DB 1210C0     583            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
13DE            583            ;display the screen after it has switched. This stays inside the 
13DE            583            ;change cursor part so it only updates when pressed, not constantly.
13DE E9         583            mov a, R1
13DF B40079     583            cjne a, #0x00, Menu_Display_not_ONE119
13E2 C0E0       583            push acc
13E4 7401       583            mov a, #1
13E6 14         583            dec a
13E7 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
13EA D0E0       583            pop acc
13EC C083       583            push dph
13EE C082       583            push dpl
13F0 C0E0       583            push acc
13F2 900D07     583            mov dptr, #CLEARLINE
13F5 1200B4     583            lcall ?Send_Constant_String
13F8 D0E0       583            pop acc
13FA D082       583            pop dpl
13FC D083       583            pop dph
13FE C0E0       583            push acc
1400 7401       583            mov a, #1
1402 14         583            dec a
1403 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1406 D0E0       583            pop acc
1408 C083       583            push dph
140A C082       583            push dpl
140C C0E0       583            push acc
140E 900D7E     583            mov dptr, #PresetTop1
1411 1200B4     583            lcall ?Send_Constant_String
1414 D0E0       583            pop acc
1416 D082       583            pop dpl
1418 D083       583            pop dph                 ;display top half, cursor >
141A            583            ;check if its required to display bottom half
141A EA         583            mov a, R2
141B 5402       583            anl a, #0x02
141D B40238     583            cjne a, #0x02, Skip_Displaying_Bottom120
1420 C0E0       583            push acc
1422 7401       583            mov a, #1
1424 14         583            dec a
1425 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1428 D0E0       583            pop acc
142A C083       583            push dph
142C C082       583            push dpl
142E C0E0       583            push acc
1430 900D07     583            mov dptr, #CLEARLINE
1433 1200B4     583            lcall ?Send_Constant_String
1436 D0E0       583            pop acc
1438 D082       583            pop dpl
143A D083       583            pop dph
143C C0E0       583            push acc
143E 7401       583            mov a, #1
1440 14         583            dec a
1441 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1444 D0E0       583            pop acc
1446 C083       583            push dph
1448 C082       583            push dpl
144A C0E0       583            push acc
144C 900DD3     583            mov dptr, #PresetBtm3
144F 1200B4     583            lcall ?Send_Constant_String
1452 D0E0       583            pop acc
1454 D082       583            pop dpl
1456 D083       583            pop dph                 ;display bottom half no cursor
1458            583   Skip_Displaying_Bottom120:                       
1458 0215D2     583            ljmp Menu_Done_Display_Cursor_Change119         
145B            583                    
145B            583   Menu_Display_not_ONE119:
145B E9         583                    mov a, R1
145C B40179     583                    cjne a, #0x01, Menu_Display_not_TWO119
145F C0E0       583            push acc
1461 7401       583            mov a, #1
1463 14         583            dec a
1464 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1467 D0E0       583            pop acc
1469 C083       583            push dph
146B C082       583            push dpl
146D C0E0       583            push acc
146F 900D07     583            mov dptr, #CLEARLINE
1472 1200B4     583            lcall ?Send_Constant_String
1475 D0E0       583            pop acc
1477 D082       583            pop dpl
1479 D083       583            pop dph
147B C0E0       583            push acc
147D 7401       583            mov a, #1
147F 14         583            dec a
1480 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1483 D0E0       583            pop acc
1485 C083       583            push dph
1487 C082       583            push dpl
1489 C0E0       583            push acc
148B 900D8F     583            mov dptr, #PresetTop2
148E 1200B4     583            lcall ?Send_Constant_String
1491 D0E0       583            pop acc
1493 D082       583            pop dpl
1495 D083       583            pop dph                 ;display top half, cursor >
1497            583            ;check if its required to display bottom half
1497 EA         583            mov a, R2
1498 5402       583            anl a, #0x02
149A B40238     583            cjne a, #0x02, Skip_Displaying_Bottom129
149D C0E0       583            push acc
149F 7401       583            mov a, #1
14A1 14         583            dec a
14A2 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
14A5 D0E0       583            pop acc
14A7 C083       583            push dph
14A9 C082       583            push dpl
14AB C0E0       583            push acc
14AD 900D07     583            mov dptr, #CLEARLINE
14B0 1200B4     583            lcall ?Send_Constant_String
14B3 D0E0       583            pop acc
14B5 D082       583            pop dpl
14B7 D083       583            pop dph
14B9 C0E0       583            push acc
14BB 7401       583            mov a, #1
14BD 14         583            dec a
14BE 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
14C1 D0E0       583            pop acc
14C3 C083       583            push dph
14C5 C082       583            push dpl
14C7 C0E0       583            push acc
14C9 900DD3     583            mov dptr, #PresetBtm3
14CC 1200B4     583            lcall ?Send_Constant_String
14CF D0E0       583            pop acc
14D1 D082       583            pop dpl
14D3 D083       583            pop dph                 ;display bottom half no cursor
14D5            583   Skip_Displaying_Bottom129:
14D5 0215D2     583                    ljmp Menu_Done_Display_Cursor_Change119
14D8            583                                    
14D8            583   Menu_Display_not_TWO119:
14D8 E9         583                    mov a, R1
14D9 B40279     583                    cjne a, #0x02, Menu_Display_not_THREE119
14DC C0E0       583            push acc
14DE 7401       583            mov a, #1
14E0 14         583            dec a
14E1 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
14E4 D0E0       583            pop acc
14E6 C083       583            push dph
14E8 C082       583            push dpl
14EA C0E0       583            push acc
14EC 900D07     583            mov dptr, #CLEARLINE
14EF 1200B4     583            lcall ?Send_Constant_String
14F2 D0E0       583            pop acc
14F4 D082       583            pop dpl
14F6 D083       583            pop dph
14F8 C0E0       583            push acc
14FA 7401       583            mov a, #1
14FC 14         583            dec a
14FD 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1500 D0E0       583            pop acc
1502 C083       583            push dph
1504 C082       583            push dpl
1506 C0E0       583            push acc
1508 900DA0     583            mov dptr, #PresetTop3
150B 1200B4     583            lcall ?Send_Constant_String
150E D0E0       583            pop acc
1510 D082       583            pop dpl
1512 D083       583            pop dph                 ;display top half, cursor >
1514            583            ;check if its required to display bottom half
1514 EA         583            mov a, R2
1515 5402       583            anl a, #0x02
1517 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom138
151A C0E0       583            push acc
151C 7401       583            mov a, #1
151E 14         583            dec a
151F 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1522 D0E0       583            pop acc
1524 C083       583            push dph
1526 C082       583            push dpl
1528 C0E0       583            push acc
152A 900D07     583            mov dptr, #CLEARLINE
152D 1200B4     583            lcall ?Send_Constant_String
1530 D0E0       583            pop acc
1532 D082       583            pop dpl
1534 D083       583            pop dph
1536 C0E0       583            push acc
1538 7401       583            mov a, #1
153A 14         583            dec a
153B 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
153E D0E0       583            pop acc
1540 C083       583            push dph
1542 C082       583            push dpl
1544 C0E0       583            push acc
1546 900DB1     583            mov dptr, #PresetBtm1
1549 1200B4     583            lcall ?Send_Constant_String
154C D0E0       583            pop acc
154E D082       583            pop dpl
1550 D083       583            pop dph                 ;display bottom half no cursor
1552            583   Skip_Displaying_Bottom138:
1552 0215D2     583                    ljmp Menu_Done_Display_Cursor_Change119
1555            583                                    
1555            583   Menu_Display_not_THREE119:
1555 E9         583                    mov a, R1
1556 B40379     583                    cjne a, #0x03, Menu_Display_not_FOUR119
1559 C0E0       583            push acc
155B 7401       583            mov a, #1
155D 14         583            dec a
155E 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1561 D0E0       583            pop acc
1563 C083       583            push dph
1565 C082       583            push dpl
1567 C0E0       583            push acc
1569 900D07     583            mov dptr, #CLEARLINE
156C 1200B4     583            lcall ?Send_Constant_String
156F D0E0       583            pop acc
1571 D082       583            pop dpl
1573 D083       583            pop dph
1575 C0E0       583            push acc
1577 7401       583            mov a, #1
1579 14         583            dec a
157A 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
157D D0E0       583            pop acc
157F C083       583            push dph
1581 C082       583            push dpl
1583 C0E0       583            push acc
1585 900DA0     583            mov dptr, #PresetTop3
1588 1200B4     583            lcall ?Send_Constant_String
158B D0E0       583            pop acc
158D D082       583            pop dpl
158F D083       583            pop dph                 ;display top half, cursor >
1591            583            ;check if its required to display bottom half
1591 EA         583            mov a, R2
1592 5402       583            anl a, #0x02
1594 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom147
1597 C0E0       583            push acc
1599 7401       583            mov a, #1
159B 14         583            dec a
159C 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
159F D0E0       583            pop acc
15A1 C083       583            push dph
15A3 C082       583            push dpl
15A5 C0E0       583            push acc
15A7 900D07     583            mov dptr, #CLEARLINE
15AA 1200B4     583            lcall ?Send_Constant_String
15AD D0E0       583            pop acc
15AF D082       583            pop dpl
15B1 D083       583            pop dph
15B3 C0E0       583            push acc
15B5 7401       583            mov a, #1
15B7 14         583            dec a
15B8 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
15BB D0E0       583            pop acc
15BD C083       583            push dph
15BF C082       583            push dpl
15C1 C0E0       583            push acc
15C3 900DC2     583            mov dptr, #PresetBtm2
15C6 1200B4     583            lcall ?Send_Constant_String
15C9 D0E0       583            pop acc
15CB D082       583            pop dpl
15CD D083       583            pop dph                 ;display bottom half no cursor
15CF            583   Skip_Displaying_Bottom147:       
15CF 0215D2     583                    ljmp Menu_Done_Display_Cursor_Change119
15D2            583                                    
15D2            583   Menu_Display_not_FOUR119:
15D2            583   Menu_Done_Display_Cursor_Change119:      ;display on LCD
15D2            583            
15D2            583   Menu_Skip_Cursor_INC79:
15D2            583   
15D2            583            ;Then, Check to see if the user wants to DEC the cursors location
15D2 20A514     583            jb B2, Menu_Skip_Cursor_DECtp79         ; if the 'B0' button is not pressed skip
15D5 C002       583            push AR2
15D7 7A0A       583            mov R2, #10
15D9 120039     583            lcall ?Wait_Milli_Seconds
15DC D002       583            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
15DE 20A508     583            jb B2, Menu_Skip_Cursor_DECtp79         ; if the 'B0' button is not pressed skip
15E1 30A5FD     583            jnb B2, $                               ; Wait for button release.
15E4 30A6FD     583            jnb B0, $                               ; Wait for button release.
15E7            583            ;The below code is used to get around the max jb jump distance
15E7 8003       583            sjmp Menu_DEC_Cursor79
15E9            583   Menu_Skip_Cursor_DECtp79:
15E9 0217E4     583            ljmp Menu_Skip_Cursor_DEC79
15EC            583   Menu_DEC_Cursor79:       
15EC 19         583            DEC R1                                                  ;increment the cursors position
15ED 1210C0     583            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
15F0            583            ;display the screen after it has switched. This stays inside the 
15F0            583            ;change cursor part so it only updates when pressed, not constantly.
15F0 E9         583            mov a, R1
15F1 B40079     583            cjne a, #0x00, Menu_Display_not_ONE157
15F4 C0E0       583            push acc
15F6 7401       583            mov a, #1
15F8 14         583            dec a
15F9 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
15FC D0E0       583            pop acc
15FE C083       583            push dph
1600 C082       583            push dpl
1602 C0E0       583            push acc
1604 900D07     583            mov dptr, #CLEARLINE
1607 1200B4     583            lcall ?Send_Constant_String
160A D0E0       583            pop acc
160C D082       583            pop dpl
160E D083       583            pop dph
1610 C0E0       583            push acc
1612 7401       583            mov a, #1
1614 14         583            dec a
1615 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1618 D0E0       583            pop acc
161A C083       583            push dph
161C C082       583            push dpl
161E C0E0       583            push acc
1620 900D7E     583            mov dptr, #PresetTop1
1623 1200B4     583            lcall ?Send_Constant_String
1626 D0E0       583            pop acc
1628 D082       583            pop dpl
162A D083       583            pop dph                 ;display top half, cursor >
162C            583            ;check if its required to display bottom half
162C EA         583            mov a, R2
162D 5402       583            anl a, #0x02
162F B40238     583            cjne a, #0x02, Skip_Displaying_Bottom158
1632 C0E0       583            push acc
1634 7401       583            mov a, #1
1636 14         583            dec a
1637 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
163A D0E0       583            pop acc
163C C083       583            push dph
163E C082       583            push dpl
1640 C0E0       583            push acc
1642 900D07     583            mov dptr, #CLEARLINE
1645 1200B4     583            lcall ?Send_Constant_String
1648 D0E0       583            pop acc
164A D082       583            pop dpl
164C D083       583            pop dph
164E C0E0       583            push acc
1650 7401       583            mov a, #1
1652 14         583            dec a
1653 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1656 D0E0       583            pop acc
1658 C083       583            push dph
165A C082       583            push dpl
165C C0E0       583            push acc
165E 900DD3     583            mov dptr, #PresetBtm3
1661 1200B4     583            lcall ?Send_Constant_String
1664 D0E0       583            pop acc
1666 D082       583            pop dpl
1668 D083       583            pop dph                 ;display bottom half no cursor
166A            583   Skip_Displaying_Bottom158:                       
166A 0217E4     583            ljmp Menu_Done_Display_Cursor_Change157         
166D            583                    
166D            583   Menu_Display_not_ONE157:
166D E9         583                    mov a, R1
166E B40179     583                    cjne a, #0x01, Menu_Display_not_TWO157
1671 C0E0       583            push acc
1673 7401       583            mov a, #1
1675 14         583            dec a
1676 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1679 D0E0       583            pop acc
167B C083       583            push dph
167D C082       583            push dpl
167F C0E0       583            push acc
1681 900D07     583            mov dptr, #CLEARLINE
1684 1200B4     583            lcall ?Send_Constant_String
1687 D0E0       583            pop acc
1689 D082       583            pop dpl
168B D083       583            pop dph
168D C0E0       583            push acc
168F 7401       583            mov a, #1
1691 14         583            dec a
1692 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1695 D0E0       583            pop acc
1697 C083       583            push dph
1699 C082       583            push dpl
169B C0E0       583            push acc
169D 900D8F     583            mov dptr, #PresetTop2
16A0 1200B4     583            lcall ?Send_Constant_String
16A3 D0E0       583            pop acc
16A5 D082       583            pop dpl
16A7 D083       583            pop dph                 ;display top half, cursor >
16A9            583            ;check if its required to display bottom half
16A9 EA         583            mov a, R2
16AA 5402       583            anl a, #0x02
16AC B40238     583            cjne a, #0x02, Skip_Displaying_Bottom167
16AF C0E0       583            push acc
16B1 7401       583            mov a, #1
16B3 14         583            dec a
16B4 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
16B7 D0E0       583            pop acc
16B9 C083       583            push dph
16BB C082       583            push dpl
16BD C0E0       583            push acc
16BF 900D07     583            mov dptr, #CLEARLINE
16C2 1200B4     583            lcall ?Send_Constant_String
16C5 D0E0       583            pop acc
16C7 D082       583            pop dpl
16C9 D083       583            pop dph
16CB C0E0       583            push acc
16CD 7401       583            mov a, #1
16CF 14         583            dec a
16D0 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
16D3 D0E0       583            pop acc
16D5 C083       583            push dph
16D7 C082       583            push dpl
16D9 C0E0       583            push acc
16DB 900DD3     583            mov dptr, #PresetBtm3
16DE 1200B4     583            lcall ?Send_Constant_String
16E1 D0E0       583            pop acc
16E3 D082       583            pop dpl
16E5 D083       583            pop dph                 ;display bottom half no cursor
16E7            583   Skip_Displaying_Bottom167:
16E7 0217E4     583                    ljmp Menu_Done_Display_Cursor_Change157
16EA            583                                    
16EA            583   Menu_Display_not_TWO157:
16EA E9         583                    mov a, R1
16EB B40279     583                    cjne a, #0x02, Menu_Display_not_THREE157
16EE C0E0       583            push acc
16F0 7401       583            mov a, #1
16F2 14         583            dec a
16F3 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
16F6 D0E0       583            pop acc
16F8 C083       583            push dph
16FA C082       583            push dpl
16FC C0E0       583            push acc
16FE 900D07     583            mov dptr, #CLEARLINE
1701 1200B4     583            lcall ?Send_Constant_String
1704 D0E0       583            pop acc
1706 D082       583            pop dpl
1708 D083       583            pop dph
170A C0E0       583            push acc
170C 7401       583            mov a, #1
170E 14         583            dec a
170F 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1712 D0E0       583            pop acc
1714 C083       583            push dph
1716 C082       583            push dpl
1718 C0E0       583            push acc
171A 900DA0     583            mov dptr, #PresetTop3
171D 1200B4     583            lcall ?Send_Constant_String
1720 D0E0       583            pop acc
1722 D082       583            pop dpl
1724 D083       583            pop dph                 ;display top half, cursor >
1726            583            ;check if its required to display bottom half
1726 EA         583            mov a, R2
1727 5402       583            anl a, #0x02
1729 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom176
172C C0E0       583            push acc
172E 7401       583            mov a, #1
1730 14         583            dec a
1731 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1734 D0E0       583            pop acc
1736 C083       583            push dph
1738 C082       583            push dpl
173A C0E0       583            push acc
173C 900D07     583            mov dptr, #CLEARLINE
173F 1200B4     583            lcall ?Send_Constant_String
1742 D0E0       583            pop acc
1744 D082       583            pop dpl
1746 D083       583            pop dph
1748 C0E0       583            push acc
174A 7401       583            mov a, #1
174C 14         583            dec a
174D 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1750 D0E0       583            pop acc
1752 C083       583            push dph
1754 C082       583            push dpl
1756 C0E0       583            push acc
1758 900DB1     583            mov dptr, #PresetBtm1
175B 1200B4     583            lcall ?Send_Constant_String
175E D0E0       583            pop acc
1760 D082       583            pop dpl
1762 D083       583            pop dph                 ;display bottom half no cursor
1764            583   Skip_Displaying_Bottom176:
1764 0217E4     583                    ljmp Menu_Done_Display_Cursor_Change157
1767            583                                    
1767            583   Menu_Display_not_THREE157:
1767 E9         583                    mov a, R1
1768 B40379     583                    cjne a, #0x03, Menu_Display_not_FOUR157
176B C0E0       583            push acc
176D 7401       583            mov a, #1
176F 14         583            dec a
1770 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1773 D0E0       583            pop acc
1775 C083       583            push dph
1777 C082       583            push dpl
1779 C0E0       583            push acc
177B 900D07     583            mov dptr, #CLEARLINE
177E 1200B4     583            lcall ?Send_Constant_String
1781 D0E0       583            pop acc
1783 D082       583            pop dpl
1785 D083       583            pop dph
1787 C0E0       583            push acc
1789 7401       583            mov a, #1
178B 14         583            dec a
178C 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
178F D0E0       583            pop acc
1791 C083       583            push dph
1793 C082       583            push dpl
1795 C0E0       583            push acc
1797 900DA0     583            mov dptr, #PresetTop3
179A 1200B4     583            lcall ?Send_Constant_String
179D D0E0       583            pop acc
179F D082       583            pop dpl
17A1 D083       583            pop dph                 ;display top half, cursor >
17A3            583            ;check if its required to display bottom half
17A3 EA         583            mov a, R2
17A4 5402       583            anl a, #0x02
17A6 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom185
17A9 C0E0       583            push acc
17AB 7401       583            mov a, #1
17AD 14         583            dec a
17AE 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
17B1 D0E0       583            pop acc
17B3 C083       583            push dph
17B5 C082       583            push dpl
17B7 C0E0       583            push acc
17B9 900D07     583            mov dptr, #CLEARLINE
17BC 1200B4     583            lcall ?Send_Constant_String
17BF D0E0       583            pop acc
17C1 D082       583            pop dpl
17C3 D083       583            pop dph
17C5 C0E0       583            push acc
17C7 7401       583            mov a, #1
17C9 14         583            dec a
17CA 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
17CD D0E0       583            pop acc
17CF C083       583            push dph
17D1 C082       583            push dpl
17D3 C0E0       583            push acc
17D5 900DC2     583            mov dptr, #PresetBtm2
17D8 1200B4     583            lcall ?Send_Constant_String
17DB D0E0       583            pop acc
17DD D082       583            pop dpl
17DF D083       583            pop dph                 ;display bottom half no cursor
17E1            583   Skip_Displaying_Bottom185:       
17E1 0217E4     583                    ljmp Menu_Done_Display_Cursor_Change157
17E4            583                                    
17E4            583   Menu_Display_not_FOUR157:
17E4            583   Menu_Done_Display_Cursor_Change157:      ;display on LCD
17E4            583            
17E4            583   Menu_Skip_Cursor_DEC79:
17E4            583   
17E4            583            ;Check if the user wanted to exit the level of the menu
17E4 E8         583            mov a, R0
17E5 B40105     583            cjne a, #0x01, Menu_Stay79      ;if the flag is not 1, continue program, otherwise reset flag and return
17E8 7800       583            mov R0, #0x00
17EA 021A28     583            ljmp Menu_Exit_Level79
17ED            583            
17ED            583   Menu_Stay79:     
17ED            583            ;now the code that operates when the "select" button is pressed
17ED 20A711     583            jb B1, Menu_Skip_Select_Changetp79      ; if the 'B1' button is not pressed skip
17F0 C002       583            push AR2
17F2 7A32       583            mov R2, #50
17F4 120039     583            lcall ?Wait_Milli_Seconds
17F7 D002       583            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
17F9 20A705     583            jb B1, Menu_Skip_Select_Changetp79      ; if the 'B1' button is not pressed skip
17FC 30A7FD     583            jnb B1, $                               ; Wait for button release
17FF            583            ;The below code is used to get around the max jb jump distance 
17FF 8003       583            sjmp Menu_Select_Change79
1801            583   Menu_Skip_Select_Changetp79:
1801 021A22     583            ljmp Menu_Skip_Select_Change79  ;the button was not pressed.
1804            583            
1804            583   Menu_Select_Change79:
1804            583            
1804            583   ;We simply compare what number is in the cursor and enter that function
1804 E9         583            mov a, R1
1805 B40006     583            cjne a, #0x00, Menu_Not_Func_One_Select195
1808            583            ;if here, then the cursor is on the above position
1808 1200ED     583            lcall Menu_Back
180B 02182C     583            ljmp Menu_Done_Func195
180E            583                            
180E            583   Menu_Not_Func_One_Select195:
180E E9         583                    mov a, R1
180F B40106     583            cjne a, #0x01, Menu_Not_Func_Two_Select195
1812            583            ;if here, then the cursor is on the above position
1812 121A3B     583            lcall Preset_1
1815 02182C     583            ljmp Menu_Done_Func195
1818            583                            
1818            583   Menu_Not_Func_Two_Select195:
1818 E9         583            mov a, R1
1819 B40206     583            cjne a, #0x02, Menu_Not_Func_Three_Select195
181C            583            ;if here, then the cursor is on the above position
181C 121A41     583            lcall Preset_2
181F 02182C     583            ljmp Menu_Done_Func195
1822            583                            
1822            583   Menu_Not_Func_Three_Select195:
1822 E9         583            mov a, R1
1823 B40306     583            cjne a, #0x03, Menu_Not_Func_Four_Select195
1826            583            ;if here, then the cursor is on the above position
1826 121A47     583            lcall Preset_3
1829 02182C     583            ljmp Menu_Done_Func195
182C            583                            
182C            583   Menu_Not_Func_Four_Select195:
182C            583   
182C            583   Menu_Done_Func195:
182C            583   
182C            583            ;after selecting the function and exiting it, reset the cursor position and the screen
182C 7900       583            mov R1, #0x00
182E            583            ;display the screen after it has switched. This stays inside the 
182E            583            ;change cursor part so it only updates when pressed, not constantly.
182E E9         583            mov a, R1
182F B40079     583            cjne a, #0x00, Menu_Display_not_ONE196
1832 C0E0       583            push acc
1834 7401       583            mov a, #1
1836 14         583            dec a
1837 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
183A D0E0       583            pop acc
183C C083       583            push dph
183E C082       583            push dpl
1840 C0E0       583            push acc
1842 900D07     583            mov dptr, #CLEARLINE
1845 1200B4     583            lcall ?Send_Constant_String
1848 D0E0       583            pop acc
184A D082       583            pop dpl
184C D083       583            pop dph
184E C0E0       583            push acc
1850 7401       583            mov a, #1
1852 14         583            dec a
1853 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1856 D0E0       583            pop acc
1858 C083       583            push dph
185A C082       583            push dpl
185C C0E0       583            push acc
185E 900D7E     583            mov dptr, #PresetTop1
1861 1200B4     583            lcall ?Send_Constant_String
1864 D0E0       583            pop acc
1866 D082       583            pop dpl
1868 D083       583            pop dph                 ;display top half, cursor >
186A            583            ;check if its required to display bottom half
186A EA         583            mov a, R2
186B 5402       583            anl a, #0x02
186D B40238     583            cjne a, #0x02, Skip_Displaying_Bottom197
1870 C0E0       583            push acc
1872 7401       583            mov a, #1
1874 14         583            dec a
1875 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1878 D0E0       583            pop acc
187A C083       583            push dph
187C C082       583            push dpl
187E C0E0       583            push acc
1880 900D07     583            mov dptr, #CLEARLINE
1883 1200B4     583            lcall ?Send_Constant_String
1886 D0E0       583            pop acc
1888 D082       583            pop dpl
188A D083       583            pop dph
188C C0E0       583            push acc
188E 7401       583            mov a, #1
1890 14         583            dec a
1891 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1894 D0E0       583            pop acc
1896 C083       583            push dph
1898 C082       583            push dpl
189A C0E0       583            push acc
189C 900DD3     583            mov dptr, #PresetBtm3
189F 1200B4     583            lcall ?Send_Constant_String
18A2 D0E0       583            pop acc
18A4 D082       583            pop dpl
18A6 D083       583            pop dph                 ;display bottom half no cursor
18A8            583   Skip_Displaying_Bottom197:                       
18A8 021A22     583            ljmp Menu_Done_Display_Cursor_Change196         
18AB            583                    
18AB            583   Menu_Display_not_ONE196:
18AB E9         583                    mov a, R1
18AC B40179     583                    cjne a, #0x01, Menu_Display_not_TWO196
18AF C0E0       583            push acc
18B1 7401       583            mov a, #1
18B3 14         583            dec a
18B4 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
18B7 D0E0       583            pop acc
18B9 C083       583            push dph
18BB C082       583            push dpl
18BD C0E0       583            push acc
18BF 900D07     583            mov dptr, #CLEARLINE
18C2 1200B4     583            lcall ?Send_Constant_String
18C5 D0E0       583            pop acc
18C7 D082       583            pop dpl
18C9 D083       583            pop dph
18CB C0E0       583            push acc
18CD 7401       583            mov a, #1
18CF 14         583            dec a
18D0 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
18D3 D0E0       583            pop acc
18D5 C083       583            push dph
18D7 C082       583            push dpl
18D9 C0E0       583            push acc
18DB 900D8F     583            mov dptr, #PresetTop2
18DE 1200B4     583            lcall ?Send_Constant_String
18E1 D0E0       583            pop acc
18E3 D082       583            pop dpl
18E5 D083       583            pop dph                 ;display top half, cursor >
18E7            583            ;check if its required to display bottom half
18E7 EA         583            mov a, R2
18E8 5402       583            anl a, #0x02
18EA B40238     583            cjne a, #0x02, Skip_Displaying_Bottom206
18ED C0E0       583            push acc
18EF 7401       583            mov a, #1
18F1 14         583            dec a
18F2 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
18F5 D0E0       583            pop acc
18F7 C083       583            push dph
18F9 C082       583            push dpl
18FB C0E0       583            push acc
18FD 900D07     583            mov dptr, #CLEARLINE
1900 1200B4     583            lcall ?Send_Constant_String
1903 D0E0       583            pop acc
1905 D082       583            pop dpl
1907 D083       583            pop dph
1909 C0E0       583            push acc
190B 7401       583            mov a, #1
190D 14         583            dec a
190E 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1911 D0E0       583            pop acc
1913 C083       583            push dph
1915 C082       583            push dpl
1917 C0E0       583            push acc
1919 900DD3     583            mov dptr, #PresetBtm3
191C 1200B4     583            lcall ?Send_Constant_String
191F D0E0       583            pop acc
1921 D082       583            pop dpl
1923 D083       583            pop dph                 ;display bottom half no cursor
1925            583   Skip_Displaying_Bottom206:
1925 021A22     583                    ljmp Menu_Done_Display_Cursor_Change196
1928            583                                    
1928            583   Menu_Display_not_TWO196:
1928 E9         583                    mov a, R1
1929 B40279     583                    cjne a, #0x02, Menu_Display_not_THREE196
192C C0E0       583            push acc
192E 7401       583            mov a, #1
1930 14         583            dec a
1931 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1934 D0E0       583            pop acc
1936 C083       583            push dph
1938 C082       583            push dpl
193A C0E0       583            push acc
193C 900D07     583            mov dptr, #CLEARLINE
193F 1200B4     583            lcall ?Send_Constant_String
1942 D0E0       583            pop acc
1944 D082       583            pop dpl
1946 D083       583            pop dph
1948 C0E0       583            push acc
194A 7401       583            mov a, #1
194C 14         583            dec a
194D 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
1950 D0E0       583            pop acc
1952 C083       583            push dph
1954 C082       583            push dpl
1956 C0E0       583            push acc
1958 900DA0     583            mov dptr, #PresetTop3
195B 1200B4     583            lcall ?Send_Constant_String
195E D0E0       583            pop acc
1960 D082       583            pop dpl
1962 D083       583            pop dph                 ;display top half, cursor >
1964            583            ;check if its required to display bottom half
1964 EA         583            mov a, R2
1965 5402       583            anl a, #0x02
1967 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom215
196A C0E0       583            push acc
196C 7401       583            mov a, #1
196E 14         583            dec a
196F 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1972 D0E0       583            pop acc
1974 C083       583            push dph
1976 C082       583            push dpl
1978 C0E0       583            push acc
197A 900D07     583            mov dptr, #CLEARLINE
197D 1200B4     583            lcall ?Send_Constant_String
1980 D0E0       583            pop acc
1982 D082       583            pop dpl
1984 D083       583            pop dph
1986 C0E0       583            push acc
1988 7401       583            mov a, #1
198A 14         583            dec a
198B 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
198E D0E0       583            pop acc
1990 C083       583            push dph
1992 C082       583            push dpl
1994 C0E0       583            push acc
1996 900DB1     583            mov dptr, #PresetBtm1
1999 1200B4     583            lcall ?Send_Constant_String
199C D0E0       583            pop acc
199E D082       583            pop dpl
19A0 D083       583            pop dph                 ;display bottom half no cursor
19A2            583   Skip_Displaying_Bottom215:
19A2 021A22     583                    ljmp Menu_Done_Display_Cursor_Change196
19A5            583                                    
19A5            583   Menu_Display_not_THREE196:
19A5 E9         583                    mov a, R1
19A6 B40379     583                    cjne a, #0x03, Menu_Display_not_FOUR196
19A9 C0E0       583            push acc
19AB 7401       583            mov a, #1
19AD 14         583            dec a
19AE 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
19B1 D0E0       583            pop acc
19B3 C083       583            push dph
19B5 C082       583            push dpl
19B7 C0E0       583            push acc
19B9 900D07     583            mov dptr, #CLEARLINE
19BC 1200B4     583            lcall ?Send_Constant_String
19BF D0E0       583            pop acc
19C1 D082       583            pop dpl
19C3 D083       583            pop dph
19C5 C0E0       583            push acc
19C7 7401       583            mov a, #1
19C9 14         583            dec a
19CA 1200C1     583            lcall ?Set_Cursor_1 ; Select column and row
19CD D0E0       583            pop acc
19CF C083       583            push dph
19D1 C082       583            push dpl
19D3 C0E0       583            push acc
19D5 900DA0     583            mov dptr, #PresetTop3
19D8 1200B4     583            lcall ?Send_Constant_String
19DB D0E0       583            pop acc
19DD D082       583            pop dpl
19DF D083       583            pop dph                 ;display top half, cursor >
19E1            583            ;check if its required to display bottom half
19E1 EA         583            mov a, R2
19E2 5402       583            anl a, #0x02
19E4 B40238     583            cjne a, #0x02, Skip_Displaying_Bottom224
19E7 C0E0       583            push acc
19E9 7401       583            mov a, #1
19EB 14         583            dec a
19EC 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
19EF D0E0       583            pop acc
19F1 C083       583            push dph
19F3 C082       583            push dpl
19F5 C0E0       583            push acc
19F7 900D07     583            mov dptr, #CLEARLINE
19FA 1200B4     583            lcall ?Send_Constant_String
19FD D0E0       583            pop acc
19FF D082       583            pop dpl
1A01 D083       583            pop dph
1A03 C0E0       583            push acc
1A05 7401       583            mov a, #1
1A07 14         583            dec a
1A08 1200BF     583            lcall ?Set_Cursor_2 ; Select column and row
1A0B D0E0       583            pop acc
1A0D C083       583            push dph
1A0F C082       583            push dpl
1A11 C0E0       583            push acc
1A13 900DC2     583            mov dptr, #PresetBtm2
1A16 1200B4     583            lcall ?Send_Constant_String
1A19 D0E0       583            pop acc
1A1B D082       583            pop dpl
1A1D D083       583            pop dph                 ;display bottom half no cursor
1A1F            583   Skip_Displaying_Bottom224:       
1A1F 021A22     583                    ljmp Menu_Done_Display_Cursor_Change196
1A22            583                                    
1A22            583   Menu_Display_not_FOUR196:
1A22            583   Menu_Done_Display_Cursor_Change196:
1A22            583   
1A22            583   Menu_Skip_Select_Change79:
1A22            583            
1A22            583            ;calling the operation function, which does stuff every cycle.
1A22 1200EC     583            lcall Menu_Null
1A25 0213C0     583            ljmp Menu_Loop79
1A28            583   
1A28            583   Menu_Exit_Level79:
1A28 D0E0       583            pop acc
1A2A D007       583            pop  ar7
1A2C D006       583            pop  ar6
1A2E D005       583            pop  ar5
1A30 D004       583            pop  ar4
1A32 D003       583            pop  ar3
1A34 D002       583            pop  ar2
1A36 D001       583            pop  ar1
1A38 D000       583            pop  ar0
1A3A 22         584            ret
1A3B            585   Preset_1:
1A3B 753001     586            mov Current_Preset, #0x01
1A3E 7801       587            mov R0, #0x01
1A40 22         588            ret
1A41            589   Preset_2:
1A41 753002     590            mov Current_Preset, #0x02
1A44 7801       591            mov R0, #0x01
1A46 22         592            ret
1A47            593   Preset_3:
1A47 753003     594            mov Current_Preset, #0x03
1A4A 7801       595            mov R0, #0x01
1A4C 22         596            ret
1A4D            597            
1A4D            598   ;--------------------------------------------;
1A4D            599   ;Settings and the settings functions
1A4D            600   ;--------------------------------------------;
1A4D            601   Settings:
1A4D            602            ;when first entering this setting editor, the current preset's time and temp
1A4D            603            ;is put into the editor
1A4D C0E0       604            push acc
1A4F E530       605            mov a, Current_Preset   ;determine the current preset
1A51 B40116     606            cjne a, #0x01, Loading_Preset_T_Not_1
1A54 C0E0       607            push acc
1A56            607   
1A56 E533       607            mov a, Soak_Preset1_T_hex
1A58 F531       607            mov Soak_Settings_T_hex, a      
1A5A E53A       607            mov a, Reflow_Preset1_T_hex
1A5C F539       607            mov Reflow_Settings_T_hex, a    
1A5E            607            
1A5E E536       607            mov a, Soak_Preset1_Temp_hex
1A60 F532       607            mov Soak_Settings_Temp_hex, a   
1A62 E53E       607            mov a, Reflow_Preset1_Temp_hex
1A64 F53D       607            mov Reflow_Settings_Temp_hex, a         
1A66            607   
1A66 D0E0       607            pop acc
1A68 8032       608            sjmp Done_Loading_Preset_T
1A6A            609   Loading_Preset_T_Not_1:
1A6A B40216     610            cjne a, #0x02, Loading_Preset_T_Not_2
1A6D C0E0       611            push acc
1A6F            611   
1A6F E534       611            mov a, Soak_Preset2_T_hex
1A71 F531       611            mov Soak_Settings_T_hex, a      
1A73 E53B       611            mov a, Reflow_Preset2_T_hex
1A75 F539       611            mov Reflow_Settings_T_hex, a    
1A77            611            
1A77 E537       611            mov a, Soak_Preset2_Temp_hex
1A79 F532       611            mov Soak_Settings_Temp_hex, a   
1A7B E53F       611            mov a, Reflow_Preset2_Temp_hex
1A7D F53D       611            mov Reflow_Settings_Temp_hex, a         
1A7F            611   
1A7F D0E0       611            pop acc
1A81 8019       612            sjmp Done_Loading_Preset_T
1A83            613   Loading_Preset_T_Not_2:
1A83 B40316     614            cjne a, #0x03, Loading_Preset_T_Not_3
1A86 C0E0       615            push acc
1A88            615   
1A88 E535       615            mov a, Soak_Preset3_T_hex
1A8A F531       615            mov Soak_Settings_T_hex, a      
1A8C E53C       615            mov a, Reflow_Preset3_T_hex
1A8E F539       615            mov Reflow_Settings_T_hex, a    
1A90            615            
1A90 E538       615            mov a, Soak_Preset3_Temp_hex
1A92 F532       615            mov Soak_Settings_Temp_hex, a   
1A94 E540       615            mov a, Reflow_Preset3_Temp_hex
1A96 F53D       615            mov Reflow_Settings_Temp_hex, a         
1A98            615   
1A98 D0E0       615            pop acc
1A9A 8000       616            sjmp Done_Loading_Preset_T
1A9C            617   
1A9C            618   Loading_Preset_T_Not_3:
1A9C            619   Done_Loading_Preset_T:
1A9C D0E0       620            pop acc
1A9E C000       621            push ar0
1AA0 C001       621            push ar1
1AA2 C002       621            push ar2
1AA4 C003       621            push ar3
1AA6 C004       621            push ar4
1AA8 C005       621            push ar5
1AAA C006       621            push ar6
1AAC C007       621            push ar7
1AAE C0E0       621            push acc
1AB0 7800       621            mov R0, #0x00                   ;R0 is the exit flag, reset the exit flag
1AB2 7900       621            mov R1, #0x00                   ;R1 is the Cursor position register
1AB4 7A00       621            mov R2, #0x00                   ;R2 is the number of functions flag
1AB6            621            
1AB6            621            
1AB6            621            ;We put the information about the functions in R2,bits 0,1,2 correspond to funcs 2,3,4
1AB6 7400       621            mov a, #0x00                    ;clear a
1AB8            621            ;jnb 1, Menu_No_Func_2
1AB8 7401       621            mov a, #0x01
1ABA B40101     621            cjne a, #0x01, Menu_No_Func_2237
1ABD 0A         621            inc R2
1ABE            621            ;orl a, #00000001B              ;put a 1 in bit 0 to indicate FUNC 2 activated
1ABE            621   Menu_No_Func_2237:
1ABE            621            ;jnb 1, Menu_No_Func_3
1ABE 7401       621            mov a, #0x01
1AC0 B40101     621            cjne a, #0x01, Menu_No_Func_3237
1AC3 0A         621            inc R2
1AC4            621            ;orl a, #00000010B              ;put a 1 in bit 1 to indicate FUNC 3 activated
1AC4            621   Menu_No_Func_3237:
1AC4            621            ;jnb 1, Menu_No_Func_4
1AC4 7401       621            mov a, #0x01
1AC6 B40101     621            cjne a, #0x01, Menu_No_Func_4237
1AC9 0A         621            inc R2
1ACA            621            ;orl a, #00000100B              ;put a 1 in bit 2 to indicate FUNC 4 activated
1ACA            621   Menu_No_Func_4237:
1ACA            621                                    ;put the result into R2, this indicates the #of funcs
1ACA            621                    ;sets up the function flag register
1ACA            621            ;R2 is the function flag register
1ACA            621            
1ACA            621            ;display the screen after it has switched. This stays inside the 
1ACA            621            ;change cursor part so it only updates when pressed, not constantly.
1ACA E9         621            mov a, R1
1ACB B40079     621            cjne a, #0x00, Menu_Display_not_ONE238
1ACE C0E0       621            push acc
1AD0 7401       621            mov a, #1
1AD2 14         621            dec a
1AD3 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1AD6 D0E0       621            pop acc
1AD8 C083       621            push dph
1ADA C082       621            push dpl
1ADC C0E0       621            push acc
1ADE 900D07     621            mov dptr, #CLEARLINE
1AE1 1200B4     621            lcall ?Send_Constant_String
1AE4 D0E0       621            pop acc
1AE6 D082       621            pop dpl
1AE8 D083       621            pop dph
1AEA C0E0       621            push acc
1AEC 7401       621            mov a, #1
1AEE 14         621            dec a
1AEF 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1AF2 D0E0       621            pop acc
1AF4 C083       621            push dph
1AF6 C082       621            push dpl
1AF8 C0E0       621            push acc
1AFA 900DE4     621            mov dptr, #SettingsTop1
1AFD 1200B4     621            lcall ?Send_Constant_String
1B00 D0E0       621            pop acc
1B02 D082       621            pop dpl
1B04 D083       621            pop dph                 ;display top half, cursor >
1B06            621            ;check if its required to display bottom half
1B06 EA         621            mov a, R2
1B07 5402       621            anl a, #0x02
1B09 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom239
1B0C C0E0       621            push acc
1B0E 7401       621            mov a, #1
1B10 14         621            dec a
1B11 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1B14 D0E0       621            pop acc
1B16 C083       621            push dph
1B18 C082       621            push dpl
1B1A C0E0       621            push acc
1B1C 900D07     621            mov dptr, #CLEARLINE
1B1F 1200B4     621            lcall ?Send_Constant_String
1B22 D0E0       621            pop acc
1B24 D082       621            pop dpl
1B26 D083       621            pop dph
1B28 C0E0       621            push acc
1B2A 7401       621            mov a, #1
1B2C 14         621            dec a
1B2D 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1B30 D0E0       621            pop acc
1B32 C083       621            push dph
1B34 C082       621            push dpl
1B36 C0E0       621            push acc
1B38 900E39     621            mov dptr, #SettingsBtm3
1B3B 1200B4     621            lcall ?Send_Constant_String
1B3E D0E0       621            pop acc
1B40 D082       621            pop dpl
1B42 D083       621            pop dph                 ;display bottom half no cursor
1B44            621   Skip_Displaying_Bottom239:                       
1B44 021CBE     621            ljmp Menu_Done_Display_Cursor_Change238         
1B47            621                    
1B47            621   Menu_Display_not_ONE238:
1B47 E9         621                    mov a, R1
1B48 B40179     621                    cjne a, #0x01, Menu_Display_not_TWO238
1B4B C0E0       621            push acc
1B4D 7401       621            mov a, #1
1B4F 14         621            dec a
1B50 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1B53 D0E0       621            pop acc
1B55 C083       621            push dph
1B57 C082       621            push dpl
1B59 C0E0       621            push acc
1B5B 900D07     621            mov dptr, #CLEARLINE
1B5E 1200B4     621            lcall ?Send_Constant_String
1B61 D0E0       621            pop acc
1B63 D082       621            pop dpl
1B65 D083       621            pop dph
1B67 C0E0       621            push acc
1B69 7401       621            mov a, #1
1B6B 14         621            dec a
1B6C 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1B6F D0E0       621            pop acc
1B71 C083       621            push dph
1B73 C082       621            push dpl
1B75 C0E0       621            push acc
1B77 900DF5     621            mov dptr, #SettingsTop2
1B7A 1200B4     621            lcall ?Send_Constant_String
1B7D D0E0       621            pop acc
1B7F D082       621            pop dpl
1B81 D083       621            pop dph                 ;display top half, cursor >
1B83            621            ;check if its required to display bottom half
1B83 EA         621            mov a, R2
1B84 5402       621            anl a, #0x02
1B86 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom248
1B89 C0E0       621            push acc
1B8B 7401       621            mov a, #1
1B8D 14         621            dec a
1B8E 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1B91 D0E0       621            pop acc
1B93 C083       621            push dph
1B95 C082       621            push dpl
1B97 C0E0       621            push acc
1B99 900D07     621            mov dptr, #CLEARLINE
1B9C 1200B4     621            lcall ?Send_Constant_String
1B9F D0E0       621            pop acc
1BA1 D082       621            pop dpl
1BA3 D083       621            pop dph
1BA5 C0E0       621            push acc
1BA7 7401       621            mov a, #1
1BA9 14         621            dec a
1BAA 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1BAD D0E0       621            pop acc
1BAF C083       621            push dph
1BB1 C082       621            push dpl
1BB3 C0E0       621            push acc
1BB5 900E39     621            mov dptr, #SettingsBtm3
1BB8 1200B4     621            lcall ?Send_Constant_String
1BBB D0E0       621            pop acc
1BBD D082       621            pop dpl
1BBF D083       621            pop dph                 ;display bottom half no cursor
1BC1            621   Skip_Displaying_Bottom248:
1BC1 021CBE     621                    ljmp Menu_Done_Display_Cursor_Change238
1BC4            621                                    
1BC4            621   Menu_Display_not_TWO238:
1BC4 E9         621                    mov a, R1
1BC5 B40279     621                    cjne a, #0x02, Menu_Display_not_THREE238
1BC8 C0E0       621            push acc
1BCA 7401       621            mov a, #1
1BCC 14         621            dec a
1BCD 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1BD0 D0E0       621            pop acc
1BD2 C083       621            push dph
1BD4 C082       621            push dpl
1BD6 C0E0       621            push acc
1BD8 900D07     621            mov dptr, #CLEARLINE
1BDB 1200B4     621            lcall ?Send_Constant_String
1BDE D0E0       621            pop acc
1BE0 D082       621            pop dpl
1BE2 D083       621            pop dph
1BE4 C0E0       621            push acc
1BE6 7401       621            mov a, #1
1BE8 14         621            dec a
1BE9 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1BEC D0E0       621            pop acc
1BEE C083       621            push dph
1BF0 C082       621            push dpl
1BF2 C0E0       621            push acc
1BF4 900E06     621            mov dptr, #SettingsTop3
1BF7 1200B4     621            lcall ?Send_Constant_String
1BFA D0E0       621            pop acc
1BFC D082       621            pop dpl
1BFE D083       621            pop dph                 ;display top half, cursor >
1C00            621            ;check if its required to display bottom half
1C00 EA         621            mov a, R2
1C01 5402       621            anl a, #0x02
1C03 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom257
1C06 C0E0       621            push acc
1C08 7401       621            mov a, #1
1C0A 14         621            dec a
1C0B 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1C0E D0E0       621            pop acc
1C10 C083       621            push dph
1C12 C082       621            push dpl
1C14 C0E0       621            push acc
1C16 900D07     621            mov dptr, #CLEARLINE
1C19 1200B4     621            lcall ?Send_Constant_String
1C1C D0E0       621            pop acc
1C1E D082       621            pop dpl
1C20 D083       621            pop dph
1C22 C0E0       621            push acc
1C24 7401       621            mov a, #1
1C26 14         621            dec a
1C27 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1C2A D0E0       621            pop acc
1C2C C083       621            push dph
1C2E C082       621            push dpl
1C30 C0E0       621            push acc
1C32 900E17     621            mov dptr, #SettingsBtm1
1C35 1200B4     621            lcall ?Send_Constant_String
1C38 D0E0       621            pop acc
1C3A D082       621            pop dpl
1C3C D083       621            pop dph                 ;display bottom half no cursor
1C3E            621   Skip_Displaying_Bottom257:
1C3E 021CBE     621                    ljmp Menu_Done_Display_Cursor_Change238
1C41            621                                    
1C41            621   Menu_Display_not_THREE238:
1C41 E9         621                    mov a, R1
1C42 B40379     621                    cjne a, #0x03, Menu_Display_not_FOUR238
1C45 C0E0       621            push acc
1C47 7401       621            mov a, #1
1C49 14         621            dec a
1C4A 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1C4D D0E0       621            pop acc
1C4F C083       621            push dph
1C51 C082       621            push dpl
1C53 C0E0       621            push acc
1C55 900D07     621            mov dptr, #CLEARLINE
1C58 1200B4     621            lcall ?Send_Constant_String
1C5B D0E0       621            pop acc
1C5D D082       621            pop dpl
1C5F D083       621            pop dph
1C61 C0E0       621            push acc
1C63 7401       621            mov a, #1
1C65 14         621            dec a
1C66 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1C69 D0E0       621            pop acc
1C6B C083       621            push dph
1C6D C082       621            push dpl
1C6F C0E0       621            push acc
1C71 900E06     621            mov dptr, #SettingsTop3
1C74 1200B4     621            lcall ?Send_Constant_String
1C77 D0E0       621            pop acc
1C79 D082       621            pop dpl
1C7B D083       621            pop dph                 ;display top half, cursor >
1C7D            621            ;check if its required to display bottom half
1C7D EA         621            mov a, R2
1C7E 5402       621            anl a, #0x02
1C80 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom266
1C83 C0E0       621            push acc
1C85 7401       621            mov a, #1
1C87 14         621            dec a
1C88 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1C8B D0E0       621            pop acc
1C8D C083       621            push dph
1C8F C082       621            push dpl
1C91 C0E0       621            push acc
1C93 900D07     621            mov dptr, #CLEARLINE
1C96 1200B4     621            lcall ?Send_Constant_String
1C99 D0E0       621            pop acc
1C9B D082       621            pop dpl
1C9D D083       621            pop dph
1C9F C0E0       621            push acc
1CA1 7401       621            mov a, #1
1CA3 14         621            dec a
1CA4 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1CA7 D0E0       621            pop acc
1CA9 C083       621            push dph
1CAB C082       621            push dpl
1CAD C0E0       621            push acc
1CAF 900E28     621            mov dptr, #SettingsBtm2
1CB2 1200B4     621            lcall ?Send_Constant_String
1CB5 D0E0       621            pop acc
1CB7 D082       621            pop dpl
1CB9 D083       621            pop dph                 ;display bottom half no cursor
1CBB            621   Skip_Displaying_Bottom266:       
1CBB 021CBE     621                    ljmp Menu_Done_Display_Cursor_Change238
1CBE            621                                    
1CBE            621   Menu_Display_not_FOUR238:
1CBE            621   Menu_Done_Display_Cursor_Change238:      ;display on LCD
1CBE            621   
1CBE            621   ;The loop that will happen over and over in each level of the menu
1CBE            621   Menu_Loop236:
1CBE            621   
1CBE            621            ;First, Check to see if the user wants to INC the cursors location
1CBE 20A614     621            jb B0, Menu_Skip_Cursor_INCtp236        ; if the 'B0' button is not pressed skip
1CC1 C002       621            push AR2
1CC3 7A0A       621            mov R2, #10
1CC5 120039     621            lcall ?Wait_Milli_Seconds
1CC8 D002       621            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
1CCA 20A608     621            jb B0, Menu_Skip_Cursor_INCtp236        ; if the 'B0' button is not pressed skip
1CCD 30A6FD     621            jnb B0, $                               ; Wait for button release.
1CD0 30A5FD     621            jnb B2, $                               ; Wait for button release.
1CD3            621            ;The below code is used to get around the max jb jump distance
1CD3 8003       621            sjmp Menu_INC_Cursor236
1CD5            621   Menu_Skip_Cursor_INCtp236:
1CD5 021ED0     621            ljmp Menu_Skip_Cursor_INC236
1CD8            621   Menu_INC_Cursor236:      
1CD8 09         621            INC R1                                                  ;increment the cursors position
1CD9 1210C0     621            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
1CDC            621            ;display the screen after it has switched. This stays inside the 
1CDC            621            ;change cursor part so it only updates when pressed, not constantly.
1CDC E9         621            mov a, R1
1CDD B40079     621            cjne a, #0x00, Menu_Display_not_ONE276
1CE0 C0E0       621            push acc
1CE2 7401       621            mov a, #1
1CE4 14         621            dec a
1CE5 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1CE8 D0E0       621            pop acc
1CEA C083       621            push dph
1CEC C082       621            push dpl
1CEE C0E0       621            push acc
1CF0 900D07     621            mov dptr, #CLEARLINE
1CF3 1200B4     621            lcall ?Send_Constant_String
1CF6 D0E0       621            pop acc
1CF8 D082       621            pop dpl
1CFA D083       621            pop dph
1CFC C0E0       621            push acc
1CFE 7401       621            mov a, #1
1D00 14         621            dec a
1D01 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1D04 D0E0       621            pop acc
1D06 C083       621            push dph
1D08 C082       621            push dpl
1D0A C0E0       621            push acc
1D0C 900DE4     621            mov dptr, #SettingsTop1
1D0F 1200B4     621            lcall ?Send_Constant_String
1D12 D0E0       621            pop acc
1D14 D082       621            pop dpl
1D16 D083       621            pop dph                 ;display top half, cursor >
1D18            621            ;check if its required to display bottom half
1D18 EA         621            mov a, R2
1D19 5402       621            anl a, #0x02
1D1B B40238     621            cjne a, #0x02, Skip_Displaying_Bottom277
1D1E C0E0       621            push acc
1D20 7401       621            mov a, #1
1D22 14         621            dec a
1D23 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1D26 D0E0       621            pop acc
1D28 C083       621            push dph
1D2A C082       621            push dpl
1D2C C0E0       621            push acc
1D2E 900D07     621            mov dptr, #CLEARLINE
1D31 1200B4     621            lcall ?Send_Constant_String
1D34 D0E0       621            pop acc
1D36 D082       621            pop dpl
1D38 D083       621            pop dph
1D3A C0E0       621            push acc
1D3C 7401       621            mov a, #1
1D3E 14         621            dec a
1D3F 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1D42 D0E0       621            pop acc
1D44 C083       621            push dph
1D46 C082       621            push dpl
1D48 C0E0       621            push acc
1D4A 900E39     621            mov dptr, #SettingsBtm3
1D4D 1200B4     621            lcall ?Send_Constant_String
1D50 D0E0       621            pop acc
1D52 D082       621            pop dpl
1D54 D083       621            pop dph                 ;display bottom half no cursor
1D56            621   Skip_Displaying_Bottom277:                       
1D56 021ED0     621            ljmp Menu_Done_Display_Cursor_Change276         
1D59            621                    
1D59            621   Menu_Display_not_ONE276:
1D59 E9         621                    mov a, R1
1D5A B40179     621                    cjne a, #0x01, Menu_Display_not_TWO276
1D5D C0E0       621            push acc
1D5F 7401       621            mov a, #1
1D61 14         621            dec a
1D62 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1D65 D0E0       621            pop acc
1D67 C083       621            push dph
1D69 C082       621            push dpl
1D6B C0E0       621            push acc
1D6D 900D07     621            mov dptr, #CLEARLINE
1D70 1200B4     621            lcall ?Send_Constant_String
1D73 D0E0       621            pop acc
1D75 D082       621            pop dpl
1D77 D083       621            pop dph
1D79 C0E0       621            push acc
1D7B 7401       621            mov a, #1
1D7D 14         621            dec a
1D7E 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1D81 D0E0       621            pop acc
1D83 C083       621            push dph
1D85 C082       621            push dpl
1D87 C0E0       621            push acc
1D89 900DF5     621            mov dptr, #SettingsTop2
1D8C 1200B4     621            lcall ?Send_Constant_String
1D8F D0E0       621            pop acc
1D91 D082       621            pop dpl
1D93 D083       621            pop dph                 ;display top half, cursor >
1D95            621            ;check if its required to display bottom half
1D95 EA         621            mov a, R2
1D96 5402       621            anl a, #0x02
1D98 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom286
1D9B C0E0       621            push acc
1D9D 7401       621            mov a, #1
1D9F 14         621            dec a
1DA0 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1DA3 D0E0       621            pop acc
1DA5 C083       621            push dph
1DA7 C082       621            push dpl
1DA9 C0E0       621            push acc
1DAB 900D07     621            mov dptr, #CLEARLINE
1DAE 1200B4     621            lcall ?Send_Constant_String
1DB1 D0E0       621            pop acc
1DB3 D082       621            pop dpl
1DB5 D083       621            pop dph
1DB7 C0E0       621            push acc
1DB9 7401       621            mov a, #1
1DBB 14         621            dec a
1DBC 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1DBF D0E0       621            pop acc
1DC1 C083       621            push dph
1DC3 C082       621            push dpl
1DC5 C0E0       621            push acc
1DC7 900E39     621            mov dptr, #SettingsBtm3
1DCA 1200B4     621            lcall ?Send_Constant_String
1DCD D0E0       621            pop acc
1DCF D082       621            pop dpl
1DD1 D083       621            pop dph                 ;display bottom half no cursor
1DD3            621   Skip_Displaying_Bottom286:
1DD3 021ED0     621                    ljmp Menu_Done_Display_Cursor_Change276
1DD6            621                                    
1DD6            621   Menu_Display_not_TWO276:
1DD6 E9         621                    mov a, R1
1DD7 B40279     621                    cjne a, #0x02, Menu_Display_not_THREE276
1DDA C0E0       621            push acc
1DDC 7401       621            mov a, #1
1DDE 14         621            dec a
1DDF 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1DE2 D0E0       621            pop acc
1DE4 C083       621            push dph
1DE6 C082       621            push dpl
1DE8 C0E0       621            push acc
1DEA 900D07     621            mov dptr, #CLEARLINE
1DED 1200B4     621            lcall ?Send_Constant_String
1DF0 D0E0       621            pop acc
1DF2 D082       621            pop dpl
1DF4 D083       621            pop dph
1DF6 C0E0       621            push acc
1DF8 7401       621            mov a, #1
1DFA 14         621            dec a
1DFB 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1DFE D0E0       621            pop acc
1E00 C083       621            push dph
1E02 C082       621            push dpl
1E04 C0E0       621            push acc
1E06 900E06     621            mov dptr, #SettingsTop3
1E09 1200B4     621            lcall ?Send_Constant_String
1E0C D0E0       621            pop acc
1E0E D082       621            pop dpl
1E10 D083       621            pop dph                 ;display top half, cursor >
1E12            621            ;check if its required to display bottom half
1E12 EA         621            mov a, R2
1E13 5402       621            anl a, #0x02
1E15 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom295
1E18 C0E0       621            push acc
1E1A 7401       621            mov a, #1
1E1C 14         621            dec a
1E1D 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1E20 D0E0       621            pop acc
1E22 C083       621            push dph
1E24 C082       621            push dpl
1E26 C0E0       621            push acc
1E28 900D07     621            mov dptr, #CLEARLINE
1E2B 1200B4     621            lcall ?Send_Constant_String
1E2E D0E0       621            pop acc
1E30 D082       621            pop dpl
1E32 D083       621            pop dph
1E34 C0E0       621            push acc
1E36 7401       621            mov a, #1
1E38 14         621            dec a
1E39 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1E3C D0E0       621            pop acc
1E3E C083       621            push dph
1E40 C082       621            push dpl
1E42 C0E0       621            push acc
1E44 900E17     621            mov dptr, #SettingsBtm1
1E47 1200B4     621            lcall ?Send_Constant_String
1E4A D0E0       621            pop acc
1E4C D082       621            pop dpl
1E4E D083       621            pop dph                 ;display bottom half no cursor
1E50            621   Skip_Displaying_Bottom295:
1E50 021ED0     621                    ljmp Menu_Done_Display_Cursor_Change276
1E53            621                                    
1E53            621   Menu_Display_not_THREE276:
1E53 E9         621                    mov a, R1
1E54 B40379     621                    cjne a, #0x03, Menu_Display_not_FOUR276
1E57 C0E0       621            push acc
1E59 7401       621            mov a, #1
1E5B 14         621            dec a
1E5C 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1E5F D0E0       621            pop acc
1E61 C083       621            push dph
1E63 C082       621            push dpl
1E65 C0E0       621            push acc
1E67 900D07     621            mov dptr, #CLEARLINE
1E6A 1200B4     621            lcall ?Send_Constant_String
1E6D D0E0       621            pop acc
1E6F D082       621            pop dpl
1E71 D083       621            pop dph
1E73 C0E0       621            push acc
1E75 7401       621            mov a, #1
1E77 14         621            dec a
1E78 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1E7B D0E0       621            pop acc
1E7D C083       621            push dph
1E7F C082       621            push dpl
1E81 C0E0       621            push acc
1E83 900E06     621            mov dptr, #SettingsTop3
1E86 1200B4     621            lcall ?Send_Constant_String
1E89 D0E0       621            pop acc
1E8B D082       621            pop dpl
1E8D D083       621            pop dph                 ;display top half, cursor >
1E8F            621            ;check if its required to display bottom half
1E8F EA         621            mov a, R2
1E90 5402       621            anl a, #0x02
1E92 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom304
1E95 C0E0       621            push acc
1E97 7401       621            mov a, #1
1E99 14         621            dec a
1E9A 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1E9D D0E0       621            pop acc
1E9F C083       621            push dph
1EA1 C082       621            push dpl
1EA3 C0E0       621            push acc
1EA5 900D07     621            mov dptr, #CLEARLINE
1EA8 1200B4     621            lcall ?Send_Constant_String
1EAB D0E0       621            pop acc
1EAD D082       621            pop dpl
1EAF D083       621            pop dph
1EB1 C0E0       621            push acc
1EB3 7401       621            mov a, #1
1EB5 14         621            dec a
1EB6 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1EB9 D0E0       621            pop acc
1EBB C083       621            push dph
1EBD C082       621            push dpl
1EBF C0E0       621            push acc
1EC1 900E28     621            mov dptr, #SettingsBtm2
1EC4 1200B4     621            lcall ?Send_Constant_String
1EC7 D0E0       621            pop acc
1EC9 D082       621            pop dpl
1ECB D083       621            pop dph                 ;display bottom half no cursor
1ECD            621   Skip_Displaying_Bottom304:       
1ECD 021ED0     621                    ljmp Menu_Done_Display_Cursor_Change276
1ED0            621                                    
1ED0            621   Menu_Display_not_FOUR276:
1ED0            621   Menu_Done_Display_Cursor_Change276:      ;display on LCD
1ED0            621            
1ED0            621   Menu_Skip_Cursor_INC236:
1ED0            621   
1ED0            621            ;Then, Check to see if the user wants to DEC the cursors location
1ED0 20A514     621            jb B2, Menu_Skip_Cursor_DECtp236        ; if the 'B0' button is not pressed skip
1ED3 C002       621            push AR2
1ED5 7A0A       621            mov R2, #10
1ED7 120039     621            lcall ?Wait_Milli_Seconds
1EDA D002       621            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
1EDC 20A508     621            jb B2, Menu_Skip_Cursor_DECtp236        ; if the 'B0' button is not pressed skip
1EDF 30A5FD     621            jnb B2, $                               ; Wait for button release.
1EE2 30A6FD     621            jnb B0, $                               ; Wait for button release.
1EE5            621            ;The below code is used to get around the max jb jump distance
1EE5 8003       621            sjmp Menu_DEC_Cursor236
1EE7            621   Menu_Skip_Cursor_DECtp236:
1EE7 0220E2     621            ljmp Menu_Skip_Cursor_DEC236
1EEA            621   Menu_DEC_Cursor236:      
1EEA 19         621            DEC R1                                                  ;increment the cursors position
1EEB 1210C0     621            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
1EEE            621            ;display the screen after it has switched. This stays inside the 
1EEE            621            ;change cursor part so it only updates when pressed, not constantly.
1EEE E9         621            mov a, R1
1EEF B40079     621            cjne a, #0x00, Menu_Display_not_ONE314
1EF2 C0E0       621            push acc
1EF4 7401       621            mov a, #1
1EF6 14         621            dec a
1EF7 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1EFA D0E0       621            pop acc
1EFC C083       621            push dph
1EFE C082       621            push dpl
1F00 C0E0       621            push acc
1F02 900D07     621            mov dptr, #CLEARLINE
1F05 1200B4     621            lcall ?Send_Constant_String
1F08 D0E0       621            pop acc
1F0A D082       621            pop dpl
1F0C D083       621            pop dph
1F0E C0E0       621            push acc
1F10 7401       621            mov a, #1
1F12 14         621            dec a
1F13 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1F16 D0E0       621            pop acc
1F18 C083       621            push dph
1F1A C082       621            push dpl
1F1C C0E0       621            push acc
1F1E 900DE4     621            mov dptr, #SettingsTop1
1F21 1200B4     621            lcall ?Send_Constant_String
1F24 D0E0       621            pop acc
1F26 D082       621            pop dpl
1F28 D083       621            pop dph                 ;display top half, cursor >
1F2A            621            ;check if its required to display bottom half
1F2A EA         621            mov a, R2
1F2B 5402       621            anl a, #0x02
1F2D B40238     621            cjne a, #0x02, Skip_Displaying_Bottom315
1F30 C0E0       621            push acc
1F32 7401       621            mov a, #1
1F34 14         621            dec a
1F35 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1F38 D0E0       621            pop acc
1F3A C083       621            push dph
1F3C C082       621            push dpl
1F3E C0E0       621            push acc
1F40 900D07     621            mov dptr, #CLEARLINE
1F43 1200B4     621            lcall ?Send_Constant_String
1F46 D0E0       621            pop acc
1F48 D082       621            pop dpl
1F4A D083       621            pop dph
1F4C C0E0       621            push acc
1F4E 7401       621            mov a, #1
1F50 14         621            dec a
1F51 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1F54 D0E0       621            pop acc
1F56 C083       621            push dph
1F58 C082       621            push dpl
1F5A C0E0       621            push acc
1F5C 900E39     621            mov dptr, #SettingsBtm3
1F5F 1200B4     621            lcall ?Send_Constant_String
1F62 D0E0       621            pop acc
1F64 D082       621            pop dpl
1F66 D083       621            pop dph                 ;display bottom half no cursor
1F68            621   Skip_Displaying_Bottom315:                       
1F68 0220E2     621            ljmp Menu_Done_Display_Cursor_Change314         
1F6B            621                    
1F6B            621   Menu_Display_not_ONE314:
1F6B E9         621                    mov a, R1
1F6C B40179     621                    cjne a, #0x01, Menu_Display_not_TWO314
1F6F C0E0       621            push acc
1F71 7401       621            mov a, #1
1F73 14         621            dec a
1F74 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1F77 D0E0       621            pop acc
1F79 C083       621            push dph
1F7B C082       621            push dpl
1F7D C0E0       621            push acc
1F7F 900D07     621            mov dptr, #CLEARLINE
1F82 1200B4     621            lcall ?Send_Constant_String
1F85 D0E0       621            pop acc
1F87 D082       621            pop dpl
1F89 D083       621            pop dph
1F8B C0E0       621            push acc
1F8D 7401       621            mov a, #1
1F8F 14         621            dec a
1F90 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1F93 D0E0       621            pop acc
1F95 C083       621            push dph
1F97 C082       621            push dpl
1F99 C0E0       621            push acc
1F9B 900DF5     621            mov dptr, #SettingsTop2
1F9E 1200B4     621            lcall ?Send_Constant_String
1FA1 D0E0       621            pop acc
1FA3 D082       621            pop dpl
1FA5 D083       621            pop dph                 ;display top half, cursor >
1FA7            621            ;check if its required to display bottom half
1FA7 EA         621            mov a, R2
1FA8 5402       621            anl a, #0x02
1FAA B40238     621            cjne a, #0x02, Skip_Displaying_Bottom324
1FAD C0E0       621            push acc
1FAF 7401       621            mov a, #1
1FB1 14         621            dec a
1FB2 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1FB5 D0E0       621            pop acc
1FB7 C083       621            push dph
1FB9 C082       621            push dpl
1FBB C0E0       621            push acc
1FBD 900D07     621            mov dptr, #CLEARLINE
1FC0 1200B4     621            lcall ?Send_Constant_String
1FC3 D0E0       621            pop acc
1FC5 D082       621            pop dpl
1FC7 D083       621            pop dph
1FC9 C0E0       621            push acc
1FCB 7401       621            mov a, #1
1FCD 14         621            dec a
1FCE 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
1FD1 D0E0       621            pop acc
1FD3 C083       621            push dph
1FD5 C082       621            push dpl
1FD7 C0E0       621            push acc
1FD9 900E39     621            mov dptr, #SettingsBtm3
1FDC 1200B4     621            lcall ?Send_Constant_String
1FDF D0E0       621            pop acc
1FE1 D082       621            pop dpl
1FE3 D083       621            pop dph                 ;display bottom half no cursor
1FE5            621   Skip_Displaying_Bottom324:
1FE5 0220E2     621                    ljmp Menu_Done_Display_Cursor_Change314
1FE8            621                                    
1FE8            621   Menu_Display_not_TWO314:
1FE8 E9         621                    mov a, R1
1FE9 B40279     621                    cjne a, #0x02, Menu_Display_not_THREE314
1FEC C0E0       621            push acc
1FEE 7401       621            mov a, #1
1FF0 14         621            dec a
1FF1 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
1FF4 D0E0       621            pop acc
1FF6 C083       621            push dph
1FF8 C082       621            push dpl
1FFA C0E0       621            push acc
1FFC 900D07     621            mov dptr, #CLEARLINE
1FFF 1200B4     621            lcall ?Send_Constant_String
2002 D0E0       621            pop acc
2004 D082       621            pop dpl
2006 D083       621            pop dph
2008 C0E0       621            push acc
200A 7401       621            mov a, #1
200C 14         621            dec a
200D 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
2010 D0E0       621            pop acc
2012 C083       621            push dph
2014 C082       621            push dpl
2016 C0E0       621            push acc
2018 900E06     621            mov dptr, #SettingsTop3
201B 1200B4     621            lcall ?Send_Constant_String
201E D0E0       621            pop acc
2020 D082       621            pop dpl
2022 D083       621            pop dph                 ;display top half, cursor >
2024            621            ;check if its required to display bottom half
2024 EA         621            mov a, R2
2025 5402       621            anl a, #0x02
2027 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom333
202A C0E0       621            push acc
202C 7401       621            mov a, #1
202E 14         621            dec a
202F 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
2032 D0E0       621            pop acc
2034 C083       621            push dph
2036 C082       621            push dpl
2038 C0E0       621            push acc
203A 900D07     621            mov dptr, #CLEARLINE
203D 1200B4     621            lcall ?Send_Constant_String
2040 D0E0       621            pop acc
2042 D082       621            pop dpl
2044 D083       621            pop dph
2046 C0E0       621            push acc
2048 7401       621            mov a, #1
204A 14         621            dec a
204B 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
204E D0E0       621            pop acc
2050 C083       621            push dph
2052 C082       621            push dpl
2054 C0E0       621            push acc
2056 900E17     621            mov dptr, #SettingsBtm1
2059 1200B4     621            lcall ?Send_Constant_String
205C D0E0       621            pop acc
205E D082       621            pop dpl
2060 D083       621            pop dph                 ;display bottom half no cursor
2062            621   Skip_Displaying_Bottom333:
2062 0220E2     621                    ljmp Menu_Done_Display_Cursor_Change314
2065            621                                    
2065            621   Menu_Display_not_THREE314:
2065 E9         621                    mov a, R1
2066 B40379     621                    cjne a, #0x03, Menu_Display_not_FOUR314
2069 C0E0       621            push acc
206B 7401       621            mov a, #1
206D 14         621            dec a
206E 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
2071 D0E0       621            pop acc
2073 C083       621            push dph
2075 C082       621            push dpl
2077 C0E0       621            push acc
2079 900D07     621            mov dptr, #CLEARLINE
207C 1200B4     621            lcall ?Send_Constant_String
207F D0E0       621            pop acc
2081 D082       621            pop dpl
2083 D083       621            pop dph
2085 C0E0       621            push acc
2087 7401       621            mov a, #1
2089 14         621            dec a
208A 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
208D D0E0       621            pop acc
208F C083       621            push dph
2091 C082       621            push dpl
2093 C0E0       621            push acc
2095 900E06     621            mov dptr, #SettingsTop3
2098 1200B4     621            lcall ?Send_Constant_String
209B D0E0       621            pop acc
209D D082       621            pop dpl
209F D083       621            pop dph                 ;display top half, cursor >
20A1            621            ;check if its required to display bottom half
20A1 EA         621            mov a, R2
20A2 5402       621            anl a, #0x02
20A4 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom342
20A7 C0E0       621            push acc
20A9 7401       621            mov a, #1
20AB 14         621            dec a
20AC 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
20AF D0E0       621            pop acc
20B1 C083       621            push dph
20B3 C082       621            push dpl
20B5 C0E0       621            push acc
20B7 900D07     621            mov dptr, #CLEARLINE
20BA 1200B4     621            lcall ?Send_Constant_String
20BD D0E0       621            pop acc
20BF D082       621            pop dpl
20C1 D083       621            pop dph
20C3 C0E0       621            push acc
20C5 7401       621            mov a, #1
20C7 14         621            dec a
20C8 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
20CB D0E0       621            pop acc
20CD C083       621            push dph
20CF C082       621            push dpl
20D1 C0E0       621            push acc
20D3 900E28     621            mov dptr, #SettingsBtm2
20D6 1200B4     621            lcall ?Send_Constant_String
20D9 D0E0       621            pop acc
20DB D082       621            pop dpl
20DD D083       621            pop dph                 ;display bottom half no cursor
20DF            621   Skip_Displaying_Bottom342:       
20DF 0220E2     621                    ljmp Menu_Done_Display_Cursor_Change314
20E2            621                                    
20E2            621   Menu_Display_not_FOUR314:
20E2            621   Menu_Done_Display_Cursor_Change314:      ;display on LCD
20E2            621            
20E2            621   Menu_Skip_Cursor_DEC236:
20E2            621   
20E2            621            ;Check if the user wanted to exit the level of the menu
20E2 E8         621            mov a, R0
20E3 B40105     621            cjne a, #0x01, Menu_Stay236     ;if the flag is not 1, continue program, otherwise reset flag and return
20E6 7800       621            mov R0, #0x00
20E8 022326     621            ljmp Menu_Exit_Level236
20EB            621            
20EB            621   Menu_Stay236:    
20EB            621            ;now the code that operates when the "select" button is pressed
20EB 20A711     621            jb B1, Menu_Skip_Select_Changetp236     ; if the 'B1' button is not pressed skip
20EE C002       621            push AR2
20F0 7A32       621            mov R2, #50
20F2 120039     621            lcall ?Wait_Milli_Seconds
20F5 D002       621            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
20F7 20A705     621            jb B1, Menu_Skip_Select_Changetp236     ; if the 'B1' button is not pressed skip
20FA 30A7FD     621            jnb B1, $                               ; Wait for button release
20FD            621            ;The below code is used to get around the max jb jump distance 
20FD 8003       621            sjmp Menu_Select_Change236
20FF            621   Menu_Skip_Select_Changetp236:
20FF 022320     621            ljmp Menu_Skip_Select_Change236         ;the button was not pressed.
2102            621            
2102            621   Menu_Select_Change236:
2102            621            
2102            621   ;We simply compare what number is in the cursor and enter that function
2102 E9         621            mov a, R1
2103 B40006     621            cjne a, #0x00, Menu_Not_Func_One_Select352
2106            621            ;if here, then the cursor is on the above position
2106 1200ED     621            lcall Menu_Back
2109 02212A     621            ljmp Menu_Done_Func352
210C            621                            
210C            621   Menu_Not_Func_One_Select352:
210C E9         621                    mov a, R1
210D B40106     621            cjne a, #0x01, Menu_Not_Func_Two_Select352
2110            621            ;if here, then the cursor is on the above position
2110 1200EC     621            lcall Menu_Null
2113 02212A     621            ljmp Menu_Done_Func352
2116            621                            
2116            621   Menu_Not_Func_Two_Select352:
2116 E9         621            mov a, R1
2117 B40206     621            cjne a, #0x02, Menu_Not_Func_Three_Select352
211A            621            ;if here, then the cursor is on the above position
211A 12233C     621            lcall Soak_Settings
211D 02212A     621            ljmp Menu_Done_Func352
2120            621                            
2120            621   Menu_Not_Func_Three_Select352:
2120 E9         621            mov a, R1
2121 B40306     621            cjne a, #0x03, Menu_Not_Func_Four_Select352
2124            621            ;if here, then the cursor is on the above position
2124 12251A     621            lcall Reflow_Settings
2127 02212A     621            ljmp Menu_Done_Func352
212A            621                            
212A            621   Menu_Not_Func_Four_Select352:
212A            621   
212A            621   Menu_Done_Func352:
212A            621   
212A            621            ;after selecting the function and exiting it, reset the cursor position and the screen
212A 7900       621            mov R1, #0x00
212C            621            ;display the screen after it has switched. This stays inside the 
212C            621            ;change cursor part so it only updates when pressed, not constantly.
212C E9         621            mov a, R1
212D B40079     621            cjne a, #0x00, Menu_Display_not_ONE353
2130 C0E0       621            push acc
2132 7401       621            mov a, #1
2134 14         621            dec a
2135 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
2138 D0E0       621            pop acc
213A C083       621            push dph
213C C082       621            push dpl
213E C0E0       621            push acc
2140 900D07     621            mov dptr, #CLEARLINE
2143 1200B4     621            lcall ?Send_Constant_String
2146 D0E0       621            pop acc
2148 D082       621            pop dpl
214A D083       621            pop dph
214C C0E0       621            push acc
214E 7401       621            mov a, #1
2150 14         621            dec a
2151 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
2154 D0E0       621            pop acc
2156 C083       621            push dph
2158 C082       621            push dpl
215A C0E0       621            push acc
215C 900DE4     621            mov dptr, #SettingsTop1
215F 1200B4     621            lcall ?Send_Constant_String
2162 D0E0       621            pop acc
2164 D082       621            pop dpl
2166 D083       621            pop dph                 ;display top half, cursor >
2168            621            ;check if its required to display bottom half
2168 EA         621            mov a, R2
2169 5402       621            anl a, #0x02
216B B40238     621            cjne a, #0x02, Skip_Displaying_Bottom354
216E C0E0       621            push acc
2170 7401       621            mov a, #1
2172 14         621            dec a
2173 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
2176 D0E0       621            pop acc
2178 C083       621            push dph
217A C082       621            push dpl
217C C0E0       621            push acc
217E 900D07     621            mov dptr, #CLEARLINE
2181 1200B4     621            lcall ?Send_Constant_String
2184 D0E0       621            pop acc
2186 D082       621            pop dpl
2188 D083       621            pop dph
218A C0E0       621            push acc
218C 7401       621            mov a, #1
218E 14         621            dec a
218F 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
2192 D0E0       621            pop acc
2194 C083       621            push dph
2196 C082       621            push dpl
2198 C0E0       621            push acc
219A 900E39     621            mov dptr, #SettingsBtm3
219D 1200B4     621            lcall ?Send_Constant_String
21A0 D0E0       621            pop acc
21A2 D082       621            pop dpl
21A4 D083       621            pop dph                 ;display bottom half no cursor
21A6            621   Skip_Displaying_Bottom354:                       
21A6 022320     621            ljmp Menu_Done_Display_Cursor_Change353         
21A9            621                    
21A9            621   Menu_Display_not_ONE353:
21A9 E9         621                    mov a, R1
21AA B40179     621                    cjne a, #0x01, Menu_Display_not_TWO353
21AD C0E0       621            push acc
21AF 7401       621            mov a, #1
21B1 14         621            dec a
21B2 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
21B5 D0E0       621            pop acc
21B7 C083       621            push dph
21B9 C082       621            push dpl
21BB C0E0       621            push acc
21BD 900D07     621            mov dptr, #CLEARLINE
21C0 1200B4     621            lcall ?Send_Constant_String
21C3 D0E0       621            pop acc
21C5 D082       621            pop dpl
21C7 D083       621            pop dph
21C9 C0E0       621            push acc
21CB 7401       621            mov a, #1
21CD 14         621            dec a
21CE 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
21D1 D0E0       621            pop acc
21D3 C083       621            push dph
21D5 C082       621            push dpl
21D7 C0E0       621            push acc
21D9 900DF5     621            mov dptr, #SettingsTop2
21DC 1200B4     621            lcall ?Send_Constant_String
21DF D0E0       621            pop acc
21E1 D082       621            pop dpl
21E3 D083       621            pop dph                 ;display top half, cursor >
21E5            621            ;check if its required to display bottom half
21E5 EA         621            mov a, R2
21E6 5402       621            anl a, #0x02
21E8 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom363
21EB C0E0       621            push acc
21ED 7401       621            mov a, #1
21EF 14         621            dec a
21F0 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
21F3 D0E0       621            pop acc
21F5 C083       621            push dph
21F7 C082       621            push dpl
21F9 C0E0       621            push acc
21FB 900D07     621            mov dptr, #CLEARLINE
21FE 1200B4     621            lcall ?Send_Constant_String
2201 D0E0       621            pop acc
2203 D082       621            pop dpl
2205 D083       621            pop dph
2207 C0E0       621            push acc
2209 7401       621            mov a, #1
220B 14         621            dec a
220C 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
220F D0E0       621            pop acc
2211 C083       621            push dph
2213 C082       621            push dpl
2215 C0E0       621            push acc
2217 900E39     621            mov dptr, #SettingsBtm3
221A 1200B4     621            lcall ?Send_Constant_String
221D D0E0       621            pop acc
221F D082       621            pop dpl
2221 D083       621            pop dph                 ;display bottom half no cursor
2223            621   Skip_Displaying_Bottom363:
2223 022320     621                    ljmp Menu_Done_Display_Cursor_Change353
2226            621                                    
2226            621   Menu_Display_not_TWO353:
2226 E9         621                    mov a, R1
2227 B40279     621                    cjne a, #0x02, Menu_Display_not_THREE353
222A C0E0       621            push acc
222C 7401       621            mov a, #1
222E 14         621            dec a
222F 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
2232 D0E0       621            pop acc
2234 C083       621            push dph
2236 C082       621            push dpl
2238 C0E0       621            push acc
223A 900D07     621            mov dptr, #CLEARLINE
223D 1200B4     621            lcall ?Send_Constant_String
2240 D0E0       621            pop acc
2242 D082       621            pop dpl
2244 D083       621            pop dph
2246 C0E0       621            push acc
2248 7401       621            mov a, #1
224A 14         621            dec a
224B 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
224E D0E0       621            pop acc
2250 C083       621            push dph
2252 C082       621            push dpl
2254 C0E0       621            push acc
2256 900E06     621            mov dptr, #SettingsTop3
2259 1200B4     621            lcall ?Send_Constant_String
225C D0E0       621            pop acc
225E D082       621            pop dpl
2260 D083       621            pop dph                 ;display top half, cursor >
2262            621            ;check if its required to display bottom half
2262 EA         621            mov a, R2
2263 5402       621            anl a, #0x02
2265 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom372
2268 C0E0       621            push acc
226A 7401       621            mov a, #1
226C 14         621            dec a
226D 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
2270 D0E0       621            pop acc
2272 C083       621            push dph
2274 C082       621            push dpl
2276 C0E0       621            push acc
2278 900D07     621            mov dptr, #CLEARLINE
227B 1200B4     621            lcall ?Send_Constant_String
227E D0E0       621            pop acc
2280 D082       621            pop dpl
2282 D083       621            pop dph
2284 C0E0       621            push acc
2286 7401       621            mov a, #1
2288 14         621            dec a
2289 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
228C D0E0       621            pop acc
228E C083       621            push dph
2290 C082       621            push dpl
2292 C0E0       621            push acc
2294 900E17     621            mov dptr, #SettingsBtm1
2297 1200B4     621            lcall ?Send_Constant_String
229A D0E0       621            pop acc
229C D082       621            pop dpl
229E D083       621            pop dph                 ;display bottom half no cursor
22A0            621   Skip_Displaying_Bottom372:
22A0 022320     621                    ljmp Menu_Done_Display_Cursor_Change353
22A3            621                                    
22A3            621   Menu_Display_not_THREE353:
22A3 E9         621                    mov a, R1
22A4 B40379     621                    cjne a, #0x03, Menu_Display_not_FOUR353
22A7 C0E0       621            push acc
22A9 7401       621            mov a, #1
22AB 14         621            dec a
22AC 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
22AF D0E0       621            pop acc
22B1 C083       621            push dph
22B3 C082       621            push dpl
22B5 C0E0       621            push acc
22B7 900D07     621            mov dptr, #CLEARLINE
22BA 1200B4     621            lcall ?Send_Constant_String
22BD D0E0       621            pop acc
22BF D082       621            pop dpl
22C1 D083       621            pop dph
22C3 C0E0       621            push acc
22C5 7401       621            mov a, #1
22C7 14         621            dec a
22C8 1200C1     621            lcall ?Set_Cursor_1 ; Select column and row
22CB D0E0       621            pop acc
22CD C083       621            push dph
22CF C082       621            push dpl
22D1 C0E0       621            push acc
22D3 900E06     621            mov dptr, #SettingsTop3
22D6 1200B4     621            lcall ?Send_Constant_String
22D9 D0E0       621            pop acc
22DB D082       621            pop dpl
22DD D083       621            pop dph                 ;display top half, cursor >
22DF            621            ;check if its required to display bottom half
22DF EA         621            mov a, R2
22E0 5402       621            anl a, #0x02
22E2 B40238     621            cjne a, #0x02, Skip_Displaying_Bottom381
22E5 C0E0       621            push acc
22E7 7401       621            mov a, #1
22E9 14         621            dec a
22EA 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
22ED D0E0       621            pop acc
22EF C083       621            push dph
22F1 C082       621            push dpl
22F3 C0E0       621            push acc
22F5 900D07     621            mov dptr, #CLEARLINE
22F8 1200B4     621            lcall ?Send_Constant_String
22FB D0E0       621            pop acc
22FD D082       621            pop dpl
22FF D083       621            pop dph
2301 C0E0       621            push acc
2303 7401       621            mov a, #1
2305 14         621            dec a
2306 1200BF     621            lcall ?Set_Cursor_2 ; Select column and row
2309 D0E0       621            pop acc
230B C083       621            push dph
230D C082       621            push dpl
230F C0E0       621            push acc
2311 900E28     621            mov dptr, #SettingsBtm2
2314 1200B4     621            lcall ?Send_Constant_String
2317 D0E0       621            pop acc
2319 D082       621            pop dpl
231B D083       621            pop dph                 ;display bottom half no cursor
231D            621   Skip_Displaying_Bottom381:       
231D 022320     621                    ljmp Menu_Done_Display_Cursor_Change353
2320            621                                    
2320            621   Menu_Display_not_FOUR353:
2320            621   Menu_Done_Display_Cursor_Change353:
2320            621   
2320            621   Menu_Skip_Select_Change236:
2320            621            
2320            621            ;calling the operation function, which does stuff every cycle.
2320 1200EC     621            lcall Menu_Null
2323 021CBE     621            ljmp Menu_Loop236
2326            621   
2326            621   Menu_Exit_Level236:
2326 D0E0       621            pop acc
2328 D007       621            pop  ar7
232A D006       621            pop  ar6
232C D005       621            pop  ar5
232E D004       621            pop  ar4
2330 D003       621            pop  ar3
2332 D002       621            pop  ar2
2334 D001       621            pop  ar1
2336 D000       621            pop  ar0
2338            622            ;after exiting the settings, the program prompts you to save the new settings in one of the presets
2338 1226F8     623            lcall Save_Settings
233B 22         624            ret
233C            625   
233C            626   ;Soak_Settings
233C            627   Soak_Settings:
233C            628            ;display the current soaksettings and allow the user to change them.
233C C000       629            push AR0                ;used as the current selection tool
233E C0E0       630            push acc
2340 C0E0       631            push acc
2342 7401       631            mov a, #1
2344 14         631            dec a
2345 1200C1     631            lcall ?Set_Cursor_1 ; Select column and row
2348 D0E0       631            pop acc
234A C083       631            push dph
234C C082       631            push dpl
234E C0E0       631            push acc
2350 900D07     631            mov dptr, #CLEARLINE
2353 1200B4     631            lcall ?Send_Constant_String
2356 D0E0       631            pop acc
2358 D082       631            pop dpl
235A D083       631            pop dph
235C C0E0       631            push acc
235E 7401       631            mov a, #1
2360 14         631            dec a
2361 1200BF     631            lcall ?Set_Cursor_2 ; Select column and row
2364 D0E0       631            pop acc
2366 C083       631            push dph
2368 C082       631            push dpl
236A C0E0       631            push acc
236C 900D07     631            mov dptr, #CLEARLINE
236F 1200B4     631            lcall ?Send_Constant_String
2372 D0E0       631            pop acc
2374 D082       631            pop dpl
2376 D083       631            pop dph
2378 C0E0       631            push acc
237A 7401       631            mov a, #1
237C 14         631            dec a
237D 1200C1     631            lcall ?Set_Cursor_1 ; Select column and row
2380 D0E0       631            pop acc
2382 C083       631            push dph
2384 C082       631            push dpl
2386 C0E0       631            push acc
2388 900E92     631            mov dptr, #SoakSettings1
238B 1200B4     631            lcall ?Send_Constant_String
238E D0E0       631            pop acc
2390 D082       631            pop dpl
2392 D083       631            pop dph
2394 C0E0       631            push acc
2396 7401       631            mov a, #1
2398 14         631            dec a
2399 1200BF     631            lcall ?Set_Cursor_2 ; Select column and row
239C D0E0       631            pop acc
239E C083       631            push dph
23A0 C082       631            push dpl
23A2 C0E0       631            push acc
23A4 900D07     631            mov dptr, #CLEARLINE
23A7 1200B4     631            lcall ?Send_Constant_String
23AA D0E0       631            pop acc
23AC D082       631            pop dpl
23AE D083       631            pop dph
23B0 7800       632            mov R0, #0x00
23B2 C0E0       633            push acc
23B4 7405       633            mov a, #5
23B6 14         633            dec a
23B7 1200BF     633            lcall ?Set_Cursor_2 ; Select column and row
23BA D0E0       633            pop acc
23BC C083       634            push dph
23BE C082       634            push dpl
23C0 C0E0       634            push acc
23C2 900EB4     634            mov dptr, #leftpoint
23C5 1200B4     634            lcall ?Send_Constant_String
23C8 D0E0       634            pop acc
23CA D082       634            pop dpl
23CC D083       634            pop dph
23CE            635   Soak_Settings_Loop:
23CE            636            ;check to see if user is going to exit the program
23CE 20A714     637            jb B1, NOT_Exit_Soak_Settings_Loop ; if the 'B0' button is not pressed skip
23D1 C002       638            push AR2
23D3 7A32       638            mov R2, #50
23D5 120039     638            lcall ?Wait_Milli_Seconds
23D8 D002       638            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
23DA 20A708     639            jb B1, NOT_Exit_Soak_Settings_Loop ; if the 'B0' button is not pressed skip
23DD 30A7FD     640            jnb B1, $
23E0 D0E0       641            pop acc
23E2 D000       642            pop AR0
23E4 22         643            ret     
23E5            644   NOT_Exit_Soak_Settings_Loop:
23E5            645   
23E5            646            ;first the cursor settings.
23E5 20A411     647            jb B3, Skip_INC_Cursor_Soak_Settingstp ; if the 'B0' button is not pressed skip
23E8 C002       648            push AR2
23EA 7A32       648            mov R2, #50
23EC 120039     648            lcall ?Wait_Milli_Seconds
23EF D002       648            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
23F1 20A405     649            jb B3, Skip_INC_Cursor_Soak_Settingstp ; if the 'B0' button is not pressed skip
23F4 30A4FD     650            jnb B3, $
23F7 8003       651            sjmp Soak_Jump
23F9            652            
23F9            653   Skip_INC_Cursor_Soak_Settingstp:
23F9 02247B     654            ljmp Skip_INC_Cursor_Soak_Settings
23FC            655            
23FC            656   Soak_Jump:
23FC 08         657            Inc R0
23FD E8         658            mov a, R0
23FE B40204     659            cjne a, #0x02, Soak_Cursor_No_Reset
2401 7800       660            mov R0, #0x00
2403 7400       661            mov a, #0x00
2405            662   
2405            663   Soak_Cursor_No_Reset:
2405 B4003B     664            cjne a, #0x00, Soak_Cursor_Not_0
2408 C0E0       665            push acc
240A 7405       665            mov a, #5
240C 14         665            dec a
240D 1200BF     665            lcall ?Set_Cursor_2 ; Select column and row
2410 D0E0       665            pop acc
2412 C083       666            push dph
2414 C082       666            push dpl
2416 C0E0       666            push acc
2418 900EB4     666            mov dptr, #leftpoint
241B 1200B4     666            lcall ?Send_Constant_String
241E D0E0       666            pop acc
2420 D082       666            pop dpl
2422 D083       666            pop dph
2424 C0E0       667            push acc
2426 740C       667            mov a, #12
2428 14         667            dec a
2429 1200BF     667            lcall ?Set_Cursor_2 ; Select column and row
242C D0E0       667            pop acc
242E C083       668            push dph
2430 C082       668            push dpl
2432 C0E0       668            push acc
2434 900EB8     668            mov dptr, #CLEARCHAR
2437 1200B4     668            lcall ?Send_Constant_String
243A D0E0       668            pop acc
243C D082       668            pop dpl
243E D083       668            pop dph
2440 02247B     669            ljmp Skip_INC_Cursor_Soak_Settings
2443            670   Soak_Cursor_Not_0:
2443 C0E0       671            push acc
2445 740C       671            mov a, #12
2447 14         671            dec a
2448 1200BF     671            lcall ?Set_Cursor_2 ; Select column and row
244B D0E0       671            pop acc
244D C083       672            push dph
244F C082       672            push dpl
2451 C0E0       672            push acc
2453 900EB6     672            mov dptr, #rightpoint
2456 1200B4     672            lcall ?Send_Constant_String
2459 D0E0       672            pop acc
245B D082       672            pop dpl
245D D083       672            pop dph
245F C0E0       673            push acc
2461 7405       673            mov a, #5
2463 14         673            dec a
2464 1200BF     673            lcall ?Set_Cursor_2 ; Select column and row
2467 D0E0       673            pop acc
2469 C083       674            push dph
246B C082       674            push dpl
246D C0E0       674            push acc
246F 900EB8     674            mov dptr, #CLEARCHAR
2472 1200B4     674            lcall ?Send_Constant_String
2475 D0E0       674            pop acc
2477 D082       674            pop dpl
2479 D083       674            pop dph
247B            675            
247B            676   Skip_INC_Cursor_Soak_Settings:
247B            677            ;check if the user increments one of the options
247B 20A620     678            jb B0, Skip_INC_Soak_Setting ; if the 'B0' button is not pressed skip
247E C002       679            push AR2
2480 7A0A       679            mov R2, #10
2482 120039     679            lcall ?Wait_Milli_Seconds
2485 D002       679            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2487 20A614     680            jb B0, Skip_INC_Soak_Setting ; if the 'B0' button is not pressed skip
248A 30A6FD     681            jnb B0, $
248D 30A5FD     682            jnb B2, $
2490            683            
2490 E8         684            mov a, R0
2491 B40005     685            cjne a, #0x00, Soak_Setting_INC_Not_Temp
2494 0532       686            INC Soak_Settings_Temp_hex
2496 02249E     687            ljmp Skip_INC_Soak_Setting
2499            688   Soak_Setting_INC_Not_Temp:
2499 0531       689            INC Soak_Settings_T_hex
249B 02249E     690            ljmp Skip_INC_Soak_Setting
249E            691   Skip_INC_Soak_Setting:
249E            692   
249E            693            ;check if the user decrements one of the options
249E 20A520     694            jb B2, Skip_DEC_Soak_Setting ; if the 'B0' button is not pressed skip
24A1 C002       695            push AR2
24A3 7A0A       695            mov R2, #10
24A5 120039     695            lcall ?Wait_Milli_Seconds
24A8 D002       695            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
24AA 20A514     696            jb B2, Skip_DEC_Soak_Setting ; if the 'B0' button is not pressed skip
24AD 30A5FD     697            jnb B2, $
24B0 30A6FD     698            jnb B0, $
24B3            699   
24B3 E8         700            mov a, R0
24B4 B40005     701            cjne a, #0x00, Soak_Setting_DEC_Not_Temp
24B7 1532       702            DEC Soak_Settings_Temp_hex
24B9 0224C1     703            ljmp Skip_DEC_Soak_Setting
24BC            704   Soak_Setting_DEC_Not_Temp:
24BC 1531       705            DEC Soak_Settings_T_hex
24BE 0224C1     706            ljmp Skip_DEC_Soak_Setting
24C1            707   Skip_DEC_Soak_Setting:
24C1            708            
24C1            709   ;now display the values onto the screen by converting them to BCD's
24C1 853247     710            mov x +0, Soak_Settings_Temp_hex
24C4 754800     710            mov x +1, #0x00
24C7 754900     710            mov x +2, #0x00
24CA 754A00     710            mov x +3, #0x00
24CD 120129     710            lcall hex2bcd
24D0 C0E0       710            push acc
24D2 7401       710            mov a, #1
24D4 14         710            dec a
24D5 1200BF     710            lcall ?Set_Cursor_2 ; Select column and row
24D8 D0E0       710            pop acc
24DA C000       710            push ar0
24DC A850       710            mov r0, bcd+1
24DE 1200C6     710            lcall ?Display_BCD
24E1 D000       710            pop ar0
24E3 C000       710            push ar0
24E5 A84F       710            mov r0, bcd+0
24E7 1200C6     710            lcall ?Display_BCD
24EA D000       710            pop ar0
24EC 853147     711            mov x +0, Soak_Settings_T_hex
24EF 754800     711            mov x +1, #0x00
24F2 754900     711            mov x +2, #0x00
24F5 754A00     711            mov x +3, #0x00
24F8 120129     711            lcall hex2bcd
24FB C0E0       711            push acc
24FD 740D       711            mov a, #13
24FF 14         711            dec a
2500 1200BF     711            lcall ?Set_Cursor_2 ; Select column and row
2503 D0E0       711            pop acc
2505 C000       711            push ar0
2507 A850       711            mov r0, bcd+1
2509 1200C6     711            lcall ?Display_BCD
250C D000       711            pop ar0
250E C000       711            push ar0
2510 A84F       711            mov r0, bcd+0
2512 1200C6     711            lcall ?Display_BCD
2515 D000       711            pop ar0
2517            712   
2517            713            ;finished displaying the correct values, continue.
2517 0223CE     714   ljmp Soak_Settings_Loop
251A            715   
251A            716   ;Reflow_Settings         
251A            717   Reflow_Settings:
251A            718                    ;display the current soaksettings and allow the user to change them.
251A C000       719            push AR0                ;used as the current selection tool
251C C0E0       720            push acc
251E C0E0       721            push acc
2520 7401       721            mov a, #1
2522 14         721            dec a
2523 1200C1     721            lcall ?Set_Cursor_1 ; Select column and row
2526 D0E0       721            pop acc
2528 C083       721            push dph
252A C082       721            push dpl
252C C0E0       721            push acc
252E 900D07     721            mov dptr, #CLEARLINE
2531 1200B4     721            lcall ?Send_Constant_String
2534 D0E0       721            pop acc
2536 D082       721            pop dpl
2538 D083       721            pop dph
253A C0E0       721            push acc
253C 7401       721            mov a, #1
253E 14         721            dec a
253F 1200BF     721            lcall ?Set_Cursor_2 ; Select column and row
2542 D0E0       721            pop acc
2544 C083       721            push dph
2546 C082       721            push dpl
2548 C0E0       721            push acc
254A 900D07     721            mov dptr, #CLEARLINE
254D 1200B4     721            lcall ?Send_Constant_String
2550 D0E0       721            pop acc
2552 D082       721            pop dpl
2554 D083       721            pop dph
2556 C0E0       721            push acc
2558 7401       721            mov a, #1
255A 14         721            dec a
255B 1200C1     721            lcall ?Set_Cursor_1 ; Select column and row
255E D0E0       721            pop acc
2560 C083       721            push dph
2562 C082       721            push dpl
2564 C0E0       721            push acc
2566 900EA3     721            mov dptr, #ReflowSettings1
2569 1200B4     721            lcall ?Send_Constant_String
256C D0E0       721            pop acc
256E D082       721            pop dpl
2570 D083       721            pop dph
2572 C0E0       721            push acc
2574 7401       721            mov a, #1
2576 14         721            dec a
2577 1200BF     721            lcall ?Set_Cursor_2 ; Select column and row
257A D0E0       721            pop acc
257C C083       721            push dph
257E C082       721            push dpl
2580 C0E0       721            push acc
2582 900D07     721            mov dptr, #CLEARLINE
2585 1200B4     721            lcall ?Send_Constant_String
2588 D0E0       721            pop acc
258A D082       721            pop dpl
258C D083       721            pop dph
258E 7800       722            mov R0, #0x00
2590 C0E0       723            push acc
2592 7405       723            mov a, #5
2594 14         723            dec a
2595 1200BF     723            lcall ?Set_Cursor_2 ; Select column and row
2598 D0E0       723            pop acc
259A C083       724            push dph
259C C082       724            push dpl
259E C0E0       724            push acc
25A0 900EB4     724            mov dptr, #leftpoint
25A3 1200B4     724            lcall ?Send_Constant_String
25A6 D0E0       724            pop acc
25A8 D082       724            pop dpl
25AA D083       724            pop dph
25AC            725   Reflow_Settings_Loop:
25AC            726            ;check to see if user is going to exit the program
25AC 20A714     727            jb B1, NOT_Exit_Reflow_Settings_Loop ; if the 'B0' button is not pressed skip
25AF C002       728            push AR2
25B1 7A32       728            mov R2, #50
25B3 120039     728            lcall ?Wait_Milli_Seconds
25B6 D002       728            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
25B8 20A708     729            jb B1, NOT_Exit_Reflow_Settings_Loop ; if the 'B0' button is not pressed skip
25BB 30A7FD     730            jnb B1, $
25BE D0E0       731            pop acc
25C0 D000       732            pop AR0
25C2 22         733            ret     
25C3            734   NOT_Exit_Reflow_Settings_Loop:
25C3            735   
25C3            736            ;first the cursor settings.
25C3 20A411     737            jb B3, Skip_INC_Cursor_Reflow_Settingstp ; if the 'B0' button is not pressed skip
25C6 C002       738            push AR2
25C8 7A32       738            mov R2, #50
25CA 120039     738            lcall ?Wait_Milli_Seconds
25CD D002       738            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
25CF 20A405     739            jb B3, Skip_INC_Cursor_Reflow_Settingstp ; if the 'B0' button is not pressed skip
25D2 30A4FD     740            jnb B3, $
25D5 8003       741            sjmp Reflow_Jump
25D7            742            
25D7            743   Skip_INC_Cursor_Reflow_Settingstp:
25D7 022659     744            ljmp Skip_INC_Cursor_Reflow_Settings
25DA            745            
25DA            746   Reflow_Jump:
25DA 08         747            Inc R0
25DB E8         748            mov a, R0
25DC B40204     749            cjne a, #0x02, Reflow_Cursor_No_Reset
25DF 7800       750            mov R0, #0x00
25E1 7400       751            mov a, #0x00
25E3            752   
25E3            753   Reflow_Cursor_No_Reset:
25E3 B4003B     754            cjne a, #0x00, Reflow_Cursor_Not_0
25E6 C0E0       755            push acc
25E8 7405       755            mov a, #5
25EA 14         755            dec a
25EB 1200BF     755            lcall ?Set_Cursor_2 ; Select column and row
25EE D0E0       755            pop acc
25F0 C083       756            push dph
25F2 C082       756            push dpl
25F4 C0E0       756            push acc
25F6 900EB4     756            mov dptr, #leftpoint
25F9 1200B4     756            lcall ?Send_Constant_String
25FC D0E0       756            pop acc
25FE D082       756            pop dpl
2600 D083       756            pop dph
2602 C0E0       757            push acc
2604 740C       757            mov a, #12
2606 14         757            dec a
2607 1200BF     757            lcall ?Set_Cursor_2 ; Select column and row
260A D0E0       757            pop acc
260C C083       758            push dph
260E C082       758            push dpl
2610 C0E0       758            push acc
2612 900EB8     758            mov dptr, #CLEARCHAR
2615 1200B4     758            lcall ?Send_Constant_String
2618 D0E0       758            pop acc
261A D082       758            pop dpl
261C D083       758            pop dph
261E 022659     759            ljmp Skip_INC_Cursor_Reflow_Settings
2621            760   Reflow_Cursor_Not_0:
2621 C0E0       761            push acc
2623 740C       761            mov a, #12
2625 14         761            dec a
2626 1200BF     761            lcall ?Set_Cursor_2 ; Select column and row
2629 D0E0       761            pop acc
262B C083       762            push dph
262D C082       762            push dpl
262F C0E0       762            push acc
2631 900EB6     762            mov dptr, #rightpoint
2634 1200B4     762            lcall ?Send_Constant_String
2637 D0E0       762            pop acc
2639 D082       762            pop dpl
263B D083       762            pop dph
263D C0E0       763            push acc
263F 7405       763            mov a, #5
2641 14         763            dec a
2642 1200BF     763            lcall ?Set_Cursor_2 ; Select column and row
2645 D0E0       763            pop acc
2647 C083       764            push dph
2649 C082       764            push dpl
264B C0E0       764            push acc
264D 900EB8     764            mov dptr, #CLEARCHAR
2650 1200B4     764            lcall ?Send_Constant_String
2653 D0E0       764            pop acc
2655 D082       764            pop dpl
2657 D083       764            pop dph
2659            765            
2659            766   Skip_INC_Cursor_Reflow_Settings:
2659            767            ;check if the user increments one of the options
2659 20A620     768            jb B0, Skip_INC_Reflow_Setting ; if the 'B0' button is not pressed skip
265C C002       769            push AR2
265E 7A0A       769            mov R2, #10
2660 120039     769            lcall ?Wait_Milli_Seconds
2663 D002       769            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2665 20A614     770            jb B0, Skip_INC_Reflow_Setting ; if the 'B0' button is not pressed skip
2668 30A6FD     771            jnb B0, $
266B 30A5FD     772            jnb B2, $
266E            773   
266E E8         774            mov a, R0
266F B40005     775            cjne a, #0x00, Reflow_Setting_INC_Not_Temp
2672 053D       776            INC Reflow_Settings_Temp_hex
2674 02267C     777            ljmp Skip_INC_Reflow_Setting
2677            778   Reflow_Setting_INC_Not_Temp:
2677 0539       779            INC Reflow_Settings_T_hex
2679 02267C     780            ljmp Skip_INC_Reflow_Setting
267C            781   Skip_INC_Reflow_Setting:
267C            782   
267C            783            ;check if the user decrements one of the options
267C 20A520     784            jb B2, Skip_DEC_Reflow_Setting ; if the 'B0' button is not pressed skip
267F C002       785            push AR2
2681 7A0A       785            mov R2, #10
2683 120039     785            lcall ?Wait_Milli_Seconds
2686 D002       785            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2688 20A514     786            jb B2, Skip_DEC_Reflow_Setting ; if the 'B0' button is not pressed skip
268B 30A5FD     787            jnb B2, $
268E 30A6FD     788            jnb B0, $
2691            789   
2691 E8         790            mov a, R0
2692 B40005     791            cjne a, #0x00, Reflow_Setting_DEC_Not_Temp
2695 153D       792            DEC Reflow_Settings_Temp_hex
2697 02269F     793            ljmp Skip_DEC_Reflow_Setting
269A            794   Reflow_Setting_DEC_Not_Temp:
269A 1539       795            DEC Reflow_Settings_T_hex
269C 02269F     796            ljmp Skip_DEC_Reflow_Setting
269F            797   Skip_DEC_Reflow_Setting:
269F            798            
269F            799   ;now display the values onto the screen by converting them to BCD's
269F 853D47     800            mov x +0, Reflow_Settings_Temp_hex
26A2 754800     800            mov x +1, #0x00
26A5 754900     800            mov x +2, #0x00
26A8 754A00     800            mov x +3, #0x00
26AB 120129     800            lcall hex2bcd
26AE C0E0       800            push acc
26B0 7401       800            mov a, #1
26B2 14         800            dec a
26B3 1200BF     800            lcall ?Set_Cursor_2 ; Select column and row
26B6 D0E0       800            pop acc
26B8 C000       800            push ar0
26BA A850       800            mov r0, bcd+1
26BC 1200C6     800            lcall ?Display_BCD
26BF D000       800            pop ar0
26C1 C000       800            push ar0
26C3 A84F       800            mov r0, bcd+0
26C5 1200C6     800            lcall ?Display_BCD
26C8 D000       800            pop ar0
26CA 853947     801            mov x +0, Reflow_Settings_T_hex
26CD 754800     801            mov x +1, #0x00
26D0 754900     801            mov x +2, #0x00
26D3 754A00     801            mov x +3, #0x00
26D6 120129     801            lcall hex2bcd
26D9 C0E0       801            push acc
26DB 740D       801            mov a, #13
26DD 14         801            dec a
26DE 1200BF     801            lcall ?Set_Cursor_2 ; Select column and row
26E1 D0E0       801            pop acc
26E3 C000       801            push ar0
26E5 A850       801            mov r0, bcd+1
26E7 1200C6     801            lcall ?Display_BCD
26EA D000       801            pop ar0
26EC C000       801            push ar0
26EE A84F       801            mov r0, bcd+0
26F0 1200C6     801            lcall ?Display_BCD
26F3 D000       801            pop ar0
26F5            802            
26F5            803            ;finished displaying the correct values, continue.
26F5 0225AC     804   ljmp Reflow_Settings_Loop
26F8            805   
26F8            806   Save_Settings:
26F8            807            ;prompt the user to save the current settings into one of the presets
26F8 C000       808            push AR0
26FA A830       809            mov R0, Current_Preset
26FC C000       810            Push AR0
26FE C0E0       811            push acc        
2700 C0E0       812            push acc
2702 7401       812            mov a, #1
2704 14         812            dec a
2705 1200C1     812            lcall ?Set_Cursor_1 ; Select column and row
2708 D0E0       812            pop acc
270A C083       812            push dph
270C C082       812            push dpl
270E C0E0       812            push acc
2710 900D07     812            mov dptr, #CLEARLINE
2713 1200B4     812            lcall ?Send_Constant_String
2716 D0E0       812            pop acc
2718 D082       812            pop dpl
271A D083       812            pop dph
271C C0E0       812            push acc
271E 7401       812            mov a, #1
2720 14         812            dec a
2721 1200BF     812            lcall ?Set_Cursor_2 ; Select column and row
2724 D0E0       812            pop acc
2726 C083       812            push dph
2728 C082       812            push dpl
272A C0E0       812            push acc
272C 900D07     812            mov dptr, #CLEARLINE
272F 1200B4     812            lcall ?Send_Constant_String
2732 D0E0       812            pop acc
2734 D082       812            pop dpl
2736 D083       812            pop dph
2738 C0E0       812            push acc
273A 7401       812            mov a, #1
273C 14         812            dec a
273D 1200C1     812            lcall ?Set_Cursor_1 ; Select column and row
2740 D0E0       812            pop acc
2742 C083       812            push dph
2744 C082       812            push dpl
2746 C0E0       812            push acc
2748 900E58     812            mov dptr, #SaveSettings
274B 1200B4     812            lcall ?Send_Constant_String
274E D0E0       812            pop acc
2750 D082       812            pop dpl
2752 D083       812            pop dph
2754 C0E0       812            push acc
2756 7401       812            mov a, #1
2758 14         812            dec a
2759 1200BF     812            lcall ?Set_Cursor_2 ; Select column and row
275C D0E0       812            pop acc
275E C083       812            push dph
2760 C082       812            push dpl
2762 C0E0       812            push acc
2764 900E68     812            mov dptr, #SaveSettings1
2767 1200B4     812            lcall ?Send_Constant_String
276A D0E0       812            pop acc
276C D082       812            pop dpl
276E D083       812            pop dph
2770            813   
2770            814   Save_Settings_Loop:
2770 20A768     815            jb B1, Save_Settings_Looptp ; if the 'B1' button is not pressed skip
2773 C002       816            push AR2
2775 7A32       816            mov R2, #50
2777 120039     816            lcall ?Wait_Milli_Seconds
277A D002       816            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
277C 20A75C     817            jb B1, Save_Settings_Looptp ; if the 'B1' button is not pressed skip
277F            818            ;if the button is pressed, exit the loop after saving the correct information into the appropriate slots
277F 30A7FD     819            jnb B1, $
2782            820            
2782            821            ;now check what preset to save to, and save the proper information to the global variables
2782 E530       822            mov a, Current_Preset
2784 B40117     823            cjne a, #0x01, Save_Not_1
2787 C0E0       824            push acc
2789            824   
2789 E531       824            mov a, Soak_Settings_T_hex
278B F533       824            mov Soak_Preset1_T_hex, a
278D E539       824            mov a, Reflow_Settings_T_hex
278F F53A       824            mov Reflow_Preset1_T_hex, a
2791            824            
2791 E532       824            mov a, Soak_Settings_Temp_hex
2793 F536       824            mov Soak_Preset1_Temp_hex, a
2795 E53D       824            mov a, Reflow_Settings_Temp_hex
2797 F53E       824            mov Reflow_Preset1_Temp_hex, a
2799            824   
2799 D0E0       824            pop acc
279B 0227D2     825            ljmp Save_Not_3
279E            826            
279E            827   Save_Not_1:
279E B40217     828            cjne a, #0x02, Save_Not_2
27A1 C0E0       829            push acc
27A3            829   
27A3 E531       829            mov a, Soak_Settings_T_hex
27A5 F534       829            mov Soak_Preset2_T_hex, a
27A7 E539       829            mov a, Reflow_Settings_T_hex
27A9 F53B       829            mov Reflow_Preset2_T_hex, a
27AB            829            
27AB E532       829            mov a, Soak_Settings_Temp_hex
27AD F537       829            mov Soak_Preset2_Temp_hex, a
27AF E53D       829            mov a, Reflow_Settings_Temp_hex
27B1 F53F       829            mov Reflow_Preset2_Temp_hex, a
27B3            829   
27B3 D0E0       829            pop acc
27B5 0227B8     830            ljmp Save_Not_2
27B8            831   Save_Not_2:
27B8 B40317     832            cjne a, #0x03, Save_Not_3
27BB C0E0       833            push acc
27BD            833   
27BD E531       833            mov a, Soak_Settings_T_hex
27BF F535       833            mov Soak_Preset3_T_hex, a
27C1 E539       833            mov a, Reflow_Settings_T_hex
27C3 F53C       833            mov Reflow_Preset3_T_hex, a
27C5            833            
27C5 E532       833            mov a, Soak_Settings_Temp_hex
27C7 F538       833            mov Soak_Preset3_Temp_hex, a
27C9 E53D       833            mov a, Reflow_Settings_Temp_hex
27CB F540       833            mov Reflow_Preset3_Temp_hex, a
27CD            833   
27CD D0E0       833            pop acc
27CF 0227D2     834            ljmp Save_Not_3
27D2            835   Save_Not_3:
27D2            836            ;exit the save and return to the main menu
27D2 D0E0       837            pop acc
27D4 D000       838            pop AR0
27D6 8830       839            mov Current_Preset, R0
27D8 D000       840            Pop AR0
27DA 22         841            ret                     
27DB            842            
27DB            843   Save_Settings_Looptp:
27DB E530       844            mov a, Current_Preset
27DD B40116     845            cjne a, #0x01, Save_Draw_Not_1
27E0 C0E0       846            push acc
27E2 740D       846            mov a, #13
27E4 14         846            dec a
27E5 1200BF     846            lcall ?Set_Cursor_2 ; Select column and row
27E8 D0E0       846            pop acc
27EA C0E0       847            push acc
27EC 7431       847            mov a, #'1'
27EE 12007E     847            lcall ?WriteData
27F1 D0E0       847            pop acc
27F3 022828     848            ljmp Save_Draw_Not_3
27F6            849   Save_Draw_Not_1:
27F6 B40216     850            cjne a, #0x02, Save_Draw_Not_2
27F9 C0E0       851            push acc
27FB 740D       851            mov a, #13
27FD 14         851            dec a
27FE 1200BF     851            lcall ?Set_Cursor_2 ; Select column and row
2801 D0E0       851            pop acc
2803 C0E0       852            push acc
2805 7432       852            mov a, #'2'
2807 12007E     852            lcall ?WriteData
280A D0E0       852            pop acc
280C 022828     853            ljmp Save_Draw_Not_3
280F            854   Save_Draw_Not_2:
280F B40316     855            cjne a, #0x03, Save_Draw_Not_3
2812 C0E0       856            push acc
2814 740D       856            mov a, #13
2816 14         856            dec a
2817 1200BF     856            lcall ?Set_Cursor_2 ; Select column and row
281A D0E0       856            pop acc
281C C0E0       857            push acc
281E 7433       857            mov a, #'3'
2820 12007E     857            lcall ?WriteData
2823 D0E0       857            pop acc
2825 022828     858            ljmp Save_Draw_Not_3
2828            859   Save_Draw_Not_3:
2828            860   
2828            861            ;now check for incrementing the position
2828 20A618     862            jb B0, Skip_INC_Settings_Preset ; if the 'B1' button is not pressed skip
282B C002       863            push AR2
282D 7A32       863            mov R2, #50
282F 120039     863            lcall ?Wait_Milli_Seconds
2832 D002       863            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2834 20A60C     864            jb B0, Skip_INC_Settings_Preset ; if the 'B1' button is not pressed skip
2837 30A6FD     865            jnb B0, $
283A            866            ;increment the settings preset,
283A 04         867            INC a
283B F530       868            mov Current_Preset, a
283D B40403     869            cjne a, #0x04, No_Reset_Preset_NUM              ;check if max
2840 753001     870            mov     Current_Preset, #0x01
2843            871   No_Reset_Preset_NUM:
2843            872            
2843            873   Skip_INC_Settings_Preset:
2843 022770     874            ljmp Save_Settings_Loop
2846            875            
2846            876   ;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;
2846            877   ;this Code needs to be added as the main page of the system
2846            878   ;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;;-----------------------------------------------------------------------;
2846            879   mainprogram:
2846            880            ;setting up the program
2846 75817F     881            mov SP, #0x7F
2849 120088     882       lcall LCD_4BIT
284C 120F58     883       lcall Setup_System
284F 120C96     884       lcall Display_System_Credits
2852            885       ;the home page of the system
2852 C000       886            push ar0
2854 C001       886            push ar1
2856 C002       886            push ar2
2858 C003       886            push ar3
285A C004       886            push ar4
285C C005       886            push ar5
285E C006       886            push ar6
2860 C007       886            push ar7
2862 C0E0       886            push acc
2864 7800       886            mov R0, #0x00                   ;R0 is the exit flag, reset the exit flag
2866 7900       886            mov R1, #0x00                   ;R1 is the Cursor position register
2868 7A00       886            mov R2, #0x00                   ;R2 is the number of functions flag
286A            886            
286A            886            
286A            886            ;We put the information about the functions in R2,bits 0,1,2 correspond to funcs 2,3,4
286A 7400       886            mov a, #0x00                    ;clear a
286C            886            ;jnb 1, Menu_No_Func_2
286C 7401       886            mov a, #0x01
286E B40101     886            cjne a, #0x01, Menu_No_Func_2473
2871 0A         886            inc R2
2872            886            ;orl a, #00000001B              ;put a 1 in bit 0 to indicate FUNC 2 activated
2872            886   Menu_No_Func_2473:
2872            886            ;jnb 1, Menu_No_Func_3
2872 7401       886            mov a, #0x01
2874 B40101     886            cjne a, #0x01, Menu_No_Func_3473
2877 0A         886            inc R2
2878            886            ;orl a, #00000010B              ;put a 1 in bit 1 to indicate FUNC 3 activated
2878            886   Menu_No_Func_3473:
2878            886            ;jnb 1, Menu_No_Func_4
2878 7401       886            mov a, #0x01
287A B40101     886            cjne a, #0x01, Menu_No_Func_4473
287D 0A         886            inc R2
287E            886            ;orl a, #00000100B              ;put a 1 in bit 2 to indicate FUNC 4 activated
287E            886   Menu_No_Func_4473:
287E            886                                    ;put the result into R2, this indicates the #of funcs   ;sets up the function flag register
287E            886            ;R2 is the function flag register
287E            886            
287E            886            ;display the screen after it has switched. This stays inside the 
287E            886            ;change cursor part so it only updates when pressed, not constantly.
287E E9         886            mov a, R1
287F B40079     886            cjne a, #0x00, Menu_Display_not_ONE474
2882 C0E0       886            push acc
2884 7401       886            mov a, #1
2886 14         886            dec a
2887 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
288A D0E0       886            pop acc
288C C083       886            push dph
288E C082       886            push dpl
2890 C0E0       886            push acc
2892 900D07     886            mov dptr, #CLEARLINE
2895 1200B4     886            lcall ?Send_Constant_String
2898 D0E0       886            pop acc
289A D082       886            pop dpl
289C D083       886            pop dph
289E C0E0       886            push acc
28A0 7401       886            mov a, #1
28A2 14         886            dec a
28A3 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
28A6 D0E0       886            pop acc
28A8 C083       886            push dph
28AA C082       886            push dpl
28AC C0E0       886            push acc
28AE 900D18     886            mov dptr, #HomeTop1
28B1 1200B4     886            lcall ?Send_Constant_String
28B4 D0E0       886            pop acc
28B6 D082       886            pop dpl
28B8 D083       886            pop dph                 ;display top half, cursor >
28BA            886            ;check if its required to display bottom half
28BA EA         886            mov a, R2
28BB 5402       886            anl a, #0x02
28BD B40238     886            cjne a, #0x02, Skip_Displaying_Bottom475
28C0 C0E0       886            push acc
28C2 7401       886            mov a, #1
28C4 14         886            dec a
28C5 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
28C8 D0E0       886            pop acc
28CA C083       886            push dph
28CC C082       886            push dpl
28CE C0E0       886            push acc
28D0 900D07     886            mov dptr, #CLEARLINE
28D3 1200B4     886            lcall ?Send_Constant_String
28D6 D0E0       886            pop acc
28D8 D082       886            pop dpl
28DA D083       886            pop dph
28DC C0E0       886            push acc
28DE 7401       886            mov a, #1
28E0 14         886            dec a
28E1 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
28E4 D0E0       886            pop acc
28E6 C083       886            push dph
28E8 C082       886            push dpl
28EA C0E0       886            push acc
28EC 900D6D     886            mov dptr, #HomeBtm3
28EF 1200B4     886            lcall ?Send_Constant_String
28F2 D0E0       886            pop acc
28F4 D082       886            pop dpl
28F6 D083       886            pop dph                 ;display bottom half no cursor
28F8            886   Skip_Displaying_Bottom475:                       
28F8 022A72     886            ljmp Menu_Done_Display_Cursor_Change474         
28FB            886                    
28FB            886   Menu_Display_not_ONE474:
28FB E9         886                    mov a, R1
28FC B40179     886                    cjne a, #0x01, Menu_Display_not_TWO474
28FF C0E0       886            push acc
2901 7401       886            mov a, #1
2903 14         886            dec a
2904 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2907 D0E0       886            pop acc
2909 C083       886            push dph
290B C082       886            push dpl
290D C0E0       886            push acc
290F 900D07     886            mov dptr, #CLEARLINE
2912 1200B4     886            lcall ?Send_Constant_String
2915 D0E0       886            pop acc
2917 D082       886            pop dpl
2919 D083       886            pop dph
291B C0E0       886            push acc
291D 7401       886            mov a, #1
291F 14         886            dec a
2920 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2923 D0E0       886            pop acc
2925 C083       886            push dph
2927 C082       886            push dpl
2929 C0E0       886            push acc
292B 900D29     886            mov dptr, #HomeTop2
292E 1200B4     886            lcall ?Send_Constant_String
2931 D0E0       886            pop acc
2933 D082       886            pop dpl
2935 D083       886            pop dph                 ;display top half, cursor >
2937            886            ;check if its required to display bottom half
2937 EA         886            mov a, R2
2938 5402       886            anl a, #0x02
293A B40238     886            cjne a, #0x02, Skip_Displaying_Bottom484
293D C0E0       886            push acc
293F 7401       886            mov a, #1
2941 14         886            dec a
2942 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2945 D0E0       886            pop acc
2947 C083       886            push dph
2949 C082       886            push dpl
294B C0E0       886            push acc
294D 900D07     886            mov dptr, #CLEARLINE
2950 1200B4     886            lcall ?Send_Constant_String
2953 D0E0       886            pop acc
2955 D082       886            pop dpl
2957 D083       886            pop dph
2959 C0E0       886            push acc
295B 7401       886            mov a, #1
295D 14         886            dec a
295E 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2961 D0E0       886            pop acc
2963 C083       886            push dph
2965 C082       886            push dpl
2967 C0E0       886            push acc
2969 900D6D     886            mov dptr, #HomeBtm3
296C 1200B4     886            lcall ?Send_Constant_String
296F D0E0       886            pop acc
2971 D082       886            pop dpl
2973 D083       886            pop dph                 ;display bottom half no cursor
2975            886   Skip_Displaying_Bottom484:
2975 022A72     886                    ljmp Menu_Done_Display_Cursor_Change474
2978            886                                    
2978            886   Menu_Display_not_TWO474:
2978 E9         886                    mov a, R1
2979 B40279     886                    cjne a, #0x02, Menu_Display_not_THREE474
297C C0E0       886            push acc
297E 7401       886            mov a, #1
2980 14         886            dec a
2981 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2984 D0E0       886            pop acc
2986 C083       886            push dph
2988 C082       886            push dpl
298A C0E0       886            push acc
298C 900D07     886            mov dptr, #CLEARLINE
298F 1200B4     886            lcall ?Send_Constant_String
2992 D0E0       886            pop acc
2994 D082       886            pop dpl
2996 D083       886            pop dph
2998 C0E0       886            push acc
299A 7401       886            mov a, #1
299C 14         886            dec a
299D 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
29A0 D0E0       886            pop acc
29A2 C083       886            push dph
29A4 C082       886            push dpl
29A6 C0E0       886            push acc
29A8 900D3A     886            mov dptr, #HomeTop3
29AB 1200B4     886            lcall ?Send_Constant_String
29AE D0E0       886            pop acc
29B0 D082       886            pop dpl
29B2 D083       886            pop dph                 ;display top half, cursor >
29B4            886            ;check if its required to display bottom half
29B4 EA         886            mov a, R2
29B5 5402       886            anl a, #0x02
29B7 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom493
29BA C0E0       886            push acc
29BC 7401       886            mov a, #1
29BE 14         886            dec a
29BF 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
29C2 D0E0       886            pop acc
29C4 C083       886            push dph
29C6 C082       886            push dpl
29C8 C0E0       886            push acc
29CA 900D07     886            mov dptr, #CLEARLINE
29CD 1200B4     886            lcall ?Send_Constant_String
29D0 D0E0       886            pop acc
29D2 D082       886            pop dpl
29D4 D083       886            pop dph
29D6 C0E0       886            push acc
29D8 7401       886            mov a, #1
29DA 14         886            dec a
29DB 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
29DE D0E0       886            pop acc
29E0 C083       886            push dph
29E2 C082       886            push dpl
29E4 C0E0       886            push acc
29E6 900D4B     886            mov dptr, #HomeBtm1
29E9 1200B4     886            lcall ?Send_Constant_String
29EC D0E0       886            pop acc
29EE D082       886            pop dpl
29F0 D083       886            pop dph                 ;display bottom half no cursor
29F2            886   Skip_Displaying_Bottom493:
29F2 022A72     886                    ljmp Menu_Done_Display_Cursor_Change474
29F5            886                                    
29F5            886   Menu_Display_not_THREE474:
29F5 E9         886                    mov a, R1
29F6 B40379     886                    cjne a, #0x03, Menu_Display_not_FOUR474
29F9 C0E0       886            push acc
29FB 7401       886            mov a, #1
29FD 14         886            dec a
29FE 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2A01 D0E0       886            pop acc
2A03 C083       886            push dph
2A05 C082       886            push dpl
2A07 C0E0       886            push acc
2A09 900D07     886            mov dptr, #CLEARLINE
2A0C 1200B4     886            lcall ?Send_Constant_String
2A0F D0E0       886            pop acc
2A11 D082       886            pop dpl
2A13 D083       886            pop dph
2A15 C0E0       886            push acc
2A17 7401       886            mov a, #1
2A19 14         886            dec a
2A1A 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2A1D D0E0       886            pop acc
2A1F C083       886            push dph
2A21 C082       886            push dpl
2A23 C0E0       886            push acc
2A25 900D3A     886            mov dptr, #HomeTop3
2A28 1200B4     886            lcall ?Send_Constant_String
2A2B D0E0       886            pop acc
2A2D D082       886            pop dpl
2A2F D083       886            pop dph                 ;display top half, cursor >
2A31            886            ;check if its required to display bottom half
2A31 EA         886            mov a, R2
2A32 5402       886            anl a, #0x02
2A34 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom502
2A37 C0E0       886            push acc
2A39 7401       886            mov a, #1
2A3B 14         886            dec a
2A3C 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2A3F D0E0       886            pop acc
2A41 C083       886            push dph
2A43 C082       886            push dpl
2A45 C0E0       886            push acc
2A47 900D07     886            mov dptr, #CLEARLINE
2A4A 1200B4     886            lcall ?Send_Constant_String
2A4D D0E0       886            pop acc
2A4F D082       886            pop dpl
2A51 D083       886            pop dph
2A53 C0E0       886            push acc
2A55 7401       886            mov a, #1
2A57 14         886            dec a
2A58 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2A5B D0E0       886            pop acc
2A5D C083       886            push dph
2A5F C082       886            push dpl
2A61 C0E0       886            push acc
2A63 900D5C     886            mov dptr, #HomeBtm2
2A66 1200B4     886            lcall ?Send_Constant_String
2A69 D0E0       886            pop acc
2A6B D082       886            pop dpl
2A6D D083       886            pop dph                 ;display bottom half no cursor
2A6F            886   Skip_Displaying_Bottom502:       
2A6F 022A72     886                    ljmp Menu_Done_Display_Cursor_Change474
2A72            886                                    
2A72            886   Menu_Display_not_FOUR474:
2A72            886   Menu_Done_Display_Cursor_Change474:      ;display on LCD
2A72            886   
2A72            886   ;The loop that will happen over and over in each level of the menu
2A72            886   Menu_Loop472:
2A72            886   
2A72            886            ;First, Check to see if the user wants to INC the cursors location
2A72 20A614     886            jb B0, Menu_Skip_Cursor_INCtp472        ; if the 'B0' button is not pressed skip
2A75 C002       886            push AR2
2A77 7A0A       886            mov R2, #10
2A79 120039     886            lcall ?Wait_Milli_Seconds
2A7C D002       886            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2A7E 20A608     886            jb B0, Menu_Skip_Cursor_INCtp472        ; if the 'B0' button is not pressed skip
2A81 30A6FD     886            jnb B0, $                               ; Wait for button release.
2A84 30A5FD     886            jnb B2, $                               ; Wait for button release.
2A87            886            ;The below code is used to get around the max jb jump distance
2A87 8003       886            sjmp Menu_INC_Cursor472
2A89            886   Menu_Skip_Cursor_INCtp472:
2A89 022C84     886            ljmp Menu_Skip_Cursor_INC472
2A8C            886   Menu_INC_Cursor472:      
2A8C 09         886            INC R1                                                  ;increment the cursors position
2A8D 1210C0     886            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
2A90            886            ;display the screen after it has switched. This stays inside the 
2A90            886            ;change cursor part so it only updates when pressed, not constantly.
2A90 E9         886            mov a, R1
2A91 B40079     886            cjne a, #0x00, Menu_Display_not_ONE512
2A94 C0E0       886            push acc
2A96 7401       886            mov a, #1
2A98 14         886            dec a
2A99 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2A9C D0E0       886            pop acc
2A9E C083       886            push dph
2AA0 C082       886            push dpl
2AA2 C0E0       886            push acc
2AA4 900D07     886            mov dptr, #CLEARLINE
2AA7 1200B4     886            lcall ?Send_Constant_String
2AAA D0E0       886            pop acc
2AAC D082       886            pop dpl
2AAE D083       886            pop dph
2AB0 C0E0       886            push acc
2AB2 7401       886            mov a, #1
2AB4 14         886            dec a
2AB5 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2AB8 D0E0       886            pop acc
2ABA C083       886            push dph
2ABC C082       886            push dpl
2ABE C0E0       886            push acc
2AC0 900D18     886            mov dptr, #HomeTop1
2AC3 1200B4     886            lcall ?Send_Constant_String
2AC6 D0E0       886            pop acc
2AC8 D082       886            pop dpl
2ACA D083       886            pop dph                 ;display top half, cursor >
2ACC            886            ;check if its required to display bottom half
2ACC EA         886            mov a, R2
2ACD 5402       886            anl a, #0x02
2ACF B40238     886            cjne a, #0x02, Skip_Displaying_Bottom513
2AD2 C0E0       886            push acc
2AD4 7401       886            mov a, #1
2AD6 14         886            dec a
2AD7 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2ADA D0E0       886            pop acc
2ADC C083       886            push dph
2ADE C082       886            push dpl
2AE0 C0E0       886            push acc
2AE2 900D07     886            mov dptr, #CLEARLINE
2AE5 1200B4     886            lcall ?Send_Constant_String
2AE8 D0E0       886            pop acc
2AEA D082       886            pop dpl
2AEC D083       886            pop dph
2AEE C0E0       886            push acc
2AF0 7401       886            mov a, #1
2AF2 14         886            dec a
2AF3 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2AF6 D0E0       886            pop acc
2AF8 C083       886            push dph
2AFA C082       886            push dpl
2AFC C0E0       886            push acc
2AFE 900D6D     886            mov dptr, #HomeBtm3
2B01 1200B4     886            lcall ?Send_Constant_String
2B04 D0E0       886            pop acc
2B06 D082       886            pop dpl
2B08 D083       886            pop dph                 ;display bottom half no cursor
2B0A            886   Skip_Displaying_Bottom513:                       
2B0A 022C84     886            ljmp Menu_Done_Display_Cursor_Change512         
2B0D            886                    
2B0D            886   Menu_Display_not_ONE512:
2B0D E9         886                    mov a, R1
2B0E B40179     886                    cjne a, #0x01, Menu_Display_not_TWO512
2B11 C0E0       886            push acc
2B13 7401       886            mov a, #1
2B15 14         886            dec a
2B16 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2B19 D0E0       886            pop acc
2B1B C083       886            push dph
2B1D C082       886            push dpl
2B1F C0E0       886            push acc
2B21 900D07     886            mov dptr, #CLEARLINE
2B24 1200B4     886            lcall ?Send_Constant_String
2B27 D0E0       886            pop acc
2B29 D082       886            pop dpl
2B2B D083       886            pop dph
2B2D C0E0       886            push acc
2B2F 7401       886            mov a, #1
2B31 14         886            dec a
2B32 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2B35 D0E0       886            pop acc
2B37 C083       886            push dph
2B39 C082       886            push dpl
2B3B C0E0       886            push acc
2B3D 900D29     886            mov dptr, #HomeTop2
2B40 1200B4     886            lcall ?Send_Constant_String
2B43 D0E0       886            pop acc
2B45 D082       886            pop dpl
2B47 D083       886            pop dph                 ;display top half, cursor >
2B49            886            ;check if its required to display bottom half
2B49 EA         886            mov a, R2
2B4A 5402       886            anl a, #0x02
2B4C B40238     886            cjne a, #0x02, Skip_Displaying_Bottom522
2B4F C0E0       886            push acc
2B51 7401       886            mov a, #1
2B53 14         886            dec a
2B54 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2B57 D0E0       886            pop acc
2B59 C083       886            push dph
2B5B C082       886            push dpl
2B5D C0E0       886            push acc
2B5F 900D07     886            mov dptr, #CLEARLINE
2B62 1200B4     886            lcall ?Send_Constant_String
2B65 D0E0       886            pop acc
2B67 D082       886            pop dpl
2B69 D083       886            pop dph
2B6B C0E0       886            push acc
2B6D 7401       886            mov a, #1
2B6F 14         886            dec a
2B70 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2B73 D0E0       886            pop acc
2B75 C083       886            push dph
2B77 C082       886            push dpl
2B79 C0E0       886            push acc
2B7B 900D6D     886            mov dptr, #HomeBtm3
2B7E 1200B4     886            lcall ?Send_Constant_String
2B81 D0E0       886            pop acc
2B83 D082       886            pop dpl
2B85 D083       886            pop dph                 ;display bottom half no cursor
2B87            886   Skip_Displaying_Bottom522:
2B87 022C84     886                    ljmp Menu_Done_Display_Cursor_Change512
2B8A            886                                    
2B8A            886   Menu_Display_not_TWO512:
2B8A E9         886                    mov a, R1
2B8B B40279     886                    cjne a, #0x02, Menu_Display_not_THREE512
2B8E C0E0       886            push acc
2B90 7401       886            mov a, #1
2B92 14         886            dec a
2B93 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2B96 D0E0       886            pop acc
2B98 C083       886            push dph
2B9A C082       886            push dpl
2B9C C0E0       886            push acc
2B9E 900D07     886            mov dptr, #CLEARLINE
2BA1 1200B4     886            lcall ?Send_Constant_String
2BA4 D0E0       886            pop acc
2BA6 D082       886            pop dpl
2BA8 D083       886            pop dph
2BAA C0E0       886            push acc
2BAC 7401       886            mov a, #1
2BAE 14         886            dec a
2BAF 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2BB2 D0E0       886            pop acc
2BB4 C083       886            push dph
2BB6 C082       886            push dpl
2BB8 C0E0       886            push acc
2BBA 900D3A     886            mov dptr, #HomeTop3
2BBD 1200B4     886            lcall ?Send_Constant_String
2BC0 D0E0       886            pop acc
2BC2 D082       886            pop dpl
2BC4 D083       886            pop dph                 ;display top half, cursor >
2BC6            886            ;check if its required to display bottom half
2BC6 EA         886            mov a, R2
2BC7 5402       886            anl a, #0x02
2BC9 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom531
2BCC C0E0       886            push acc
2BCE 7401       886            mov a, #1
2BD0 14         886            dec a
2BD1 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2BD4 D0E0       886            pop acc
2BD6 C083       886            push dph
2BD8 C082       886            push dpl
2BDA C0E0       886            push acc
2BDC 900D07     886            mov dptr, #CLEARLINE
2BDF 1200B4     886            lcall ?Send_Constant_String
2BE2 D0E0       886            pop acc
2BE4 D082       886            pop dpl
2BE6 D083       886            pop dph
2BE8 C0E0       886            push acc
2BEA 7401       886            mov a, #1
2BEC 14         886            dec a
2BED 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2BF0 D0E0       886            pop acc
2BF2 C083       886            push dph
2BF4 C082       886            push dpl
2BF6 C0E0       886            push acc
2BF8 900D4B     886            mov dptr, #HomeBtm1
2BFB 1200B4     886            lcall ?Send_Constant_String
2BFE D0E0       886            pop acc
2C00 D082       886            pop dpl
2C02 D083       886            pop dph                 ;display bottom half no cursor
2C04            886   Skip_Displaying_Bottom531:
2C04 022C84     886                    ljmp Menu_Done_Display_Cursor_Change512
2C07            886                                    
2C07            886   Menu_Display_not_THREE512:
2C07 E9         886                    mov a, R1
2C08 B40379     886                    cjne a, #0x03, Menu_Display_not_FOUR512
2C0B C0E0       886            push acc
2C0D 7401       886            mov a, #1
2C0F 14         886            dec a
2C10 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2C13 D0E0       886            pop acc
2C15 C083       886            push dph
2C17 C082       886            push dpl
2C19 C0E0       886            push acc
2C1B 900D07     886            mov dptr, #CLEARLINE
2C1E 1200B4     886            lcall ?Send_Constant_String
2C21 D0E0       886            pop acc
2C23 D082       886            pop dpl
2C25 D083       886            pop dph
2C27 C0E0       886            push acc
2C29 7401       886            mov a, #1
2C2B 14         886            dec a
2C2C 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2C2F D0E0       886            pop acc
2C31 C083       886            push dph
2C33 C082       886            push dpl
2C35 C0E0       886            push acc
2C37 900D3A     886            mov dptr, #HomeTop3
2C3A 1200B4     886            lcall ?Send_Constant_String
2C3D D0E0       886            pop acc
2C3F D082       886            pop dpl
2C41 D083       886            pop dph                 ;display top half, cursor >
2C43            886            ;check if its required to display bottom half
2C43 EA         886            mov a, R2
2C44 5402       886            anl a, #0x02
2C46 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom540
2C49 C0E0       886            push acc
2C4B 7401       886            mov a, #1
2C4D 14         886            dec a
2C4E 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2C51 D0E0       886            pop acc
2C53 C083       886            push dph
2C55 C082       886            push dpl
2C57 C0E0       886            push acc
2C59 900D07     886            mov dptr, #CLEARLINE
2C5C 1200B4     886            lcall ?Send_Constant_String
2C5F D0E0       886            pop acc
2C61 D082       886            pop dpl
2C63 D083       886            pop dph
2C65 C0E0       886            push acc
2C67 7401       886            mov a, #1
2C69 14         886            dec a
2C6A 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2C6D D0E0       886            pop acc
2C6F C083       886            push dph
2C71 C082       886            push dpl
2C73 C0E0       886            push acc
2C75 900D5C     886            mov dptr, #HomeBtm2
2C78 1200B4     886            lcall ?Send_Constant_String
2C7B D0E0       886            pop acc
2C7D D082       886            pop dpl
2C7F D083       886            pop dph                 ;display bottom half no cursor
2C81            886   Skip_Displaying_Bottom540:       
2C81 022C84     886                    ljmp Menu_Done_Display_Cursor_Change512
2C84            886                                    
2C84            886   Menu_Display_not_FOUR512:
2C84            886   Menu_Done_Display_Cursor_Change512:      ;display on LCD
2C84            886            
2C84            886   Menu_Skip_Cursor_INC472:
2C84            886   
2C84            886            ;Then, Check to see if the user wants to DEC the cursors location
2C84 20A514     886            jb B2, Menu_Skip_Cursor_DECtp472        ; if the 'B0' button is not pressed skip
2C87 C002       886            push AR2
2C89 7A0A       886            mov R2, #10
2C8B 120039     886            lcall ?Wait_Milli_Seconds
2C8E D002       886            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2C90 20A508     886            jb B2, Menu_Skip_Cursor_DECtp472        ; if the 'B0' button is not pressed skip
2C93 30A5FD     886            jnb B2, $                               ; Wait for button release.
2C96 30A6FD     886            jnb B0, $                               ; Wait for button release.
2C99            886            ;The below code is used to get around the max jb jump distance
2C99 8003       886            sjmp Menu_DEC_Cursor472
2C9B            886   Menu_Skip_Cursor_DECtp472:
2C9B 022E96     886            ljmp Menu_Skip_Cursor_DEC472
2C9E            886   Menu_DEC_Cursor472:      
2C9E 19         886            DEC R1                                                  ;increment the cursors position
2C9F 1210C0     886            lcall Menu_Change_Cursor_Func                           ;verify cursors position.
2CA2            886            ;display the screen after it has switched. This stays inside the 
2CA2            886            ;change cursor part so it only updates when pressed, not constantly.
2CA2 E9         886            mov a, R1
2CA3 B40079     886            cjne a, #0x00, Menu_Display_not_ONE550
2CA6 C0E0       886            push acc
2CA8 7401       886            mov a, #1
2CAA 14         886            dec a
2CAB 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2CAE D0E0       886            pop acc
2CB0 C083       886            push dph
2CB2 C082       886            push dpl
2CB4 C0E0       886            push acc
2CB6 900D07     886            mov dptr, #CLEARLINE
2CB9 1200B4     886            lcall ?Send_Constant_String
2CBC D0E0       886            pop acc
2CBE D082       886            pop dpl
2CC0 D083       886            pop dph
2CC2 C0E0       886            push acc
2CC4 7401       886            mov a, #1
2CC6 14         886            dec a
2CC7 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2CCA D0E0       886            pop acc
2CCC C083       886            push dph
2CCE C082       886            push dpl
2CD0 C0E0       886            push acc
2CD2 900D18     886            mov dptr, #HomeTop1
2CD5 1200B4     886            lcall ?Send_Constant_String
2CD8 D0E0       886            pop acc
2CDA D082       886            pop dpl
2CDC D083       886            pop dph                 ;display top half, cursor >
2CDE            886            ;check if its required to display bottom half
2CDE EA         886            mov a, R2
2CDF 5402       886            anl a, #0x02
2CE1 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom551
2CE4 C0E0       886            push acc
2CE6 7401       886            mov a, #1
2CE8 14         886            dec a
2CE9 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2CEC D0E0       886            pop acc
2CEE C083       886            push dph
2CF0 C082       886            push dpl
2CF2 C0E0       886            push acc
2CF4 900D07     886            mov dptr, #CLEARLINE
2CF7 1200B4     886            lcall ?Send_Constant_String
2CFA D0E0       886            pop acc
2CFC D082       886            pop dpl
2CFE D083       886            pop dph
2D00 C0E0       886            push acc
2D02 7401       886            mov a, #1
2D04 14         886            dec a
2D05 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2D08 D0E0       886            pop acc
2D0A C083       886            push dph
2D0C C082       886            push dpl
2D0E C0E0       886            push acc
2D10 900D6D     886            mov dptr, #HomeBtm3
2D13 1200B4     886            lcall ?Send_Constant_String
2D16 D0E0       886            pop acc
2D18 D082       886            pop dpl
2D1A D083       886            pop dph                 ;display bottom half no cursor
2D1C            886   Skip_Displaying_Bottom551:                       
2D1C 022E96     886            ljmp Menu_Done_Display_Cursor_Change550         
2D1F            886                    
2D1F            886   Menu_Display_not_ONE550:
2D1F E9         886                    mov a, R1
2D20 B40179     886                    cjne a, #0x01, Menu_Display_not_TWO550
2D23 C0E0       886            push acc
2D25 7401       886            mov a, #1
2D27 14         886            dec a
2D28 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2D2B D0E0       886            pop acc
2D2D C083       886            push dph
2D2F C082       886            push dpl
2D31 C0E0       886            push acc
2D33 900D07     886            mov dptr, #CLEARLINE
2D36 1200B4     886            lcall ?Send_Constant_String
2D39 D0E0       886            pop acc
2D3B D082       886            pop dpl
2D3D D083       886            pop dph
2D3F C0E0       886            push acc
2D41 7401       886            mov a, #1
2D43 14         886            dec a
2D44 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2D47 D0E0       886            pop acc
2D49 C083       886            push dph
2D4B C082       886            push dpl
2D4D C0E0       886            push acc
2D4F 900D29     886            mov dptr, #HomeTop2
2D52 1200B4     886            lcall ?Send_Constant_String
2D55 D0E0       886            pop acc
2D57 D082       886            pop dpl
2D59 D083       886            pop dph                 ;display top half, cursor >
2D5B            886            ;check if its required to display bottom half
2D5B EA         886            mov a, R2
2D5C 5402       886            anl a, #0x02
2D5E B40238     886            cjne a, #0x02, Skip_Displaying_Bottom560
2D61 C0E0       886            push acc
2D63 7401       886            mov a, #1
2D65 14         886            dec a
2D66 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2D69 D0E0       886            pop acc
2D6B C083       886            push dph
2D6D C082       886            push dpl
2D6F C0E0       886            push acc
2D71 900D07     886            mov dptr, #CLEARLINE
2D74 1200B4     886            lcall ?Send_Constant_String
2D77 D0E0       886            pop acc
2D79 D082       886            pop dpl
2D7B D083       886            pop dph
2D7D C0E0       886            push acc
2D7F 7401       886            mov a, #1
2D81 14         886            dec a
2D82 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2D85 D0E0       886            pop acc
2D87 C083       886            push dph
2D89 C082       886            push dpl
2D8B C0E0       886            push acc
2D8D 900D6D     886            mov dptr, #HomeBtm3
2D90 1200B4     886            lcall ?Send_Constant_String
2D93 D0E0       886            pop acc
2D95 D082       886            pop dpl
2D97 D083       886            pop dph                 ;display bottom half no cursor
2D99            886   Skip_Displaying_Bottom560:
2D99 022E96     886                    ljmp Menu_Done_Display_Cursor_Change550
2D9C            886                                    
2D9C            886   Menu_Display_not_TWO550:
2D9C E9         886                    mov a, R1
2D9D B40279     886                    cjne a, #0x02, Menu_Display_not_THREE550
2DA0 C0E0       886            push acc
2DA2 7401       886            mov a, #1
2DA4 14         886            dec a
2DA5 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2DA8 D0E0       886            pop acc
2DAA C083       886            push dph
2DAC C082       886            push dpl
2DAE C0E0       886            push acc
2DB0 900D07     886            mov dptr, #CLEARLINE
2DB3 1200B4     886            lcall ?Send_Constant_String
2DB6 D0E0       886            pop acc
2DB8 D082       886            pop dpl
2DBA D083       886            pop dph
2DBC C0E0       886            push acc
2DBE 7401       886            mov a, #1
2DC0 14         886            dec a
2DC1 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2DC4 D0E0       886            pop acc
2DC6 C083       886            push dph
2DC8 C082       886            push dpl
2DCA C0E0       886            push acc
2DCC 900D3A     886            mov dptr, #HomeTop3
2DCF 1200B4     886            lcall ?Send_Constant_String
2DD2 D0E0       886            pop acc
2DD4 D082       886            pop dpl
2DD6 D083       886            pop dph                 ;display top half, cursor >
2DD8            886            ;check if its required to display bottom half
2DD8 EA         886            mov a, R2
2DD9 5402       886            anl a, #0x02
2DDB B40238     886            cjne a, #0x02, Skip_Displaying_Bottom569
2DDE C0E0       886            push acc
2DE0 7401       886            mov a, #1
2DE2 14         886            dec a
2DE3 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2DE6 D0E0       886            pop acc
2DE8 C083       886            push dph
2DEA C082       886            push dpl
2DEC C0E0       886            push acc
2DEE 900D07     886            mov dptr, #CLEARLINE
2DF1 1200B4     886            lcall ?Send_Constant_String
2DF4 D0E0       886            pop acc
2DF6 D082       886            pop dpl
2DF8 D083       886            pop dph
2DFA C0E0       886            push acc
2DFC 7401       886            mov a, #1
2DFE 14         886            dec a
2DFF 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2E02 D0E0       886            pop acc
2E04 C083       886            push dph
2E06 C082       886            push dpl
2E08 C0E0       886            push acc
2E0A 900D4B     886            mov dptr, #HomeBtm1
2E0D 1200B4     886            lcall ?Send_Constant_String
2E10 D0E0       886            pop acc
2E12 D082       886            pop dpl
2E14 D083       886            pop dph                 ;display bottom half no cursor
2E16            886   Skip_Displaying_Bottom569:
2E16 022E96     886                    ljmp Menu_Done_Display_Cursor_Change550
2E19            886                                    
2E19            886   Menu_Display_not_THREE550:
2E19 E9         886                    mov a, R1
2E1A B40379     886                    cjne a, #0x03, Menu_Display_not_FOUR550
2E1D C0E0       886            push acc
2E1F 7401       886            mov a, #1
2E21 14         886            dec a
2E22 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2E25 D0E0       886            pop acc
2E27 C083       886            push dph
2E29 C082       886            push dpl
2E2B C0E0       886            push acc
2E2D 900D07     886            mov dptr, #CLEARLINE
2E30 1200B4     886            lcall ?Send_Constant_String
2E33 D0E0       886            pop acc
2E35 D082       886            pop dpl
2E37 D083       886            pop dph
2E39 C0E0       886            push acc
2E3B 7401       886            mov a, #1
2E3D 14         886            dec a
2E3E 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2E41 D0E0       886            pop acc
2E43 C083       886            push dph
2E45 C082       886            push dpl
2E47 C0E0       886            push acc
2E49 900D3A     886            mov dptr, #HomeTop3
2E4C 1200B4     886            lcall ?Send_Constant_String
2E4F D0E0       886            pop acc
2E51 D082       886            pop dpl
2E53 D083       886            pop dph                 ;display top half, cursor >
2E55            886            ;check if its required to display bottom half
2E55 EA         886            mov a, R2
2E56 5402       886            anl a, #0x02
2E58 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom578
2E5B C0E0       886            push acc
2E5D 7401       886            mov a, #1
2E5F 14         886            dec a
2E60 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2E63 D0E0       886            pop acc
2E65 C083       886            push dph
2E67 C082       886            push dpl
2E69 C0E0       886            push acc
2E6B 900D07     886            mov dptr, #CLEARLINE
2E6E 1200B4     886            lcall ?Send_Constant_String
2E71 D0E0       886            pop acc
2E73 D082       886            pop dpl
2E75 D083       886            pop dph
2E77 C0E0       886            push acc
2E79 7401       886            mov a, #1
2E7B 14         886            dec a
2E7C 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2E7F D0E0       886            pop acc
2E81 C083       886            push dph
2E83 C082       886            push dpl
2E85 C0E0       886            push acc
2E87 900D5C     886            mov dptr, #HomeBtm2
2E8A 1200B4     886            lcall ?Send_Constant_String
2E8D D0E0       886            pop acc
2E8F D082       886            pop dpl
2E91 D083       886            pop dph                 ;display bottom half no cursor
2E93            886   Skip_Displaying_Bottom578:       
2E93 022E96     886                    ljmp Menu_Done_Display_Cursor_Change550
2E96            886                                    
2E96            886   Menu_Display_not_FOUR550:
2E96            886   Menu_Done_Display_Cursor_Change550:      ;display on LCD
2E96            886            
2E96            886   Menu_Skip_Cursor_DEC472:
2E96            886   
2E96            886            ;Check if the user wanted to exit the level of the menu
2E96 E8         886            mov a, R0
2E97 B40105     886            cjne a, #0x01, Menu_Stay472     ;if the flag is not 1, continue program, otherwise reset flag and return
2E9A 7800       886            mov R0, #0x00
2E9C 0230DA     886            ljmp Menu_Exit_Level472
2E9F            886            
2E9F            886   Menu_Stay472:    
2E9F            886            ;now the code that operates when the "select" button is pressed
2E9F 20A711     886            jb B1, Menu_Skip_Select_Changetp472     ; if the 'B1' button is not pressed skip
2EA2 C002       886            push AR2
2EA4 7A32       886            mov R2, #50
2EA6 120039     886            lcall ?Wait_Milli_Seconds
2EA9 D002       886            pop AR2                         ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
2EAB 20A705     886            jb B1, Menu_Skip_Select_Changetp472     ; if the 'B1' button is not pressed skip
2EAE 30A7FD     886            jnb B1, $                               ; Wait for button release
2EB1            886            ;The below code is used to get around the max jb jump distance 
2EB1 8003       886            sjmp Menu_Select_Change472
2EB3            886   Menu_Skip_Select_Changetp472:
2EB3 0230D4     886            ljmp Menu_Skip_Select_Change472         ;the button was not pressed.
2EB6            886            
2EB6            886   Menu_Select_Change472:
2EB6            886            
2EB6            886   ;We simply compare what number is in the cursor and enter that function
2EB6 E9         886            mov a, R1
2EB7 B40006     886            cjne a, #0x00, Menu_Not_Func_One_Select588
2EBA            886            ;if here, then the cursor is on the above position
2EBA 123284     886            lcall Start_Process
2EBD 022EDE     886            ljmp Menu_Done_Func588
2EC0            886                            
2EC0            886   Menu_Not_Func_One_Select588:
2EC0 E9         886                    mov a, R1
2EC1 B40106     886            cjne a, #0x01, Menu_Not_Func_Two_Select588
2EC4            886            ;if here, then the cursor is on the above position
2EC4 121A4D     886            lcall Settings
2EC7 022EDE     886            ljmp Menu_Done_Func588
2ECA            886                            
2ECA            886   Menu_Not_Func_Two_Select588:
2ECA E9         886            mov a, R1
2ECB B40206     886            cjne a, #0x02, Menu_Not_Func_Three_Select588
2ECE            886            ;if here, then the cursor is on the above position
2ECE 1211A0     886            lcall Select_Presets
2ED1 022EDE     886            ljmp Menu_Done_Func588
2ED4            886                            
2ED4            886   Menu_Not_Func_Three_Select588:
2ED4 E9         886            mov a, R1
2ED5 B40306     886            cjne a, #0x03, Menu_Not_Func_Four_Select588
2ED8            886            ;if here, then the cursor is on the above position
2ED8 1230EC     886            lcall Menu_Probes
2EDB 022EDE     886            ljmp Menu_Done_Func588
2EDE            886                            
2EDE            886   Menu_Not_Func_Four_Select588:
2EDE            886   
2EDE            886   Menu_Done_Func588:
2EDE            886   
2EDE            886            ;after selecting the function and exiting it, reset the cursor position and the screen
2EDE 7900       886            mov R1, #0x00
2EE0            886            ;display the screen after it has switched. This stays inside the 
2EE0            886            ;change cursor part so it only updates when pressed, not constantly.
2EE0 E9         886            mov a, R1
2EE1 B40079     886            cjne a, #0x00, Menu_Display_not_ONE589
2EE4 C0E0       886            push acc
2EE6 7401       886            mov a, #1
2EE8 14         886            dec a
2EE9 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2EEC D0E0       886            pop acc
2EEE C083       886            push dph
2EF0 C082       886            push dpl
2EF2 C0E0       886            push acc
2EF4 900D07     886            mov dptr, #CLEARLINE
2EF7 1200B4     886            lcall ?Send_Constant_String
2EFA D0E0       886            pop acc
2EFC D082       886            pop dpl
2EFE D083       886            pop dph
2F00 C0E0       886            push acc
2F02 7401       886            mov a, #1
2F04 14         886            dec a
2F05 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2F08 D0E0       886            pop acc
2F0A C083       886            push dph
2F0C C082       886            push dpl
2F0E C0E0       886            push acc
2F10 900D18     886            mov dptr, #HomeTop1
2F13 1200B4     886            lcall ?Send_Constant_String
2F16 D0E0       886            pop acc
2F18 D082       886            pop dpl
2F1A D083       886            pop dph                 ;display top half, cursor >
2F1C            886            ;check if its required to display bottom half
2F1C EA         886            mov a, R2
2F1D 5402       886            anl a, #0x02
2F1F B40238     886            cjne a, #0x02, Skip_Displaying_Bottom590
2F22 C0E0       886            push acc
2F24 7401       886            mov a, #1
2F26 14         886            dec a
2F27 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2F2A D0E0       886            pop acc
2F2C C083       886            push dph
2F2E C082       886            push dpl
2F30 C0E0       886            push acc
2F32 900D07     886            mov dptr, #CLEARLINE
2F35 1200B4     886            lcall ?Send_Constant_String
2F38 D0E0       886            pop acc
2F3A D082       886            pop dpl
2F3C D083       886            pop dph
2F3E C0E0       886            push acc
2F40 7401       886            mov a, #1
2F42 14         886            dec a
2F43 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2F46 D0E0       886            pop acc
2F48 C083       886            push dph
2F4A C082       886            push dpl
2F4C C0E0       886            push acc
2F4E 900D6D     886            mov dptr, #HomeBtm3
2F51 1200B4     886            lcall ?Send_Constant_String
2F54 D0E0       886            pop acc
2F56 D082       886            pop dpl
2F58 D083       886            pop dph                 ;display bottom half no cursor
2F5A            886   Skip_Displaying_Bottom590:                       
2F5A 0230D4     886            ljmp Menu_Done_Display_Cursor_Change589         
2F5D            886                    
2F5D            886   Menu_Display_not_ONE589:
2F5D E9         886                    mov a, R1
2F5E B40179     886                    cjne a, #0x01, Menu_Display_not_TWO589
2F61 C0E0       886            push acc
2F63 7401       886            mov a, #1
2F65 14         886            dec a
2F66 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2F69 D0E0       886            pop acc
2F6B C083       886            push dph
2F6D C082       886            push dpl
2F6F C0E0       886            push acc
2F71 900D07     886            mov dptr, #CLEARLINE
2F74 1200B4     886            lcall ?Send_Constant_String
2F77 D0E0       886            pop acc
2F79 D082       886            pop dpl
2F7B D083       886            pop dph
2F7D C0E0       886            push acc
2F7F 7401       886            mov a, #1
2F81 14         886            dec a
2F82 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2F85 D0E0       886            pop acc
2F87 C083       886            push dph
2F89 C082       886            push dpl
2F8B C0E0       886            push acc
2F8D 900D29     886            mov dptr, #HomeTop2
2F90 1200B4     886            lcall ?Send_Constant_String
2F93 D0E0       886            pop acc
2F95 D082       886            pop dpl
2F97 D083       886            pop dph                 ;display top half, cursor >
2F99            886            ;check if its required to display bottom half
2F99 EA         886            mov a, R2
2F9A 5402       886            anl a, #0x02
2F9C B40238     886            cjne a, #0x02, Skip_Displaying_Bottom599
2F9F C0E0       886            push acc
2FA1 7401       886            mov a, #1
2FA3 14         886            dec a
2FA4 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2FA7 D0E0       886            pop acc
2FA9 C083       886            push dph
2FAB C082       886            push dpl
2FAD C0E0       886            push acc
2FAF 900D07     886            mov dptr, #CLEARLINE
2FB2 1200B4     886            lcall ?Send_Constant_String
2FB5 D0E0       886            pop acc
2FB7 D082       886            pop dpl
2FB9 D083       886            pop dph
2FBB C0E0       886            push acc
2FBD 7401       886            mov a, #1
2FBF 14         886            dec a
2FC0 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
2FC3 D0E0       886            pop acc
2FC5 C083       886            push dph
2FC7 C082       886            push dpl
2FC9 C0E0       886            push acc
2FCB 900D6D     886            mov dptr, #HomeBtm3
2FCE 1200B4     886            lcall ?Send_Constant_String
2FD1 D0E0       886            pop acc
2FD3 D082       886            pop dpl
2FD5 D083       886            pop dph                 ;display bottom half no cursor
2FD7            886   Skip_Displaying_Bottom599:
2FD7 0230D4     886                    ljmp Menu_Done_Display_Cursor_Change589
2FDA            886                                    
2FDA            886   Menu_Display_not_TWO589:
2FDA E9         886                    mov a, R1
2FDB B40279     886                    cjne a, #0x02, Menu_Display_not_THREE589
2FDE C0E0       886            push acc
2FE0 7401       886            mov a, #1
2FE2 14         886            dec a
2FE3 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
2FE6 D0E0       886            pop acc
2FE8 C083       886            push dph
2FEA C082       886            push dpl
2FEC C0E0       886            push acc
2FEE 900D07     886            mov dptr, #CLEARLINE
2FF1 1200B4     886            lcall ?Send_Constant_String
2FF4 D0E0       886            pop acc
2FF6 D082       886            pop dpl
2FF8 D083       886            pop dph
2FFA C0E0       886            push acc
2FFC 7401       886            mov a, #1
2FFE 14         886            dec a
2FFF 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
3002 D0E0       886            pop acc
3004 C083       886            push dph
3006 C082       886            push dpl
3008 C0E0       886            push acc
300A 900D3A     886            mov dptr, #HomeTop3
300D 1200B4     886            lcall ?Send_Constant_String
3010 D0E0       886            pop acc
3012 D082       886            pop dpl
3014 D083       886            pop dph                 ;display top half, cursor >
3016            886            ;check if its required to display bottom half
3016 EA         886            mov a, R2
3017 5402       886            anl a, #0x02
3019 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom608
301C C0E0       886            push acc
301E 7401       886            mov a, #1
3020 14         886            dec a
3021 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
3024 D0E0       886            pop acc
3026 C083       886            push dph
3028 C082       886            push dpl
302A C0E0       886            push acc
302C 900D07     886            mov dptr, #CLEARLINE
302F 1200B4     886            lcall ?Send_Constant_String
3032 D0E0       886            pop acc
3034 D082       886            pop dpl
3036 D083       886            pop dph
3038 C0E0       886            push acc
303A 7401       886            mov a, #1
303C 14         886            dec a
303D 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
3040 D0E0       886            pop acc
3042 C083       886            push dph
3044 C082       886            push dpl
3046 C0E0       886            push acc
3048 900D4B     886            mov dptr, #HomeBtm1
304B 1200B4     886            lcall ?Send_Constant_String
304E D0E0       886            pop acc
3050 D082       886            pop dpl
3052 D083       886            pop dph                 ;display bottom half no cursor
3054            886   Skip_Displaying_Bottom608:
3054 0230D4     886                    ljmp Menu_Done_Display_Cursor_Change589
3057            886                                    
3057            886   Menu_Display_not_THREE589:
3057 E9         886                    mov a, R1
3058 B40379     886                    cjne a, #0x03, Menu_Display_not_FOUR589
305B C0E0       886            push acc
305D 7401       886            mov a, #1
305F 14         886            dec a
3060 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
3063 D0E0       886            pop acc
3065 C083       886            push dph
3067 C082       886            push dpl
3069 C0E0       886            push acc
306B 900D07     886            mov dptr, #CLEARLINE
306E 1200B4     886            lcall ?Send_Constant_String
3071 D0E0       886            pop acc
3073 D082       886            pop dpl
3075 D083       886            pop dph
3077 C0E0       886            push acc
3079 7401       886            mov a, #1
307B 14         886            dec a
307C 1200C1     886            lcall ?Set_Cursor_1 ; Select column and row
307F D0E0       886            pop acc
3081 C083       886            push dph
3083 C082       886            push dpl
3085 C0E0       886            push acc
3087 900D3A     886            mov dptr, #HomeTop3
308A 1200B4     886            lcall ?Send_Constant_String
308D D0E0       886            pop acc
308F D082       886            pop dpl
3091 D083       886            pop dph                 ;display top half, cursor >
3093            886            ;check if its required to display bottom half
3093 EA         886            mov a, R2
3094 5402       886            anl a, #0x02
3096 B40238     886            cjne a, #0x02, Skip_Displaying_Bottom617
3099 C0E0       886            push acc
309B 7401       886            mov a, #1
309D 14         886            dec a
309E 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
30A1 D0E0       886            pop acc
30A3 C083       886            push dph
30A5 C082       886            push dpl
30A7 C0E0       886            push acc
30A9 900D07     886            mov dptr, #CLEARLINE
30AC 1200B4     886            lcall ?Send_Constant_String
30AF D0E0       886            pop acc
30B1 D082       886            pop dpl
30B3 D083       886            pop dph
30B5 C0E0       886            push acc
30B7 7401       886            mov a, #1
30B9 14         886            dec a
30BA 1200BF     886            lcall ?Set_Cursor_2 ; Select column and row
30BD D0E0       886            pop acc
30BF C083       886            push dph
30C1 C082       886            push dpl
30C3 C0E0       886            push acc
30C5 900D5C     886            mov dptr, #HomeBtm2
30C8 1200B4     886            lcall ?Send_Constant_String
30CB D0E0       886            pop acc
30CD D082       886            pop dpl
30CF D083       886            pop dph                 ;display bottom half no cursor
30D1            886   Skip_Displaying_Bottom617:       
30D1 0230D4     886                    ljmp Menu_Done_Display_Cursor_Change589
30D4            886                                    
30D4            886   Menu_Display_not_FOUR589:
30D4            886   Menu_Done_Display_Cursor_Change589:
30D4            886   
30D4            886   Menu_Skip_Select_Change472:
30D4            886            
30D4            886            ;calling the operation function, which does stuff every cycle.
30D4 12110C     886            lcall Extra_Functions_Home
30D7 022A72     886            ljmp Menu_Loop472
30DA            886   
30DA            886   Menu_Exit_Level472:
30DA D0E0       886            pop acc
30DC D007       886            pop  ar7
30DE D006       886            pop  ar6
30E0 D005       886            pop  ar5
30E2 D004       886            pop  ar4
30E4 D003       886            pop  ar3
30E6 D002       886            pop  ar2
30E8 D001       886            pop  ar1
30EA D000       886            pop  ar0
30EC            887            
30EC            888            
30EC            889   Menu_Probes:
30EC C0E0       890            push acc
30EE 7401       890            mov a, #1
30F0 14         890            dec a
30F1 1200C1     890            lcall ?Set_Cursor_1 ; Select column and row
30F4 D0E0       890            pop acc
30F6 C083       890            push dph
30F8 C082       890            push dpl
30FA C0E0       890            push acc
30FC 900D07     890            mov dptr, #CLEARLINE
30FF 1200B4     890            lcall ?Send_Constant_String
3102 D0E0       890            pop acc
3104 D082       890            pop dpl
3106 D083       890            pop dph
3108 C0E0       890            push acc
310A 7401       890            mov a, #1
310C 14         890            dec a
310D 1200BF     890            lcall ?Set_Cursor_2 ; Select column and row
3110 D0E0       890            pop acc
3112 C083       890            push dph
3114 C082       890            push dpl
3116 C0E0       890            push acc
3118 900D07     890            mov dptr, #CLEARLINE
311B 1200B4     890            lcall ?Send_Constant_String
311E D0E0       890            pop acc
3120 D082       890            pop dpl
3122 D083       890            pop dph
3124 C0E0       890            push acc
3126 7401       890            mov a, #1
3128 14         890            dec a
3129 1200C1     890            lcall ?Set_Cursor_1 ; Select column and row
312C D0E0       890            pop acc
312E C083       890            push dph
3130 C082       890            push dpl
3132 C0E0       890            push acc
3134 900F36     890            mov dptr, #ProbeTop
3137 1200B4     890            lcall ?Send_Constant_String
313A D0E0       890            pop acc
313C D082       890            pop dpl
313E D083       890            pop dph
3140 C0E0       890            push acc
3142 7401       890            mov a, #1
3144 14         890            dec a
3145 1200BF     890            lcall ?Set_Cursor_2 ; Select column and row
3148 D0E0       890            pop acc
314A C083       890            push dph
314C C082       890            push dpl
314E C0E0       890            push acc
3150 900F47     890            mov dptr, #ProbeBtm
3153 1200B4     890            lcall ?Send_Constant_String
3156 D0E0       890            pop acc
3158 D082       890            pop dpl
315A D083       890            pop dph
315C C002       891            push AR2
315E 7AFA       891            mov R2, #250
3160 120039     891            lcall ?Wait_Milli_Seconds
3163 D002       891            pop AR2
3165 C002       892            push AR2
3167 7AFA       892            mov R2, #250
3169 120039     892            lcall ?Wait_Milli_Seconds
316C D002       892            pop AR2
316E C002       893            push AR2
3170 7AFA       893            mov R2, #250
3172 120039     893            lcall ?Wait_Milli_Seconds
3175 D002       893            pop AR2
3177            894   Menu_Probes_Loop:
3177            895                    ;check if the emergency button has been pressed
3177 20A710     896            jb B1, Skip_Exit_Probes ; if the 'B0' button is not pressed skip
317A C002       897            push AR2
317C 7A32       897            mov R2, #50
317E 120039     897            lcall ?Wait_Milli_Seconds
3181 D002       897            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
3183 20A704     898            jb B1,Skip_Exit_Probes ; if the 'B0' button is not pressed skip
3186 30A7FD     899            jnb B1, $
3189            900            ;check if the user wants to exit
3189 22         901            ret
318A            902   Skip_Exit_Probes:        
318A 121163     903            lcall Error_Code_1Check         
318D 855A47     904            mov x + 0, Probe1_Temp+0
3190 855B48     905            mov x + 1, Probe1_Temp+1
3193 754900     906            mov x + 2, #0x00
3196 754A00     907            mov x + 3, #0x00
3199 120129     908            lcall hex2bcd           ;change hex number to bcd so it can be displayed
319C C0E0       909            push acc
319E 7401       909            mov a, #1
31A0 14         909            dec a
31A1 1200C1     909            lcall ?Set_Cursor_1 ; Select column and row
31A4 D0E0       909            pop acc
31A6 C000       910            push ar0
31A8 A851       910            mov r0, bcd+2
31AA 1200C6     910            lcall ?Display_BCD
31AD D000       910            pop ar0
31AF C000       911            push ar0
31B1 A850       911            mov r0, bcd+1
31B3 1200C6     911            lcall ?Display_BCD
31B6 D000       911            pop ar0
31B8 C0E0       912            push acc
31BA 742E       912            mov a, #'.'
31BC 12007E     912            lcall ?WriteData
31BF D0E0       912            pop acc
31C1 C000       913            push ar0
31C3 A84F       913            mov r0, bcd+0
31C5 1200C6     913            lcall ?Display_BCD
31C8 D000       913            pop ar0
31CA            914            
31CA 855C47     915            mov x + 0, Probe2_Temp+0
31CD 855D48     916            mov x + 1, Probe2_Temp+1
31D0 754900     917            mov x + 2, #0x00
31D3 754A00     918            mov x + 3, #0x00
31D6 120129     919            lcall hex2bcd           ;change hex number to bcd so it can be displayed
31D9 C0E0       920            push acc
31DB 7401       920            mov a, #1
31DD 14         920            dec a
31DE 1200BF     920            lcall ?Set_Cursor_2 ; Select column and row
31E1 D0E0       920            pop acc
31E3 C000       921            push ar0
31E5 A851       921            mov r0, bcd+2
31E7 1200C6     921            lcall ?Display_BCD
31EA D000       921            pop ar0
31EC C000       922            push ar0
31EE A850       922            mov r0, bcd+1
31F0 1200C6     922            lcall ?Display_BCD
31F3 D000       922            pop ar0
31F5 C0E0       923            push acc
31F7 742E       923            mov a, #'.'
31F9 12007E     923            lcall ?WriteData
31FC D0E0       923            pop acc
31FE C000       924            push ar0
3200 A84F       924            mov r0, bcd+0
3202 1200C6     924            lcall ?Display_BCD
3205 D000       924            pop ar0
3207            925            
3207 855E47     926            mov x + 0, Probe3_Temp+0
320A 855F48     927            mov x + 1, Probe3_Temp+1
320D 754900     928            mov x + 2, #0x00
3210 754A00     929            mov x + 3, #0x00
3213 120129     930            lcall hex2bcd           ;change hex number to bcd so it can be displayed
3216 C0E0       931            push acc
3218 740A       931            mov a, #10
321A 14         931            dec a
321B 1200C1     931            lcall ?Set_Cursor_1 ; Select column and row
321E D0E0       931            pop acc
3220 C000       932            push ar0
3222 A851       932            mov r0, bcd+2
3224 1200C6     932            lcall ?Display_BCD
3227 D000       932            pop ar0
3229 C000       933            push ar0
322B A850       933            mov r0, bcd+1
322D 1200C6     933            lcall ?Display_BCD
3230 D000       933            pop ar0
3232 C0E0       934            push acc
3234 742E       934            mov a, #'.'
3236 12007E     934            lcall ?WriteData
3239 D0E0       934            pop acc
323B C000       935            push ar0
323D A84F       935            mov r0, bcd+0
323F 1200C6     935            lcall ?Display_BCD
3242 D000       935            pop ar0
3244            936            
3244 857D47     937            mov x + 0, Calibrated_Result+0
3247 857E48     938            mov x + 1, Calibrated_Result+1
324A 754900     939            mov x + 2, #0x00
324D 754A00     940            mov x + 3, #0x00
3250 120129     941            lcall hex2bcd           ;change hex number to bcd so it can be displayed
3253 C0E0       942            push acc
3255 740A       942            mov a, #10
3257 14         942            dec a
3258 1200BF     942            lcall ?Set_Cursor_2 ; Select column and row
325B D0E0       942            pop acc
325D C000       943            push ar0
325F A851       943            mov r0, bcd+2
3261 1200C6     943            lcall ?Display_BCD
3264 D000       943            pop ar0
3266 C000       944            push ar0
3268 A850       944            mov r0, bcd+1
326A 1200C6     944            lcall ?Display_BCD
326D D000       944            pop ar0
326F C0E0       945            push acc
3271 742E       945            mov a, #'.'
3273 12007E     945            lcall ?WriteData
3276 D0E0       945            pop acc
3278 C000       946            push ar0
327A A84F       946            mov r0, bcd+0
327C 1200C6     946            lcall ?Display_BCD
327F D000       946            pop ar0
3281            947   
3281 023177     948            ljmp Menu_Probes_Loop
3284            949            
3284            950            
3284            951   ;----------------------;
3284            952   ;Start_Process
3284            953   ;----------------------;
3284            954   ;when the user starts the process, this is entered.
3284            955   Start_Process:
3284 C0E0       956            push acc
3286            957            ;first move the preset variables into the process variabes
3286 E530       958            mov a, Current_Preset   ;determine the current preset
3288 B40116     959            cjne a, #0x01, Loading_Preset_Start_T_Not_1
328B C0E0       960            push acc
328D            960   
328D E533       960            mov a, Soak_Preset1_T_hex
328F F541       960            mov Soak_Start_T_hex, a         
3291 E53A       960            mov a, Reflow_Preset1_T_hex
3293 F542       960            mov Reflow_Start_T_hex, a       
3295            960            
3295 E536       960            mov a, Soak_Preset1_Temp_hex
3297 F543       960            mov Soak_Start_Temp_hex, a      
3299 E53E       960            mov a, Reflow_Preset1_Temp_hex
329B F544       960            mov Reflow_Start_Temp_hex, a    
329D            960   
329D D0E0       960            pop acc
329F            960            
329F 8032       961            sjmp Done_Loading_Preset_Start_T
32A1            962            
32A1            963   Loading_Preset_Start_T_Not_1:
32A1 B40216     964            cjne a, #0x02, Loading_Preset_Start_T_Not_2
32A4 C0E0       965            push acc
32A6            965   
32A6 E534       965            mov a, Soak_Preset2_T_hex
32A8 F541       965            mov Soak_Start_T_hex, a         
32AA E53B       965            mov a, Reflow_Preset2_T_hex
32AC F542       965            mov Reflow_Start_T_hex, a       
32AE            965            
32AE E537       965            mov a, Soak_Preset2_Temp_hex
32B0 F543       965            mov Soak_Start_Temp_hex, a      
32B2 E53F       965            mov a, Reflow_Preset2_Temp_hex
32B4 F544       965            mov Reflow_Start_Temp_hex, a    
32B6            965   
32B6 D0E0       965            pop acc
32B8 8019       966            sjmp Done_Loading_Preset_Start_T
32BA            967            
32BA            968   Loading_Preset_Start_T_Not_2:
32BA B40316     969            cjne a, #0x03, Loading_Preset_Start_T_Not_3
32BD C0E0       970            push acc
32BF            970   
32BF E535       970            mov a, Soak_Preset3_T_hex
32C1 F541       970            mov Soak_Start_T_hex, a         
32C3 E53C       970            mov a, Reflow_Preset3_T_hex
32C5 F542       970            mov Reflow_Start_T_hex, a       
32C7            970            
32C7 E538       970            mov a, Soak_Preset3_Temp_hex
32C9 F543       970            mov Soak_Start_Temp_hex, a      
32CB E540       970            mov a, Reflow_Preset3_Temp_hex
32CD F544       970            mov Reflow_Start_Temp_hex, a    
32CF            970   
32CF D0E0       970            pop acc
32D1 8000       971            sjmp Done_Loading_Preset_Start_T
32D3            972            
32D3            973   Loading_Preset_Start_T_Not_3:
32D3            974   
32D3            975            ;now the correct values have been stored in the process variables
32D3            976   Done_Loading_Preset_Start_T:
32D3 C0E0       977            push acc
32D5 7401       977            mov a, #1
32D7 14         977            dec a
32D8 1200C1     977            lcall ?Set_Cursor_1 ; Select column and row
32DB D0E0       977            pop acc
32DD C083       978            push dph
32DF C082       978            push dpl
32E1 C0E0       978            push acc
32E3 900D07     978            mov dptr, #CLEARLINE
32E6 1200B4     978            lcall ?Send_Constant_String
32E9 D0E0       978            pop acc
32EB D082       978            pop dpl
32ED D083       978            pop dph
32EF C0E0       979            push acc
32F1 7401       979            mov a, #1
32F3 14         979            dec a
32F4 1200BF     979            lcall ?Set_Cursor_2 ; Select column and row
32F7 D0E0       979            pop acc
32F9 C083       980            push dph
32FB C082       980            push dpl
32FD C0E0       980            push acc
32FF 900D07     980            mov dptr, #CLEARLINE
3302 1200B4     980            lcall ?Send_Constant_String
3305 D0E0       980            pop acc
3307 D082       980            pop dpl
3309 D083       980            pop dph
330B            981            ;reset runtime timer to 0
330B 755400     982            mov BCD_counter+0,                                      #0x00
330E 755500     983            mov BCD_counter+1,                                      #0x00
3311 755600     984            mov BCD_state_counter+0,                        #0x00
3314 755700     985            mov BCD_state_counter+1,                        #0x00
3317 754501     986            mov oven_state, #0x01
331A 123521     987            lcall Print_FSM_State_Info
331D D21A       988            setb state1tempflag
331F D21B       989            setb state3tempflag
3321 C202       990            clr abort_flag
3323 D21C       991            setb Check_Code_1
3325 12380A     992            lcall Oven_FSM
3328 7900       993            mov R1, #0x00
332A            994            ;display the screen after it has switched. This stays inside the 
332A            994            ;change cursor part so it only updates when pressed, not constantly.
332A E9         994            mov a, R1
332B B40079     994            cjne a, #0x00, Menu_Display_not_ONE666
332E C0E0       994            push acc
3330 7401       994            mov a, #1
3332 14         994            dec a
3333 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
3336 D0E0       994            pop acc
3338 C083       994            push dph
333A C082       994            push dpl
333C C0E0       994            push acc
333E 900D07     994            mov dptr, #CLEARLINE
3341 1200B4     994            lcall ?Send_Constant_String
3344 D0E0       994            pop acc
3346 D082       994            pop dpl
3348 D083       994            pop dph
334A C0E0       994            push acc
334C 7401       994            mov a, #1
334E 14         994            dec a
334F 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
3352 D0E0       994            pop acc
3354 C083       994            push dph
3356 C082       994            push dpl
3358 C0E0       994            push acc
335A 900D18     994            mov dptr, #HomeTop1
335D 1200B4     994            lcall ?Send_Constant_String
3360 D0E0       994            pop acc
3362 D082       994            pop dpl
3364 D083       994            pop dph                 ;display top half, cursor >
3366            994            ;check if its required to display bottom half
3366 EA         994            mov a, R2
3367 5402       994            anl a, #0x02
3369 B40238     994            cjne a, #0x02, Skip_Displaying_Bottom667
336C C0E0       994            push acc
336E 7401       994            mov a, #1
3370 14         994            dec a
3371 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
3374 D0E0       994            pop acc
3376 C083       994            push dph
3378 C082       994            push dpl
337A C0E0       994            push acc
337C 900D07     994            mov dptr, #CLEARLINE
337F 1200B4     994            lcall ?Send_Constant_String
3382 D0E0       994            pop acc
3384 D082       994            pop dpl
3386 D083       994            pop dph
3388 C0E0       994            push acc
338A 7401       994            mov a, #1
338C 14         994            dec a
338D 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
3390 D0E0       994            pop acc
3392 C083       994            push dph
3394 C082       994            push dpl
3396 C0E0       994            push acc
3398 900D6D     994            mov dptr, #HomeBtm3
339B 1200B4     994            lcall ?Send_Constant_String
339E D0E0       994            pop acc
33A0 D082       994            pop dpl
33A2 D083       994            pop dph                 ;display bottom half no cursor
33A4            994   Skip_Displaying_Bottom667:                       
33A4 02351E     994            ljmp Menu_Done_Display_Cursor_Change666         
33A7            994                    
33A7            994   Menu_Display_not_ONE666:
33A7 E9         994                    mov a, R1
33A8 B40179     994                    cjne a, #0x01, Menu_Display_not_TWO666
33AB C0E0       994            push acc
33AD 7401       994            mov a, #1
33AF 14         994            dec a
33B0 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
33B3 D0E0       994            pop acc
33B5 C083       994            push dph
33B7 C082       994            push dpl
33B9 C0E0       994            push acc
33BB 900D07     994            mov dptr, #CLEARLINE
33BE 1200B4     994            lcall ?Send_Constant_String
33C1 D0E0       994            pop acc
33C3 D082       994            pop dpl
33C5 D083       994            pop dph
33C7 C0E0       994            push acc
33C9 7401       994            mov a, #1
33CB 14         994            dec a
33CC 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
33CF D0E0       994            pop acc
33D1 C083       994            push dph
33D3 C082       994            push dpl
33D5 C0E0       994            push acc
33D7 900D29     994            mov dptr, #HomeTop2
33DA 1200B4     994            lcall ?Send_Constant_String
33DD D0E0       994            pop acc
33DF D082       994            pop dpl
33E1 D083       994            pop dph                 ;display top half, cursor >
33E3            994            ;check if its required to display bottom half
33E3 EA         994            mov a, R2
33E4 5402       994            anl a, #0x02
33E6 B40238     994            cjne a, #0x02, Skip_Displaying_Bottom676
33E9 C0E0       994            push acc
33EB 7401       994            mov a, #1
33ED 14         994            dec a
33EE 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
33F1 D0E0       994            pop acc
33F3 C083       994            push dph
33F5 C082       994            push dpl
33F7 C0E0       994            push acc
33F9 900D07     994            mov dptr, #CLEARLINE
33FC 1200B4     994            lcall ?Send_Constant_String
33FF D0E0       994            pop acc
3401 D082       994            pop dpl
3403 D083       994            pop dph
3405 C0E0       994            push acc
3407 7401       994            mov a, #1
3409 14         994            dec a
340A 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
340D D0E0       994            pop acc
340F C083       994            push dph
3411 C082       994            push dpl
3413 C0E0       994            push acc
3415 900D6D     994            mov dptr, #HomeBtm3
3418 1200B4     994            lcall ?Send_Constant_String
341B D0E0       994            pop acc
341D D082       994            pop dpl
341F D083       994            pop dph                 ;display bottom half no cursor
3421            994   Skip_Displaying_Bottom676:
3421 02351E     994                    ljmp Menu_Done_Display_Cursor_Change666
3424            994                                    
3424            994   Menu_Display_not_TWO666:
3424 E9         994                    mov a, R1
3425 B40279     994                    cjne a, #0x02, Menu_Display_not_THREE666
3428 C0E0       994            push acc
342A 7401       994            mov a, #1
342C 14         994            dec a
342D 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
3430 D0E0       994            pop acc
3432 C083       994            push dph
3434 C082       994            push dpl
3436 C0E0       994            push acc
3438 900D07     994            mov dptr, #CLEARLINE
343B 1200B4     994            lcall ?Send_Constant_String
343E D0E0       994            pop acc
3440 D082       994            pop dpl
3442 D083       994            pop dph
3444 C0E0       994            push acc
3446 7401       994            mov a, #1
3448 14         994            dec a
3449 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
344C D0E0       994            pop acc
344E C083       994            push dph
3450 C082       994            push dpl
3452 C0E0       994            push acc
3454 900D3A     994            mov dptr, #HomeTop3
3457 1200B4     994            lcall ?Send_Constant_String
345A D0E0       994            pop acc
345C D082       994            pop dpl
345E D083       994            pop dph                 ;display top half, cursor >
3460            994            ;check if its required to display bottom half
3460 EA         994            mov a, R2
3461 5402       994            anl a, #0x02
3463 B40238     994            cjne a, #0x02, Skip_Displaying_Bottom685
3466 C0E0       994            push acc
3468 7401       994            mov a, #1
346A 14         994            dec a
346B 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
346E D0E0       994            pop acc
3470 C083       994            push dph
3472 C082       994            push dpl
3474 C0E0       994            push acc
3476 900D07     994            mov dptr, #CLEARLINE
3479 1200B4     994            lcall ?Send_Constant_String
347C D0E0       994            pop acc
347E D082       994            pop dpl
3480 D083       994            pop dph
3482 C0E0       994            push acc
3484 7401       994            mov a, #1
3486 14         994            dec a
3487 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
348A D0E0       994            pop acc
348C C083       994            push dph
348E C082       994            push dpl
3490 C0E0       994            push acc
3492 900D4B     994            mov dptr, #HomeBtm1
3495 1200B4     994            lcall ?Send_Constant_String
3498 D0E0       994            pop acc
349A D082       994            pop dpl
349C D083       994            pop dph                 ;display bottom half no cursor
349E            994   Skip_Displaying_Bottom685:
349E 02351E     994                    ljmp Menu_Done_Display_Cursor_Change666
34A1            994                                    
34A1            994   Menu_Display_not_THREE666:
34A1 E9         994                    mov a, R1
34A2 B40379     994                    cjne a, #0x03, Menu_Display_not_FOUR666
34A5 C0E0       994            push acc
34A7 7401       994            mov a, #1
34A9 14         994            dec a
34AA 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
34AD D0E0       994            pop acc
34AF C083       994            push dph
34B1 C082       994            push dpl
34B3 C0E0       994            push acc
34B5 900D07     994            mov dptr, #CLEARLINE
34B8 1200B4     994            lcall ?Send_Constant_String
34BB D0E0       994            pop acc
34BD D082       994            pop dpl
34BF D083       994            pop dph
34C1 C0E0       994            push acc
34C3 7401       994            mov a, #1
34C5 14         994            dec a
34C6 1200C1     994            lcall ?Set_Cursor_1 ; Select column and row
34C9 D0E0       994            pop acc
34CB C083       994            push dph
34CD C082       994            push dpl
34CF C0E0       994            push acc
34D1 900D3A     994            mov dptr, #HomeTop3
34D4 1200B4     994            lcall ?Send_Constant_String
34D7 D0E0       994            pop acc
34D9 D082       994            pop dpl
34DB D083       994            pop dph                 ;display top half, cursor >
34DD            994            ;check if its required to display bottom half
34DD EA         994            mov a, R2
34DE 5402       994            anl a, #0x02
34E0 B40238     994            cjne a, #0x02, Skip_Displaying_Bottom694
34E3 C0E0       994            push acc
34E5 7401       994            mov a, #1
34E7 14         994            dec a
34E8 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
34EB D0E0       994            pop acc
34ED C083       994            push dph
34EF C082       994            push dpl
34F1 C0E0       994            push acc
34F3 900D07     994            mov dptr, #CLEARLINE
34F6 1200B4     994            lcall ?Send_Constant_String
34F9 D0E0       994            pop acc
34FB D082       994            pop dpl
34FD D083       994            pop dph
34FF C0E0       994            push acc
3501 7401       994            mov a, #1
3503 14         994            dec a
3504 1200BF     994            lcall ?Set_Cursor_2 ; Select column and row
3507 D0E0       994            pop acc
3509 C083       994            push dph
350B C082       994            push dpl
350D C0E0       994            push acc
350F 900D5C     994            mov dptr, #HomeBtm2
3512 1200B4     994            lcall ?Send_Constant_String
3515 D0E0       994            pop acc
3517 D082       994            pop dpl
3519 D083       994            pop dph                 ;display bottom half no cursor
351B            994   Skip_Displaying_Bottom694:       
351B 02351E     994                    ljmp Menu_Done_Display_Cursor_Change666
351E            994                                    
351E            994   Menu_Display_not_FOUR666:
351E            994   Menu_Done_Display_Cursor_Change666:
351E D0E0       995            pop acc
3520 22         996            ret
3521            997   
3521            998   ;------------------------------;
3521            999   ;Print_FSM_State_Info
3521           1000   ;------------------------------;
3521           1001   Print_FSM_State_Info:
3521           1002            ;print the name of the current state you are in.
3521 200803    1003            jb state_display_flag, Display_Diagramtp
3524 02352A    1004            ljmp Print_FSM_Jump
3527           1005   Display_Diagramtp:                       ;used to get around jump limits
3527 0235E2    1006            ljmp Display_Diagram
352A           1007                    
352A           1008   Print_FSM_Jump:
352A E545      1009            mov a, oven_state
352C B40122    1010            cjne a, #0x01, Print_FSM_Check_S2
352F 1200F0    1011            lcall Print_FSM_Clear_Name
3532 C0E0      1012            push acc
3534 7407      1012            mov a, #7
3536 14        1012            dec a
3537 1200C1    1012            lcall ?Set_Cursor_1 ; Select column and row
353A D0E0      1012            pop acc
353C C083      1012            push dph
353E C082      1012            push dpl
3540 C0E0      1012            push acc
3542 900EDE    1012            mov dptr, #RampToSoak
3545 1200B4    1012            lcall ?Send_Constant_String
3548 D0E0      1012            pop acc
354A D082      1012            pop dpl
354C D083      1012            pop dph
354E 0236D5    1013            ljmp Print_FSM_Complete
3551           1014            
3551           1015   Print_FSM_Check_S2:
3551 B40222    1016            cjne a, #0x02, Print_FSM_Check_S3
3554 1200F0    1017            lcall Print_FSM_Clear_Name
3557 C0E0      1018            push acc
3559 740D      1018            mov a, #13
355B 14        1018            dec a
355C 1200C1    1018            lcall ?Set_Cursor_1 ; Select column and row
355F D0E0      1018            pop acc
3561 C083      1018            push dph
3563 C082      1018            push dpl
3565 C0E0      1018            push acc
3567 900EE9    1018            mov dptr, #Soak
356A 1200B4    1018            lcall ?Send_Constant_String
356D D0E0      1018            pop acc
356F D082      1018            pop dpl
3571 D083      1018            pop dph
3573 0236D5    1019            ljmp Print_FSM_Complete
3576           1020            
3576           1021   Print_FSM_Check_S3:
3576 B40322    1022            cjne a, #0x03, Print_FSM_Check_S4
3579 1200F0    1023            lcall Print_FSM_Clear_Name
357C C0E0      1024            push acc
357E 7407      1024            mov a, #7
3580 14        1024            dec a
3581 1200C1    1024            lcall ?Set_Cursor_1 ; Select column and row
3584 D0E0      1024            pop acc
3586 C083      1024            push dph
3588 C082      1024            push dpl
358A C0E0      1024            push acc
358C 900EEE    1024            mov dptr, #RampToPeak
358F 1200B4    1024            lcall ?Send_Constant_String
3592 D0E0      1024            pop acc
3594 D082      1024            pop dpl
3596 D083      1024            pop dph
3598 0236D5    1025            ljmp Print_FSM_Complete
359B           1026            
359B           1027   Print_FSM_Check_S4:
359B B40422    1028            cjne a, #0x04, Print_FSM_Check_S5
359E 1200F0    1029            lcall Print_FSM_Clear_Name
35A1 C0E0      1030            push acc
35A3 740B      1030            mov a, #11
35A5 14        1030            dec a
35A6 1200C1    1030            lcall ?Set_Cursor_1 ; Select column and row
35A9 D0E0      1030            pop acc
35AB C083      1030            push dph
35AD C082      1030            push dpl
35AF C0E0      1030            push acc
35B1 900EF9    1030            mov dptr, #Reflow
35B4 1200B4    1030            lcall ?Send_Constant_String
35B7 D0E0      1030            pop acc
35B9 D082      1030            pop dpl
35BB D083      1030            pop dph
35BD 0236D5    1031            ljmp Print_FSM_Complete
35C0           1032            
35C0           1033   Print_FSM_Check_S5:
35C0 1200F0    1034            lcall Print_FSM_Clear_Name
35C3 C0E0      1035            push acc
35C5 740A      1035            mov a, #10
35C7 14        1035            dec a
35C8 1200C1    1035            lcall ?Set_Cursor_1 ; Select column and row
35CB D0E0      1035            pop acc
35CD C083      1035            push dph
35CF C082      1035            push dpl
35D1 C0E0      1035            push acc
35D3 900F00    1035            mov dptr, #Cooling
35D6 1200B4    1035            lcall ?Send_Constant_String
35D9 D0E0      1035            pop acc
35DB D082      1035            pop dpl
35DD D083      1035            pop dph
35DF 0236D5    1036            ljmp Print_FSM_Complete
35E2           1037   
35E2           1038   ;If not displaying the name, display the position of the state
35E2           1039   Display_Diagram:
35E2 1200F0    1040            lcall Print_FSM_Clear_Name
35E5 C0E0      1041            push acc
35E7 740C      1041            mov a, #12
35E9 14        1041            dec a
35EA 1200C1    1041            lcall ?Set_Cursor_1 ; Select column and row
35ED D0E0      1041            pop acc
35EF C083      1042            push dph
35F1 C082      1042            push dpl
35F3 C0E0      1042            push acc
35F5 900F08    1042            mov dptr, #StateDiagramLayout
35F8 1200B4    1042            lcall ?Send_Constant_String
35FB D0E0      1042            pop acc
35FD D082      1042            pop dpl
35FF D083      1042            pop dph
3601           1043            ;now check which state and print the corresponding position
3601 856447    1044            mov x + 0, Set_Temp
3604 754800    1045            mov x + 1, #0x00
3607 754900    1046            mov x + 2, #0x00
360A 754A00    1047            mov x + 3, #0x00
360D 120129    1048            lcall hex2bcd
3610 C0E0      1049            push acc
3612 7407      1049            mov a, #7
3614 14        1049            dec a
3615 1200C1    1049            lcall ?Set_Cursor_1 ; Select column and row
3618 D0E0      1049            pop acc
361A C000      1050            push ar0
361C A850      1050            mov r0, bcd+1
361E 1200C6    1050            lcall ?Display_BCD
3621 D000      1050            pop ar0
3623 C000      1051            push ar0
3625 A84F      1051            mov r0, bcd+0
3627 1200C6    1051            lcall ?Display_BCD
362A D000      1051            pop ar0
362C           1052            ;the above prints the desired temp beside the current temp
362C E545      1053            mov a, oven_state
362E B4011F    1054            cjne a, #0x01, Print_FSM_Diagram_Check_S2
3631 C0E0      1055            push acc
3633 740C      1055            mov a, #12
3635 14        1055            dec a
3636 1200C1    1055            lcall ?Set_Cursor_1 ; Select column and row
3639 D0E0      1055            pop acc
363B C083      1055            push dph
363D C082      1055            push dpl
363F C0E0      1055            push acc
3641 900EC3    1055            mov dptr, #o
3644 1200B4    1055            lcall ?Send_Constant_String
3647 D0E0      1055            pop acc
3649 D082      1055            pop dpl
364B D083      1055            pop dph
364D           1055            
364D 0236D5    1056            ljmp Print_FSM_Complete
3650           1057            
3650           1058   Print_FSM_Diagram_Check_S2:
3650 B4021F    1059            cjne a, #0x02, Print_FSM_Diagram_Check_S3
3653 C0E0      1060            push acc
3655 740D      1060            mov a, #13
3657 14        1060            dec a
3658 1200C1    1060            lcall ?Set_Cursor_1 ; Select column and row
365B D0E0      1060            pop acc
365D C083      1060            push dph
365F C082      1060            push dpl
3661 C0E0      1060            push acc
3663 900EC3    1060            mov dptr, #o
3666 1200B4    1060            lcall ?Send_Constant_String
3669 D0E0      1060            pop acc
366B D082      1060            pop dpl
366D D083      1060            pop dph
366F           1060            
366F 0236D5    1061            ljmp Print_FSM_Complete
3672           1062            
3672           1063   Print_FSM_Diagram_Check_S3:
3672 B4031F    1064            cjne a, #0x03, Print_FSM_Diagram_Check_S4
3675 C0E0      1065            push acc
3677 740E      1065            mov a, #14
3679 14        1065            dec a
367A 1200C1    1065            lcall ?Set_Cursor_1 ; Select column and row
367D D0E0      1065            pop acc
367F C083      1065            push dph
3681 C082      1065            push dpl
3683 C0E0      1065            push acc
3685 900EC3    1065            mov dptr, #o
3688 1200B4    1065            lcall ?Send_Constant_String
368B D0E0      1065            pop acc
368D D082      1065            pop dpl
368F D083      1065            pop dph
3691           1065            
3691 0236D5    1066            ljmp Print_FSM_Complete
3694           1067            
3694           1068   Print_FSM_Diagram_Check_S4:
3694 B4041F    1069            cjne a, #0x04, Print_FSM_Diagram_Check_S5
3697 C0E0      1070            push acc
3699 740F      1070            mov a, #15
369B 14        1070            dec a
369C 1200C1    1070            lcall ?Set_Cursor_1 ; Select column and row
369F D0E0      1070            pop acc
36A1 C083      1070            push dph
36A3 C082      1070            push dpl
36A5 C0E0      1070            push acc
36A7 900EC3    1070            mov dptr, #o
36AA 1200B4    1070            lcall ?Send_Constant_String
36AD D0E0      1070            pop acc
36AF D082      1070            pop dpl
36B1 D083      1070            pop dph
36B3           1070            
36B3 0236D5    1071            ljmp Print_FSM_Complete
36B6           1072            
36B6           1073   Print_FSM_Diagram_Check_S5:
36B6           1074   
36B6 C0E0      1075            push acc
36B8 7410      1075            mov a, #16
36BA 14        1075            dec a
36BB 1200C1    1075            lcall ?Set_Cursor_1 ; Select column and row
36BE D0E0      1075            pop acc
36C0 C083      1075            push dph
36C2 C082      1075            push dpl
36C4 C0E0      1075            push acc
36C6 900EC3    1075            mov dptr, #o
36C9 1200B4    1075            lcall ?Send_Constant_String
36CC D0E0      1075            pop acc
36CE D082      1075            pop dpl
36D0 D083      1075            pop dph
36D2           1075            
36D2 0236D5    1076            ljmp Print_FSM_Complete
36D5           1077   Print_FSM_Complete:
36D5 22        1078            ret
36D6           1079   ;------------------------------;
36D6           1080   ;Print_FSM_Time_Info
36D6           1081   ;------------------------------; 
36D6           1082   Print_FSM_Time_Info:
36D6 C0E0      1083            push acc
36D8 7401      1083            mov a, #1
36DA 14        1083            dec a
36DB 1200BF    1083            lcall ?Set_Cursor_2 ; Select column and row
36DE D0E0      1083            pop acc
36E0           1083   
36E0 C000      1084            push ar0
36E2 A855      1084            mov r0, BCD_counter+1
36E4 1200C6    1084            lcall ?Display_BCD
36E7 D000      1084            pop ar0
36E9 C000      1085            push ar0
36EB A854      1085            mov r0, BCD_counter+0
36ED 1200C6    1085            lcall ?Display_BCD
36F0 D000      1085            pop ar0
36F2 C0E0      1086            push acc
36F4 740D      1086            mov a, #13
36F6 14        1086            dec a
36F7 1200BF    1086            lcall ?Set_Cursor_2 ; Select column and row
36FA D0E0      1086            pop acc
36FC C000      1087            push ar0
36FE A857      1087            mov r0, BCD_state_counter+1
3700 1200C6    1087            lcall ?Display_BCD
3703 D000      1087            pop ar0
3705 C000      1088            push ar0
3707 A856      1088            mov r0, BCD_state_counter+0
3709 1200C6    1088            lcall ?Display_BCD
370C D000      1088            pop ar0
370E 22        1089            ret
370F           1090   ;------------------------------;
370F           1091   ;Print_FSM_Temp_Info
370F           1092   ;------------------------------; 
370F           1093   Print_FSM_Temp_Info:
370F           1094            
370F 856247    1095            mov x + 0, Temp+0
3712 856348    1096            mov x + 1, Temp+1
3715 754900    1097            mov x + 2, #0x00
3718 754A00    1098            mov x + 3, #0x00
371B           1099            
371B 120129    1100            lcall hex2bcd           ;change hex number to bcd so it can be displayed
371E C0E0      1101            push acc
3720 7401      1101            mov a, #1
3722 14        1101            dec a
3723 1200C1    1101            lcall ?Set_Cursor_1 ; Select column and row
3726 D0E0      1101            pop acc
3728 C000      1102            push ar0
372A A850      1102            mov r0, bcd+1
372C 1200C6    1102            lcall ?Display_BCD
372F D000      1102            pop ar0
3731 C000      1103            push ar0
3733 A84F      1103            mov r0, bcd+0
3735 1200C6    1103            lcall ?Display_BCD
3738 D000      1103            pop ar0
373A           1104   
373A 22        1105            ret
373B           1106            
373B           1107   ;------------------------------;
373B           1108   ;Check_Runtime_Errors
373B           1109   ;------------------------------;
373B           1110   Check_Runtime_Errors:
373B           1111            
373B 123742    1112            lcall Error_Code_1
373E 123769    1113            lcall Error_Code_2
3741 22        1114            ret     
3742           1115   
3742           1116   Error_Code_1:                            ;at runtime = 50, if temp < 50 abort
3742 E555      1117            mov a, BCD_counter+1
3744 75F00A    1118            mov b, #10
3747 A4        1119            mul ab
3748 FF        1120            mov R7, a
3749 E554      1121            mov a, BCD_counter+0
374B C4        1122            swap a
374C 540F      1123            anl a, #0x0f
374E 2F        1124            add a, R7
374F 75F00A    1125            mov b, #10
3752 A4        1126            mul ab
3753 FF        1127            mov R7, a
3754 E554      1128            mov a, BCD_counter+0
3756 540F      1129            anl a, #0x0f
3758 2F        1130            add a, R7
3759 9432      1131            subb a, #50
375B 700B      1132            jnz skip_code_1
375D E562      1133            mov a, Temp
375F 943C      1134            subb a, #60
3761 5005      1135            jnc skip_code_1
3763 D202      1136            setb abort_flag
3765 437F40    1137            orl Error_Codes, #01000000b     
3768           1138   skip_code_1:
3768 22        1139            ret
3769           1140   
3769           1141   ;        mov bcd+0, bcd_counter+0
3769           1142   ;        mov bcd+1, bcd_counter+1
3769           1143   ;        mov bcd+2, #0
3769           1144   ;        mov bcd+3, #0
3769           1145   ;        mov bcd+4, #0
3769           1146   ;        lcall bcd2hex
3769           1147   ;        mov a, x+0
3769           1148   ;        cjne a, #50, Checking_Overflow_Time
3769           1149   ;C;hecking_Overflow_Time:
3769           1150   ;        jc Less_Than_50s
3769           1151   ;        mov a, Temp
3769           1152   ;        cjne a, #60, Checking_Temp_Overflow
3769           1153   ;        ljmp Less_Than_50s
3769           1154   ;C;hecking_Temp_Overflow:
3769           1155   ;        jc ERROR_1
3769           1156   ;        ljmp Less_Than_50s
3769           1157   ;ERROR_1:
3769           1158   ;        cpl p3.6
3769           1159   ;        setb abort_flag         
3769           1160   ;        orl Error_Codes, #01000000b     
3769           1161   ;L;ess_Than_50s:
3769           1162   ;        ret
3769           1163            
3769           1164   Error_Code_2:                            ;if door not closed during runtime, abort()())()()()()()(()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()
3769           1165   ;        jnb     DoorPIN, Error_2_clear
3769           1166   ;        setb abort_flag
3769           1167   ;Error_2_clear:
3769 22        1168            ret
376A           1169            
376A           1170   ;------------------------------;
376A           1171   ;Oven_Abort_State
376A           1172   ;------------------------------;
376A           1173   Oven_Abort_State:
376A C0E0      1174            push acc
376C 7401      1174            mov a, #1
376E 14        1174            dec a
376F 1200C1    1174            lcall ?Set_Cursor_1 ; Select column and row
3772 D0E0      1174            pop acc
3774 C083      1175            push dph
3776 C082      1175            push dpl
3778 C0E0      1175            push acc
377A 900D07    1175            mov dptr, #CLEARLINE
377D 1200B4    1175            lcall ?Send_Constant_String
3780 D0E0      1175            pop acc
3782 D082      1175            pop dpl
3784 D083      1175            pop dph
3786 C0E0      1176            push acc
3788 7401      1176            mov a, #1
378A 14        1176            dec a
378B 1200C1    1176            lcall ?Set_Cursor_1 ; Select column and row
378E D0E0      1176            pop acc
3790 C083      1177            push dph
3792 C082      1177            push dpl
3794 C0E0      1177            push acc
3796 900F0E    1177            mov dptr, #EXITTEXTTOP
3799 1200B4    1177            lcall ?Send_Constant_String
379C D0E0      1177            pop acc
379E D082      1177            pop dpl
37A0 D083      1177            pop dph
37A2 C0E0      1178            push acc
37A4 7401      1178            mov a, #1
37A6 14        1178            dec a
37A7 1200BF    1178            lcall ?Set_Cursor_2 ; Select column and row
37AA D0E0      1178            pop acc
37AC           1178   
37AC C083      1179            push dph
37AE C082      1179            push dpl
37B0 C0E0      1179            push acc
37B2 900D07    1179            mov dptr, #CLEARLINE
37B5 1200B4    1179            lcall ?Send_Constant_String
37B8 D0E0      1179            pop acc
37BA D082      1179            pop dpl
37BC D083      1179            pop dph
37BE C0E0      1180            push acc
37C0 7401      1180            mov a, #1
37C2 14        1180            dec a
37C3 1200BF    1180            lcall ?Set_Cursor_2 ; Select column and row
37C6 D0E0      1180            pop acc
37C8 C083      1181            push dph
37CA C082      1181            push dpl
37CC C0E0      1181            push acc
37CE 900F1D    1181            mov dptr, #EXITTEXTBTM
37D1 1200B4    1181            lcall ?Send_Constant_String
37D4 D0E0      1181            pop acc
37D6 D082      1181            pop dpl
37D8 D083      1181            pop dph
37DA 75640A    1182            mov Set_Temp, #0x0A
37DD D214      1183            setb change_temperature_flag
37DF 754500    1184            mov oven_state, #0x00
37E2 120C82    1185            lcall Reset_Alarms
37E5 C002      1186            push AR2
37E7 7AFA      1186            mov R2, #250
37E9 120039    1186            lcall ?Wait_Milli_Seconds
37EC D002      1186            pop AR2
37EE C002      1187            push AR2
37F0 7AFA      1187            mov R2, #250
37F2 120039    1187            lcall ?Wait_Milli_Seconds
37F5 D002      1187            pop AR2
37F7 C002      1188            push AR2
37F9 7AFA      1188            mov R2, #250
37FB 120039    1188            lcall ?Wait_Milli_Seconds
37FE D002      1188            pop AR2
3800 C002      1189            push AR2
3802 7AFA      1189            mov R2, #250
3804 120039    1189            lcall ?Wait_Milli_Seconds
3807 D002      1189            pop AR2
3809 22        1190            ret
380A           1191   ;------------------------------;
380A           1192   ;Oven_FSM
380A           1193   ;------------------------------;
380A           1194   Oven_FSM:
380A           1195            
380A 12373B    1196            lcall Check_Runtime_Errors
380D 200203    1197            jb abort_flag, Oven_Abort_Statetp
3810 023816    1198            ljmp Oven_Abort_Statetp2
3813           1199   Oven_Abort_Statetp:
3813 02376A    1200            ljmp Oven_Abort_State
3816           1201   Oven_Abort_Statetp2:                     ;above gets around maximum offset
3816           1202   
3816 1236D6    1203            lcall Print_FSM_Time_Info
3819 12370F    1204            lcall Print_FSM_Temp_Info
381C           1205            
381C           1206            ;display the screen if required
381C 30090D    1207            jnb state_display_flag2, Oven_FSM_Skip_Display
381F 123521    1208            lcall Print_FSM_State_Info
3822 C209      1209            clr state_display_flag2                         ;reset flag
3824           1210   
3824           1211            ;check for remote stop
3824 300E05    1212            jnb Remote_Stop, Skip_Remote_Stop
3827 C20E      1213            clr Remote_Stop
3829 02376A    1214            ljmp Oven_Abort_State
382C           1215   Skip_Remote_Stop:
382C           1216            
382C           1217   Oven_FSM_Skip_Display:
382C E545      1218            mov a, oven_state
382E           1219            ;check if the emergency button has been pressed
382E 208212    1220            jb ESTOP, Oven_State1 ; if the 'B0' button is not pressed skip
3831 C002      1221            push AR2
3833 7A32      1221            mov R2, #50
3835 120039    1221            lcall ?Wait_Milli_Seconds
3838 D002      1221            pop AR2                 ; Debounce delay.  This macro is also in 'LCD_4bit.inc'
383A 208206    1222            jb ESTOP,Oven_State1 ; if the 'B0' button is not pressed skip
383D 3082FD    1223            jnb ESTOP, $
3840           1224            ;ESTOP pressed, jump to abort state
3840 02376A    1225            ljmp Oven_Abort_State
3843           1226   
3843           1227   ;------;
3843           1228   ;state1;
3843           1229   Oven_State1:
3843           1230   
3843           1231   State1_Temp_Flag_Change_Jump:
3843 B4012A    1232            cjne a, #0x01, Oven_State2
3846           1233   
3846 301A08    1234            jnb state1tempflag, State1_hop
3849 E543      1235            mov a,  Soak_Start_Temp_hex
384B F564      1235            mov Set_Temp, a
384D D214      1236            setb change_temperature_flag
384F C21A      1237            clr state1tempflag
3851           1238   State1_hop:
3851           1239            
3851           1240            ;compare the desired tempurature of the state and check if we move to next state.
3851 E562      1241            mov a, Temp
3853 B54302    1242            cjne a, Soak_Start_Temp_hex, FSM_Check_Carry_Soak
3856           1243            ;if equal change to state 2
3856 8005      1244            sjmp State_1To2_Transition
3858           1245   FSM_Check_Carry_Soak:
3858 5003      1246            jnc State_1To2_Transition       ;if carry not set, change state
385A 02380A    1247            ljmp Oven_FSM
385D           1248   State_1To2_Transition:   
385D           1249            
385D C203      1250            clr state1_exit_flag
385F 0545      1251            INC oven_state
3861 755600    1252            mov BCD_state_counter, #0x00
3864 755700    1253            mov BCD_state_counter+1, #0x00
3867 123521    1254            lcall Print_FSM_State_Info
386A           1255            
386A 120C5E    1256            lcall Trigger_Short_Alarm
386D           1257            
386D 02380A    1258            ljmp Oven_FSM
3870           1259   
3870           1260   ;------;
3870           1261   ;state2;         
3870           1262   Oven_State2:
3870 B4022E    1263            cjne a, #0x02, Oven_State3
3873           1264            
3873           1265            ;determine if the desired state time has finished
3873 E557      1266            mov a, BCD_state_counter+1
3875 75F00A    1267            mov b, #10
3878 A4        1268            mul ab
3879 FF        1269            mov R7, a
387A E556      1270            mov a, BCD_state_counter+0
387C C4        1271            swap a
387D 540F      1272            anl a, #0x0f
387F 2F        1273            add a, R7
3880 75F00A    1274            mov b, #10
3883 A4        1275            mul ab
3884 FF        1276            mov R7, a
3885 E556      1277            mov a, BCD_state_counter+0
3887 540F      1278            anl a, #0x0f
3889 2F        1279            add a, R7
388A B54111    1280            cjne a, Soak_Start_T_hex, Oven_FSMtp2
388D           1281   
388D C204      1282            clr state2_exit_flag
388F 754503    1283            mov oven_state, #0x03
3892 755600    1284            mov BCD_state_counter+0, #0x00
3895 755700    1285            mov BCD_state_counter+1, #0x00
3898 123521    1286            lcall Print_FSM_State_Info
389B           1287            
389B 120C5E    1288            lcall Trigger_Short_Alarm
389E           1289            
389E           1290   Oven_FSMtp2:     
389E 02380A    1291            ljmp Oven_FSM
38A1           1292   ;------;
38A1           1293   ;state3;         
38A1           1294   Oven_State3:
38A1 B4032E    1295            cjne a, #0x03, Oven_State4
38A4           1296            
38A4 301B08    1297            jnb state3tempflag, State3_hop  
38A7 E544      1298            mov a,  Reflow_Start_Temp_hex
38A9 F564      1298            mov Set_Temp, a
38AB D214      1299            setb change_temperature_flag
38AD C21B      1300            clr state3tempflag
38AF           1301   State3_hop:
38AF           1302            
38AF           1303            
38AF           1304   State3_Temp_Flag_Change_Jump:
38AF           1305   
38AF           1306            ;compare the desired tempurature of the state and check if we move to next state.
38AF E562      1307            mov a, Temp
38B1 B54402    1308            cjne a, Reflow_Start_Temp_hex, FSM_Check_Carry_Reflow
38B4           1309            ;if equal change to state 2
38B4 8005      1310            sjmp State_3To4_Transition
38B6           1311   FSM_Check_Carry_Reflow:
38B6 5003      1312            jnc State_3To4_Transition       ;if carry not set, change state
38B8 02380A    1313            ljmp Oven_FSM
38BB           1314   State_3To4_Transition:   
38BB           1315            
38BB C205      1316            clr state3_exit_flag
38BD 754504    1317            mov oven_state, #0x04
38C0 755600    1318            mov BCD_state_counter, #0x00
38C3 755700    1319            mov BCD_state_counter+1, #0x00
38C6 123521    1320            lcall Print_FSM_State_Info
38C9           1321            
38C9 120C5E    1322            lcall Trigger_Short_Alarm
38CC           1323            
38CC 02380A    1324            ljmp Oven_FSM
38CF           1325   
38CF           1326   Oven_FSMtp3:
38CF 02380A    1327            ljmp Oven_FSM
38D2           1328   ;------;
38D2           1329   ;state4;
38D2           1330   Oven_State4:
38D2           1331   
38D2 B4042E    1332            cjne a, #0x04, Oven_State5
38D5           1333   
38D5           1334            ;determine if the desired state time has finished
38D5 E557      1335            mov a, BCD_state_counter+1
38D7 75F00A    1336            mov b, #10
38DA A4        1337            mul ab
38DB FF        1338            mov R7, a
38DC E556      1339            mov a, BCD_state_counter+0
38DE C4        1340            swap a
38DF 540F      1341            anl a, #0x0f
38E1 2F        1342            add a, R7
38E2 75F00A    1343            mov b, #10
38E5 A4        1344            mul ab
38E6 FF        1345            mov R7, a
38E7 E556      1346            mov a, BCD_state_counter+0
38E9 540F      1347            anl a, #0x0f
38EB 2F        1348            add a, R7
38EC B5422C    1349            cjne a, Reflow_Start_T_hex, Oven_FSMtp
38EF           1350   
38EF C206      1351            clr state4_exit_flag
38F1 754505    1352            mov oven_state, #0x05
38F4 755600    1353            mov BCD_state_counter, #0x00
38F7 755700    1354            mov BCD_state_counter+1, #0x00
38FA 123521    1355            lcall Print_FSM_State_Info
38FD           1356            
38FD 120C6A    1357            lcall Trigger_Long_Alarm
3900 02380A    1358            ljmp Oven_FSM
3903           1359   ;------;
3903           1360   ;state5;
3903           1361   Oven_State5:
3903 75640A    1362            mov Set_Temp, #0x0A     ;set the desired temp to 0
3906 D214      1363            setb change_temperature_flag
3908           1364            
3908           1365            ;compare the desired tempurature of the state and check if we move to next state.
3908 E562      1366            mov a, Temp
390A B43C02    1367            cjne a, #60, FSM_Check_Carry_Cool
390D           1368            ;if equal change to state 2
390D 8005      1369            sjmp State_5To0_Transition
390F           1370   FSM_Check_Carry_Cool:
390F 4003      1371            jc State_5To0_Transition        ;if carry not set, change state
3911 02380A    1372            ljmp Oven_FSM
3914           1373   State_5To0_Transition:   
3914 120C76    1374            lcall Trigger_Beeping_Alarm
3917 754500    1375            mov oven_state, #0
391A 22        1376            ret
391B           1377            
391B           1378   Oven_FSMtp:
391B 02380A    1379            ljmp Oven_FSM
391E           1380            
391E           1381   end 
